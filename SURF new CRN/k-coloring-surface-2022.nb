(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    160690,       3952]
NotebookOptionsPosition[    150569,       3795]
NotebookOutlinePosition[    150988,       3812]
CellTagsIndexPosition[    150945,       3809]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Surface CRNs for k-coloring (2022)", "Title",
 CellChangeTimes->{{3.864837892488171*^9, 
  3.8648379113924026`*^9}},ExpressionUUID->"5377b741-064c-4bfd-9618-\
9c003df36aba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<CRNSimulator.m\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<CRNSimulatorSSA.m\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<CRNSimulatorExtensions.m\>\"", "]"}]}], "Input",
 CellChangeTimes->{
  3.864915591097713*^9},ExpressionUUID->"af126133-130f-4f5f-9bc9-\
3e5c1d8555de"],

Cell[CellGroupData[{

Cell["Generating random graphs", "Subtitle",
 CellChangeTimes->{{3.864838618475706*^9, 
  3.864838622108232*^9}},ExpressionUUID->"ad04706b-4c9c-4107-9bfd-\
b4b2ddcaa615"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s generate random planar maps using a percolation \
approach: N x M vertices, with probability ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "adef657a-d571-47cf-82f5-be031c5463e1"],
 " for connecting a region to a von Neumann  neighbor via a \
\[OpenCurlyDoubleQuote]land bridge\[CloseCurlyDoubleQuote] to make them the \
same map region, and otherwise a probability ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],ExpressionUUID->
  "c67caf6b-ae51-405d-b40f-7599b5633fc0"],
 " for creating an \[OpenCurlyDoubleQuote]edge\[CloseCurlyDoubleQuote] to the \
neighbor (unless it ends up being the same region as connected by land \
bridges) .  So between two lattice sites, probability ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "c38b442e-1096-4844-9de6-88e2dca6533c"],
 " is a land bridge, probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], "q"}], TraditionalForm]],ExpressionUUID->
  "82a2f414-1b37-4d41-95aa-941cb85ac28c"],
 " is an edge, and probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "8dea6be0-029b-48bf-b8fd-9607d65fd905"],
 " is empty. The size of single-color regions now depends on the percolation \
parameter p.   For large enough ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "78791b77-eaf7-48fc-8be7-fa559ab72d8e"],
 ", these regions may bend around on themselves, and allowing a formal edge \
to be made between a region and another part of itself -- thus making the \
entire graph not colorable.   This being far too common, our code below goes \
to some lengths to identify and remove such edges.   While we\
\[CloseCurlyQuote]re at it, we construct a formal graph corresponding to the \
layout, so that we can use SatisfiableQ / MiniSAT to test colorability before \
asking our surface CRN to try it.\n\nIt would be a lot easier to just use a \
regular square grid or regular hexagonal grid, with a random subset of edges \
-- but any subset of a square grid is 2-colorable, and any subset of a hex \
grid is 3-colorable.  Granted, any subset of a planar graph is 4-colorable, \
yet it\[CloseCurlyQuote]s still interesting (and hard) to actually find a \
coloring.   Still, the land bridges in the random maps result in regions that \
permit arbitrary graphs, hence the NP-completeness of planar 3-colorability \
(cf Garey & Johnson, 1979) means we\[CloseCurlyQuote]re in the zone for \
genuinely hard decisions problems.  "
}], "Text",
 CellChangeTimes->{3.8648387957642603`*^9},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"c79309bd-00ee-40c4-a32b-60a42fc3526b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ColoringSAT", "[", 
    RowBox[{"G_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"VertexList", "[", "G", "]"}]}], ",", 
       RowBox[{"e", "=", 
        RowBox[{"EdgeList", "[", "G", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"And", "@@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"V", "[", 
              RowBox[{
               RowBox[{"edge", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "c"}], "]"}]}], "||", 
            RowBox[{"!", 
             RowBox[{"V", "[", 
              RowBox[{
               RowBox[{"edge", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "c"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", 
             RowBox[{"Range", "[", "k", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"edge", ",", "e"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Or", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"V", "[", 
               RowBox[{"i", ",", "c"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", 
                RowBox[{"Range", "[", "k", "]"}]}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "v"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"V", "[", 
              RowBox[{"i", ",", "c1"}], "]"}]}], "||", 
            RowBox[{"!", 
             RowBox[{"V", "[", 
              RowBox[{"i", ",", "c2"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"c1", ",", "1", ",", 
             RowBox[{"k", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c2", ",", 
             RowBox[{"c1", "+", "1"}], ",", "k"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "v"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "\t", "]"}], "]"}]}]}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomSquareColoringMap", "[", 
    RowBox[{"N_", ",", "M_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "map", ",", "ID", ",", "IDE", ",", "badE", ",", "goodE", ",", "graph"}],
       "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"map", "=", 
       RowBox[{"ArrayPad", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"ArrayFlatten", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"mid", ",", "ver"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"hor", ",", "cor"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", "N", "}"}], ",", 
               RowBox[{"{", "M", "}"}]}], "]"}], "/.", 
             RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
               RowBox[{"mid", "\[Rule]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], ",", "3", ",", "3"}], "]"}]}],
                ",", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"ver", "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RandomReal", "[", "]"}], "<", "p"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], ",", "3", ",", "2"}], "]"}],
                   ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", "q"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"w", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e", "[", "1", "]"}], ",", 
                    RowBox[{"e", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "w"}], "}"}]}], "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"w", ",", "3", ",", "2"}], "]"}]}], "]"}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"hor", "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RandomReal", "[", "]"}], "<", "p"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], ",", "2", ",", "3"}], "]"}],
                   ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", "q"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"w", ",", 
                    RowBox[{"e", "[", "1", "]"}], ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", 
                    RowBox[{"e", "[", "1", "]"}], ",", "w"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"w", ",", "2", ",", "3"}], "]"}]}], "]"}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"cor", "\[Rule]", 
                RowBox[{"Table", "[", 
                 RowBox[{"w", ",", "2", ",", "2"}], "]"}]}]}], 
              "\[IndentingNewLine]", "\t\t", "}"}]}], "\[IndentingNewLine]", 
            "\t", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", 
             RowBox[{"-", "3"}]}], ",", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "3"}]}]}], "]"}], "]"}], ",", "1", ",", "w"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "this", " ", "map", " ", "might", " ", "have", " ", "large", " ", 
         "regions", " ", "that", " ", "curve", " ", "around", " ", "back", 
         " ", "on", " ", "themselves", " ", "and", " ", "then", " ", "have", 
         " ", "edges", " ", "to", " ", "themselves"}], ",", " ", 
        RowBox[{"making", " ", "them", " ", 
         RowBox[{"uncolorable", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]",
       "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"the", " ", "larger", " ", "the", " ", "map"}], ",", " ", 
        RowBox[{
        "the", " ", "more", " ", "likely", " ", "this", " ", "will", " ", 
         RowBox[{"occur", ".", "  ", "annoying"}]}], ",", " ", 
        RowBox[{
         RowBox[{"so", " ", 
          RowBox[{"let", "'"}], "s", " ", "just", " ", "eliminate", " ", 
          "these", " ", "self"}], "-", 
         RowBox[{"edges", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "we", " ", "give", " ", "each", " ", "region", " ", "a", " ", 
         "unique", " ", "ID"}], ",", " ", 
        RowBox[{
        "then", " ", "test", " ", "each", " ", "edge", " ", "for", " ", "IDs",
          " ", "being", " ", 
         RowBox[{"different", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"ID", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayReshape", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Times", "@@", 
                RowBox[{"Dimensions", "[", "map", "]"}]}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"Dimensions", "[", "map", "]"}]}], "]"}], " ", "*", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "===", 
               RowBox[{"v", "[", "1", "]"}]}], ",", "1", ",", "0"}], "]"}], 
            "&"}], ",", "map", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Infinity"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"ID", "=", 
       RowBox[{"FixedPoint", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#1", "<", "Infinity"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4", ",", "#5"}], 
                "]"}], ",", "Infinity"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"RotateLeft", "/@", "#"}], ",", 
              RowBox[{"RotateRight", "/@", "#"}], ",", 
              RowBox[{"RotateLeft", "[", "#", "]"}], ",", 
              RowBox[{"RotateRight", "[", "#", "]"}]}], "}"}], ",", "2"}], 
           "]"}], "&"}], ",", "ID"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"only", " ", "care", " ", "for", " ", "edge", " ", 
        RowBox[{"sites", ":", " ", 
         RowBox[{
          RowBox[{"what", "'"}], "s", " ", "neighbor", " ", 
          RowBox[{"ID", "?"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"IDE", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "===", 
             RowBox[{"e", "[", "1", "]"}]}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"#2", ",", "#3", ",", "#4", ",", "#5"}], "]"}], ",", 
            "Infinity"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"map", ",", 
           RowBox[{"RotateLeft", "/@", "ID"}], ",", 
           RowBox[{"RotateRight", "/@", "ID"}], ",", 
           RowBox[{"RotateLeft", "[", "ID", "]"}], ",", 
           RowBox[{"RotateRight", "[", "ID", "]"}]}], "}"}], ",", "2"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "a", " ", "bad", " ", "edge", " ", "is", " ", "if", " ", "you", " ", 
        "have", " ", "an", " ", "e", " ", "neighbor", " ", "but", " ", "its", 
        " ", "ID", " ", "is", " ", "the", " ", "same"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"badE", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#1", "===", 
             RowBox[{"e", "[", "1", "]"}]}], " ", "&&", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"#3", ",", "#4", ",", "#5", ",", "#6"}], "]"}], "<", 
             "Infinity"}], "&&", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"#3", ",", "#4", ",", "#5", ",", "#6"}], "]"}], "===", 
             "#2"}]}], ")"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"map", ",", "IDE", ",", 
           RowBox[{"RotateLeft", "/@", "IDE"}], ",", 
           RowBox[{"RotateRight", "/@", "IDE"}], ",", 
           RowBox[{"RotateLeft", "[", "IDE", "]"}], ",", 
           RowBox[{"RotateRight", "[", "IDE", "]"}]}], "}"}], ",", "2"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"ID", "//", "MatrixForm"}], ",", "\"\<\\n\>\"", ",", 
          RowBox[{"IDE", "//", "MatrixForm"}], ",", "\"\<\\n\>\"", ",", 
          RowBox[{
           RowBox[{"Boole", "[", "badE", "]"}], "//", "MatrixForm"}]}], "]"}],
         ";"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"map", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"#2", ",", "w", ",", "#1"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"map", ",", "badE"}], "}"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"goodE", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "===", 
             RowBox[{"e", "[", "1", "]"}]}], ",", " ", 
            RowBox[{"UndirectedEdge", "@@", 
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{"#2", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{"#3", ",", "#4", ",", "#5", ",", "#6"}], "]"}]}], 
               "}"}], "]"}]}], ",", 
            RowBox[{"{", "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"map", ",", "IDE", ",", 
           RowBox[{"RotateLeft", "/@", "IDE"}], ",", 
           RowBox[{"RotateRight", "/@", "IDE"}], ",", 
           RowBox[{"RotateLeft", "[", "IDE", "]"}], ",", 
           RowBox[{"RotateRight", "[", "IDE", "]"}]}], "}"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"graph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "ID", "]"}], "]"}], ",", 
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "goodE", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"{", 
       RowBox[{"map", ",", "graph"}], "}"}]}]}], "\[IndentingNewLine]", "\t", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.864838684320099*^9, 3.864838764777924*^9}},
 CellLabel->
  "In[465]:=",ExpressionUUID->"db77a4dc-5fc7-4648-82df-4d4595ec3b3a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Surface Map Coloring: an intuitive first approach\
\>", "Subtitle",
 CellChangeTimes->{{3.8648436865554256`*^9, 
  3.864843716492249*^9}},ExpressionUUID->"3536790e-3449-453b-87c1-\
c2d094ee4d28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceMapColoringCRN", "[", "k_", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "0.01"}], "]"}]}], "    ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
              " ", "different"}], ";", " ", 
             RowBox[{"if", " ", "not"}]}], ",", " ", 
            RowBox[{"one", " ", "randomly", " ", "changes"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapColoringRules", "[", "k_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"colors", "=", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", 
        RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", "\[Rule]", "White"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{
  3.864843702277635*^9},ExpressionUUID->"1c1aa549-3870-48ca-8bd8-\
77c482da4641"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PrepareColoringLayout", "[", "option_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
         RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
         RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
         RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
         RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
         RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SatisfiableQ", "[", 
          RowBox[{"ColoringSAT", "[", 
           RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
         "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"solidmap", "=", "map"}], ";", "\[IndentingNewLine]", 
      RowBox[{"solidCRN", "=", 
       RowBox[{"SurfaceMapColoringCRN", "[", "k", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solidcolors", "=", 
       RowBox[{"MapColoringRules", "[", "k", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solidtime", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"csolidCRN", ",", " ", "csolidmap"}], "}"}], "=", 
       RowBox[{"CompileSurfaceCRN", "[", 
        RowBox[{"solidCRN", ",", "solidmap"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"csolidevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PrepareColoringLayout", "[", "2", "]"}]}], "Input",
 CellChangeTimes->{
  3.8648442014268303`*^9, {3.8648453088405457`*^9, 3.864845313192916*^9}, {
   3.8648455317219763`*^9, 3.864845539060069*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"42d6d275-9d5b-41b8-a2df-ed14cf6989e4"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{3.8648442195456*^9, 3.864845320493079*^9, 
  3.8648455408110237`*^9},
 CellLabel->
  "During evaluation of \
In[318]:=",ExpressionUUID->"13ecba7e-0bc6-4787-b85b-8e057f9042c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Dynamic", "[", 
    RowBox[{"ShowSurfaceCRNState", "[", 
     RowBox[{"csolidmap", ",", "solidcolors", ",", 
      RowBox[{"PlotLabel", "\[Rule]", "solidtime"}]}], "]"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"!", "halted"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
          "csolidmap"}], "}"}], "=", 
        RowBox[{"InfoRunSurfaceCRN", "[", 
         RowBox[{"csolidCRN", ",", "csolidmap", ",", "1"}], "]"}]}], ";", 
       RowBox[{"solidtime", "+=", "dt"}], ";", 
       RowBox[{"csolidevents", "+=", "devents"}]}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.864838883236459*^9, 3.864838883256586*^9}, 
   3.8648389284924507`*^9, {3.864838964757721*^9, 3.864838989535461*^9}, {
   3.86483902152812*^9, 3.864839044331067*^9}, {3.86484250156015*^9, 
   3.864842503240693*^9}, {3.864842638880292*^9, 3.864842640384644*^9}, {
   3.864842678867921*^9, 3.8648427832923393`*^9}, {3.864842910925869*^9, 
   3.86484299354056*^9}, 3.8648431116920357`*^9, {3.8648431992662086`*^9, 
   3.864843214718504*^9}, {3.864843290327044*^9, 3.8648434023522778`*^9}, {
   3.864843451734273*^9, 3.864843453801602*^9}, {3.8648435057892437`*^9, 
   3.864843531398703*^9}, {3.864843590572846*^9, 3.8648435936197767`*^9}, {
   3.864843631296777*^9, 3.8648436324687843`*^9}, {3.8648442106105824`*^9, 
   3.864844214670589*^9}, {3.864845122459076*^9, 3.864845122761161*^9}, {
   3.8648453057236547`*^9, 3.864845307238386*^9}, 3.864845542420031*^9},
 CellLabel->
  "In[320]:=",ExpressionUUID->"752db4b5-bdde-454e-a617-7d5718c7bbb5"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`csolidmap, \
$CellContext`solidcolors, PlotLabel -> $CellContext`solidtime], StandardForm],
  
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{{3.864838967344555*^9, 3.86483899011576*^9}, {
   3.864839022102961*^9, 3.8648390596563272`*^9}, {3.864842479858189*^9, 
   3.864842504124585*^9}, 3.8648425451298437`*^9, 3.864842640819581*^9, 
   3.864842676739584*^9, {3.8648427705850058`*^9, 3.864842788325795*^9}, 
   3.8648428897751827`*^9, {3.864842995207428*^9, 3.8648429988159237`*^9}, {
   3.864843104897334*^9, 3.864843136177992*^9}, 3.86484331255869*^9, 
   3.86484341014914*^9, 3.8648434542929773`*^9, {3.8648435076336803`*^9, 
   3.864843531861115*^9}, 3.864843594090074*^9, 3.8648442217981462`*^9, 
   3.864845322476862*^9, 3.864845545911146*^9},
 CellLabel->
  "Out[320]=",ExpressionUUID->"8e3d9c82-4a13-4bf1-9327-ce8c7b873356"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Walk Coloring Surface CRN", "Subtitle",
 CellChangeTimes->{{3.864843887213017*^9, 3.864843894521365*^9}, {
  3.864844286154813*^9, 
  3.864844287816494*^9}},ExpressionUUID->"0800482e-d0a4-4d57-a50d-\
7fa316592fd7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceWalkColoringCRN", "[", 
   RowBox[{"k_", ",", "slow_", ",", "fast_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", " ", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "chooses", " ", "to", " ", 
              "recolor"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", 
             RowBox[{"slow", "/", "100"}]}], "]"}], ",", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
               " ", "different"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "tries", " ", "to", " ", 
              "change"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"tryv", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"edges", " ", "initiate", " ", "trials"}], ",", " ", 
             RowBox[{
             "which", " ", "propagate", " ", "to", " ", "the", " ", 
              "region"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tryv", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"tryv", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "trial", " ", "colors", " ", "propagate", " ", "to", " ", "other",
              " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"tryv", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"tryv", "[", "c2", "]"}], "+", 
              RowBox[{"tryv", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "new", " ", "trial", " ", "colors", " ", "propagate", " ", 
             "throughout", " ", "the", " ", "region"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"tryv", "[", "c2", "]"}], ",", 
             RowBox[{"v", "[", "c2", "]"}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{"slowly", " ", "solidify", " ", "trials"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"trye", "[", "c2", "]"}], ",", 
             RowBox[{"e", "[", "c2", "]"}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{"slowly", " ", "solidify", " ", "trials"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"tryv", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "if", " ", "a", " ", "trial", " ", "color", " ", "solidifies", 
              " ", "anywhere"}], ",", " ", 
             RowBox[{"the", " ", "solidification", " ", "propagates"}]}], " ",
             "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "solidification", " ", "propagates", " ", "to", " ", "edges"}], 
            " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c1", "]"}]}], ",", "1"}], "]"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "how", " ", "does", " ", "a", " ", "trial", " ", "color", " ", 
            "change", " ", "get", " ", 
            RowBox[{"rejected", "?", " ", "choose"}], " ", "something", " ", 
            "else", " ", "to", " ", "try"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t\t", "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "\t", "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WalkColoringRules", "[", "k_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"colors", "=", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Green", ",", 
         RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], ",", 
      
      RowBox[{"trycolors", "=", 
       RowBox[{"{", 
        RowBox[{
        "LightPink", ",", "LightGreen", ",", "LightMagenta", ",", 
         "LightBrown"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", "\[Rule]", "White"}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"tryv", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"trycolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"trye", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"trycolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{
  3.864843913209446*^9, {3.864843993379266*^9, 3.864844057180807*^9}, {
   3.864846852402871*^9, 3.864846860440462*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"9a61a7b5-e66a-4633-a3f3-d323a83b67d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PrepareWalkColoringLayout", "[", "option_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
        RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
        RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
        "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfaceCRN", "=", 
      RowBox[{"SurfaceWalkColoringCRN", "[", 
       RowBox[{"k", ",", ".1", ",", "10"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurface", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"WalkColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cfsurfaceCRN", ",", " ", "cfsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRN", ",", "fsurface"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PrepareWalkColoringLayout", "[", "3", "]"}]}], "Input",
 CellChangeTimes->{{3.864844077419813*^9, 3.864844114882512*^9}, {
  3.864844159423915*^9, 3.864844173536518*^9}, {3.864844990561261*^9, 
  3.8648449912402897`*^9}, {3.864845068687512*^9, 3.8648451330248623`*^9}, {
  3.864845488408297*^9, 3.864845488584532*^9}, {3.8648466601507998`*^9, 
  3.864846687456513*^9}, {3.864846871383596*^9, 3.864846873998177*^9}},
 CellLabel->
  "In[383]:=",ExpressionUUID->"7f167c9f-c058-45ff-9504-2299899c358f"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{
  3.864844080235529*^9, 3.864845002816639*^9, 3.864845148185564*^9, 
   3.864845232100813*^9, {3.864845469804088*^9, 3.8648454907746*^9}, 
   3.864845887394075*^9, 3.864846524203752*^9, 3.8648466897541847`*^9, {
   3.864846865321116*^9, 3.864846903457736*^9}},
 CellLabel->
  "During evaluation of \
In[383]:=",ExpressionUUID->"3261627a-0771-4620-b6f1-5cf681c3a169"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"ShowSurfaceCRNState", "[", 
    RowBox[{"cfsurface", ",", "fsurfacecoloring", ",", 
     RowBox[{"PlotLabel", "\[Rule]", "fsurfacetime"}]}], "]"}], "]"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", "halted"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
        "cfsurface"}], "}"}], "=", 
      RowBox[{"InfoRunSurfaceCRN", "[", 
       RowBox[{"cfsurfaceCRN", ",", "cfsurface", ",", "1"}], "]"}]}], ";", 
     RowBox[{"fsurfacetime", "+=", "dt"}], ";", 
     RowBox[{"csurfaceevents", "+=", "devents"}]}]}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.864845004820507*^9, 3.86484500484135*^9}, {
   3.864845151125202*^9, 3.864845201589918*^9}, {3.864846014989496*^9, 
   3.864846018576722*^9}, {3.864846698271241*^9, 3.8648467142095957`*^9}, 
   3.8648468894215183`*^9},
 CellLabel->
  "In[385]:=",ExpressionUUID->"78180cd0-fb4f-4019-a5f1-e43d4b44126f"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`cfsurface, \
$CellContext`fsurfacecoloring, PlotLabel -> $CellContext`fsurfacetime], 
   StandardForm],
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{{3.86484520216081*^9, 3.864845235402631*^9}, 
   3.86484530023435*^9, {3.864845475944107*^9, 3.864845492487533*^9}, 
   3.864845883012908*^9, {3.864846009398426*^9, 3.864846019059319*^9}, {
   3.864846691279255*^9, 3.864846714495162*^9}, 3.864846821812389*^9, {
   3.8648468672528563`*^9, 3.864846920323923*^9}},
 CellLabel->
  "Out[385]=",ExpressionUUID->"bae51b4a-8e85-4230-b72d-1f6f2bd4dd31"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Surface Wave CRN", "Subtitle",
 CellChangeTimes->{{3.8648469714069757`*^9, 
  3.8648469764554653`*^9}},ExpressionUUID->"4c070306-031b-4c9e-9114-\
39140cb053f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceWaveColoringCRN", "[", 
   RowBox[{"k_", ",", "slow_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", " ", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "chooses", " ", "to", " ", 
              "recolor", " ", "but", " ", 
              RowBox[{"doesn", "'"}], "t", " ", "freeze"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"V", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"V", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"recolored", "/", "frozen"}], " ", "nodes", " ", "pass",
               " ", "their", " ", "new", " ", "color", " ", "to", " ", 
              "their", " ", "neighbors"}], ",", " ", 
             RowBox[{"and", " ", "freeze", " ", "them"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           
           RowBox[{"(*", " ", 
            RowBox[{
            "recolored", " ", "edges", " ", "propagate", " ", "their", " ", 
             "change", " ", "and", " ", "freeze", " ", "vertex", " ", 
             "sites"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"E", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "recolored", " ", "vertex", " ", "sites", " ", "pass", " ", 
             "their", " ", "color", " ", "to", " ", "outgoing", " ", "edges", 
             " ", "NOTE", " ", "EDITED", " ", "FROM", " ", "WINFREE", " ", 
             "CODE", " ", "TO", " ", 
             RowBox[{"E", "[", "c1", "]"}]}], "*)"}], "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", 
             RowBox[{"slow", "/", "100"}]}], "]"}], ",", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
               " ", "different"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"one", " ", "randomly", " ", "changes"}], " ", "&"}], 
              " ", "freezes"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "[", "c2", "]"}], ",", 
             RowBox[{"v", "[", "c2", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"slowly", " ", "melt", " ", "frozen", " ", "nodes"}], 
             ",", " ", 
             RowBox[{
             "allowing", " ", "them", " ", "to", " ", "change", " ", 
              "again"}]}], "  ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "[", "c2", "]"}], ",", 
             RowBox[{"e", "[", "c2", "]"}], ",", "slow"}], "]"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"slowly", " ", "melt", " ", "frozen", " ", "nodes"}], ",",
             " ", 
            RowBox[{
            "allowing", " ", "them", " ", "to", " ", "change", " ", 
             "again"}]}], "  ", "*)"}], "\[IndentingNewLine]", "\t\t", "}"}], 
         ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "\t", "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WaveColoringRules", "[", "k_", "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"colors", "=", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Green", ",", 
         RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], ",", 
      
      RowBox[{"freezecolors", "=", 
       RowBox[{"{", 
        RowBox[{
        "LightPink", ",", "LightGreen", ",", "LightMagenta", ",", 
         "LightBrown"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", "\[Rule]", "White"}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"freezecolors", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"E\[Null]", "[", "i", "]"}], "->", 
            RowBox[{"Darker", "[", 
             RowBox[{"freezecolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.864868013516211*^9, 3.864868102319459*^9}, {
  3.864868332261446*^9, 3.864868349999477*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"910d4a30-bea9-40f9-863d-43f900ab9c90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PrepareWaveColoringLayout", "[", 
   RowBox[{"option_", ",", "slow_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
        RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
        RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
        "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfaceCRN", "=", 
      RowBox[{"SurfaceWaveColoringCRN", "[", 
       RowBox[{"k", ",", "slow"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurface", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"WalkColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cfsurfaceCRN", ",", " ", "cfsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRN", ",", "fsurface"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrepareWaveColoringLayout", "[", 
   RowBox[{"2", ",", "0.5"}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"mysteriously", ",", " ", 
    RowBox[{
    "optimal", " ", "performance", " ", "comes", " ", "from", " ", "slow", 
     " ", "between", " ", "0.5", " ", "and", " ", "1"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.864868153533854*^9, 3.864868223099801*^9}, {
  3.8648682879616947`*^9, 3.8648682902669907`*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"957fc8d6-558e-413a-993c-16f5e499ca01"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{3.8648682930290127`*^9, 3.864868355840057*^9},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"4ad04be9-b75c-43bd-9394-d61f97fa09d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"ShowSurfaceCRNState", "[", 
    RowBox[{"cfsurface", ",", "fsurfacecoloring", ",", 
     RowBox[{"PlotLabel", "\[Rule]", "fsurfacetime"}]}], "]"}], "]"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", "halted"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
        "cfsurface"}], "}"}], "=", 
      RowBox[{"InfoRunSurfaceCRN", "[", 
       RowBox[{"cfsurfaceCRN", ",", "cfsurface", ",", "1"}], "]"}]}], ";", 
     RowBox[{"fsurfacetime", "+=", "dt"}], ";", 
     RowBox[{"csurfaceevents", "+=", "devents"}]}]}], "]"}], ";"}]}], "Input",\

 CellLabel->
  "In[397]:=",ExpressionUUID->"68ea8bbd-21b7-4abd-bc71-e91ea7e59fd0"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`cfsurface, \
$CellContext`fsurfacecoloring, PlotLabel -> $CellContext`fsurfacetime], 
   StandardForm],
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{3.864868299547153*^9, 3.864868371115086*^9},
 CellLabel->
  "Out[397]=",ExpressionUUID->"eb37516b-f336-4b2b-a210-cdb704a92605"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Surface Reject Wave CRN", "Subtitle",
 CellChangeTimes->{{3.864868498209792*^9, 3.864868508976306*^9}, {
  3.864869327695691*^9, 
  3.864869328042144*^9}},ExpressionUUID->"6a5b6613-1a9c-4128-9b00-\
feb6fc9f2f75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
   RowBox[{"k_", ",", "slow_", ",", "fast_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", " ", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "chooses", " ", "to", " ", 
              "recolor", " ", "but", " ", 
              RowBox[{"doesn", "'"}], "t", " ", "freeze"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", 
             RowBox[{"slow", "/", "100"}]}], "]"}], ",", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
               " ", "different"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"one", " ", "randomly", " ", "changes"}], " ", "&"}], 
              " ", "freezes"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"V", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"V", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"recolored", "/", "frozen"}], " ", "nodes", " ", "pass",
               " ", "their", " ", "new", " ", "color", " ", "to", " ", 
              "their", " ", "neighbors"}], ",", " ", 
             RowBox[{"and", " ", "freeze", " ", "them"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           
           RowBox[{"(*", " ", 
            RowBox[{
            "recolored", " ", "edges", " ", "propagate", " ", "their", " ", 
             "change", " ", "and", " ", "freeze", " ", "vertex", " ", 
             "sites"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "recolored", " ", "vertex", " ", "sites", " ", "pass", " ", 
              "their", " ", "color", " ", "to", " ", "outgoing", " ", 
              "edges"}], ",", " ", 
             RowBox[{
             "which", " ", "will", " ", "initially", " ", "be", " ", 
              "frozen"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", "E\[Null]"}], ",", "fast"}],
             "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "if", " ", "a", " ", "recoloring", " ", "clashes", " ", "with", 
              " ", "a", " ", "neighbor"}], ",", " ", 
             RowBox[{
             "initiate", " ", "a", " ", "fast", " ", "reversion", " ", "to", 
              " ", "restore", " ", "the", " ", "original", " ", "colors"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{"E\[Null]", "+", "V"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "edge", " ", "propagates", " ", 
             "rejeection", " ", "to", " ", "neighboring", " ", "vertex", " ", 
             "sites"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{"V", "+", "V"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "vertex", " ", "site", " ", 
             "propagates", " ", "rejection", " ", "to", " ", "neighboring", 
             " ", "vertex", " ", "sites"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", 
             RowBox[{"V", "+", "E\[Null]"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "vertex", " ", "site", " ", 
             "propagates", " ", "rejection", " ", "to", " ", "neighboring", 
             " ", "edge"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", "V"}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "vertex", " ", "site", " ", "adopts", 
             " ", "color", " ", "of", " ", "any", " ", "remaining", " ", 
             "unchanged", " ", "site", " ", "or", " ", "restored", " ", 
             "site"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", "E\[Null]"}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "edge", " ", "adopts", " ", "color", 
             " ", "of", " ", "any", " ", "remaining", " ", "unchanged", " ", 
             "site", " ", "or", " ", "restored", " ", "site"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{"E\[Null]", ",", 
             RowBox[{"e", "[", "c1", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", "things", " ", "got", " ", "stuck"}], ",", 
             " ", 
             RowBox[{"color", " ", "somehow"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{"V", ",", 
             RowBox[{"v", "[", "c1", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", "things", " ", "got", " ", "stuck"}], ",", 
             " ", 
             RowBox[{"color", " ", "somehow"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "[", "c2", "]"}], ",", 
             RowBox[{"v", "[", "c2", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"slowly", " ", "melt", " ", "frozen", " ", "nodes"}], 
             ",", " ", 
             RowBox[{
             "allowing", " ", "them", " ", "to", " ", "change", " ", 
              "again"}]}], "  ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "[", "c2", "]"}], ",", 
             RowBox[{"e", "[", "c2", "]"}], ",", "slow"}], "]"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"slowly", " ", "melt", " ", "frozen", " ", "nodes"}], ",",
             " ", 
            RowBox[{
            "allowing", " ", "them", " ", "to", " ", "change", " ", 
             "again"}]}], "  ", "*)"}], "\[IndentingNewLine]", "\t\t", "}"}], 
         ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "\t", "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RejectWaveColoringRules", "[", "k_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"colors", "=", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Green", ",", 
         RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], ",", 
      
      RowBox[{"freezecolors", "=", 
       RowBox[{"{", 
        RowBox[{
        "LightPink", ",", "LightGreen", ",", "LightMagenta", ",", 
         "LightBrown"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w", "\[Rule]", "White"}], ",", 
         RowBox[{"E\[Null]", "->", "Yellow"}], ",", 
         RowBox[{"V", "->", "Yellow"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"freezecolors", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"E\[Null]", "[", "i", "]"}], "->", 
            RowBox[{"Darker", "[", 
             RowBox[{"freezecolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.864869345962461*^9, 3.864869425537858*^9}, {
  3.864869648869812*^9, 3.86486966377658*^9}},
 CellLabel->
  "In[408]:=",ExpressionUUID->"9b4e0e9a-559a-487b-b191-6562d321185b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareRejectWaveColoringLayout", "[", 
   RowBox[{"option_", ",", "slow_", ",", "fast_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
        RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
        RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
        "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfaceCRN", "=", 
      RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
       RowBox[{"k", ",", "slow", ",", "fast"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurface", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"RejectWaveColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cfsurfaceCRN", ",", " ", "cfsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRN", ",", "fsurface"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8648695019413767`*^9, 3.86486951885288*^9}, {
  3.864869580553462*^9, 3.86486958275313*^9}},
 CellLabel->
  "In[467]:=",ExpressionUUID->"02800625-b98f-4f5c-9a77-b4f3f83495f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareRejectWaveColoringLayout", "[", 
   RowBox[{"2", ",", "10", ",", "0.1"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "making", " ", "slow", " ", "fast", " ", "and", " ", "fast", " ", "slow", 
     " ", "seems", " ", "to", " ", "work", " ", "best"}], ",", " ", "again", 
    ",", " ", 
    RowBox[{"but", " ", 
     RowBox[{"why", "?"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.864869602860602*^9, 
  3.8648696061369333`*^9}},ExpressionUUID->"e5f7e767-74dd-4ddf-adcd-\
4c12b4cdc995"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareRejectWaveColoringLayout", "[", 
   RowBox[{"2", ",", "0.1", ",", "10"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "slow", " ", "being", " ", "slow", " ", "and", " ", "fast", " ", "being", 
    " ", "fast", " ", "seems", " ", "to", " ", "go", " ", "nowhere", " ", 
    RowBox[{"(", 
     RowBox[{"except", " ", "when", " ", "lucky"}], ")"}]}], " ", 
   "*)"}]}]], "Input",ExpressionUUID->"c250b494-246c-4872-95b0-68585eb35967"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareRejectWaveColoringLayout", "[", 
   RowBox[{"2", ",", "0.01", ",", "10"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "slow", " ", "being", " ", "even", " ", "slower", " ", "makes", " ", 
    "this", " ", "the", " ", "best", " ", 
    RowBox[{"CRN", "!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{3.8648696349154243`*^9},
 CellLabel->
  "In[468]:=",ExpressionUUID->"a3fe906c-2b6c-42a6-888d-bc5629d634fc"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{{3.8648696259686728`*^9, 3.864869637629013*^9}, 
   3.86486967465094*^9, 3.864870060090767*^9, {3.8649192701072083`*^9, 
   3.86491928864819*^9}},
 CellLabel->
  "During evaluation of \
In[468]:=",ExpressionUUID->"aa2d5fc5-603a-438e-a10b-17746834e33f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"ShowSurfaceCRNState", "[", 
    RowBox[{"cfsurface", ",", "fsurfacecoloring", ",", 
     RowBox[{"PlotLabel", "\[Rule]", "fsurfacetime"}]}], "]"}], "]"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", "halted"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
        "cfsurface"}], "}"}], "=", 
      RowBox[{"InfoRunSurfaceCRN", "[", 
       RowBox[{"cfsurfaceCRN", ",", "cfsurface", ",", "1"}], "]"}]}], ";", 
     RowBox[{"fsurfacetime", "+=", "dt"}], ";", 
     RowBox[{"csurfaceevents", "+=", "devents"}]}]}], "]"}], ";"}]}], "Input",\

 CellLabel->
  "In[469]:=",ExpressionUUID->"9bc4270c-17b0-45aa-a0bb-e0f74f299a03"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`cfsurface, \
$CellContext`fsurfacecoloring, PlotLabel -> $CellContext`fsurfacetime], 
   StandardForm],
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{{3.864869638874983*^9, 3.864869678322094*^9}, 
   3.864870062437605*^9, 3.8649192914891233`*^9},
 CellLabel->
  "Out[469]=",ExpressionUUID->"b756fc58-d0d8-4a99-9891-e405d8583888"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.864869638874983*^9, 3.864869678322094*^9}, 
   3.864870062437605*^9, 3.864919355813957*^9},
 CellLabel->
  "Out[470]=",ExpressionUUID->"9780aa54-64d9-4dfe-bdc8-56d486a8ed05"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Surface Reject CRN; a final attempt to improve Surface Reject Wave CRN\
\>", "Subtitle",
 CellChangeTimes->{{3.8649280520129833`*^9, 3.8649280709783773`*^9}, 
   3.865011142874963*^9},ExpressionUUID->"664ba610-d11e-4afb-a0b8-\
f363cd8a41bf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceRejectColoringCRN", "[", 
   RowBox[{"k_", ",", "slow_", ",", "fast_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", " ", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "chooses", " ", "to", " ", 
              "recolor", " ", "but", " ", 
              RowBox[{"doesn", "'"}], "t", " ", "freeze"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", "E\[Null]"}], ",", "slow"}],
             "]"}], ",", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
               " ", "different"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "initiates", " ", "recoloring"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", "E\[Null]"}], ",", 
             RowBox[{"V", "+", "E\[Null]"}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "recoloring", " ", "command", " ", "spreads", " ", "from", " ", 
             "edges", " ", "to", " ", "vertices"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", "V"}], ",", 
             RowBox[{"V", "+", "V"}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "recoloring", " ", "command", " ", "spreads", " ", "from", " ", 
             "vertices", " ", "to", " ", "vertices"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{"V", "+", "E\[Null]"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "recoloring", " ", "command", " ", "spreads", " ", "to", " ", 
             "the", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"often", " ", "non"}], "-", "conflicting"}], ")"}], 
             " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", "E\[Null]"}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           
           RowBox[{"(*", " ", 
            RowBox[{
            "attempt", " ", "to", " ", "recolor", " ", "using", " ", "a", " ",
              "color", " ", "that", " ", 
             RowBox[{"doesn", "'"}], "t", " ", "conflict", " ", "with", " ", 
             "this", " ", "neighbor"}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"E\[Null]", "[", "c1", "]"}], "+", "V"}], ",", 
             RowBox[{
              RowBox[{"E\[Null]", "[", "c1", "]"}], "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "spread", " ", "the", " ", "new", " ", "color", " ", "to", " ", 
             "the", " ", "vertex", " ", "sites"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "spread", " ", "the", " ", "new", " ", "color", " ", "amongst", 
             " ", "vertex", " ", "sites"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", "E\[Null]"}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", "fast"}], "]"}], 
           ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "spread", " ", "the", " ", "new", " ", "color", " ", "to", " ", 
             "neighboring", " ", "edge"}], " ", "*)"}], "\[IndentingNewLine]",
            "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"E\[Null]", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{"e", "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "if", " ", "the", " ", "new", " ", "color", " ", "conflicts", 
              " ", "with", " ", "some", " ", "other", " ", "edge"}], ",", " ", 
             RowBox[{"it", " ", "must", " ", "be", " ", "rejected"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"E\[Null]", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", 
             RowBox[{"e", "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "if", " ", "neighbors", " ", "both", " ", "try", " ", "to", " ", 
              "recolor", " ", "to", " ", "the", " ", "same", " ", "color", 
              " ", "simultaneously"}], ",", " ", 
             RowBox[{"reject", " ", "one"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"e", "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{"e", "+", "v"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejection", " ", "command", " ", "must", " ", "spread",
              " ", "to", " ", "the", " ", "vertex", " ", "sites"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"v", "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{"v", "+", "v"}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejection", " ", "command", " ", "must", " ", "spread",
              " ", "amongst", " ", "the", " ", "vertex", " ", "sites"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"v", "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", 
             RowBox[{"v", "+", "e"}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejection", " ", "command", " ", "must", " ", "spread",
              " ", "also", " ", "to", " ", "edge", " ", "sites"}], " ", 
            "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{"e", ",", "E\[Null]", ",", "1"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"once", " ", "rejected"}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "we", " ", "need", " ", "to", " ", "revert", " ", "to", " ", 
                 "all"}], "-", "E", "-", "and", "-", 
                RowBox[{"V", " ", "again"}]}], "..."}], " ", "on", " ", "a", 
              " ", "time", " ", "scale", " ", "faster", " ", "than", " ", 
              "the", " ", "recoloring", " ", "attempts"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "+", "v"}], ",", 
             RowBox[{"E\[Null]", "+", "V"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", "spread", " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "+", "v"}], ",", 
             RowBox[{"V", "+", "V"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", "spread", " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "+", "e"}], ",", 
             RowBox[{"V", "+", "E\[Null]"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", "spread", " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "[", "c1", "]"}], ",", 
             RowBox[{"e", "[", "c1", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"an", " ", "attempted", " ", "coloring"}], ",", " ", 
             RowBox[{"if", " ", "not", " ", "rejected"}], ",", " ", 
             RowBox[{"should", " ", "solidify"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "spread", " ", "the", " ", "new", " ", "color", " ", "to", " ", 
             "the", " ", "vertex", " ", "sites"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "spread", " ", "the", " ", "new", " ", "color", " ", "amongst", 
             " ", "vertex", " ", "sites"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "spread", " ", "the", " ", "new", " ", "color", " ", "to", " ", 
             "neighboring", " ", "edge"}], " ", "*)"}], "\[IndentingNewLine]",
            "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "[", "c1", "]"}], ",", "E\[Null]", ",", 
             "slow"}], "]"}], ",", 
           RowBox[{"rxn", "[", 
            RowBox[{
             RowBox[{"V", "[", "c1", "]"}], ",", "V", ",", "slow"}], "]"}], 
           ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "to", " ", "get", " ", "out", " ", "of", " ", "a", " ", 
              "possible", " ", "jam"}], ",", " ", 
             RowBox[{
             "convert", " ", "everything", " ", "to", " ", "E", " ", "and", 
              " ", "V"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "+", "E\[Null]"}], ",", 
             RowBox[{
              RowBox[{"E\[Null]", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", "slow"}], "]"}]}], 
          "  ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
            "if", " ", "everything", " ", "is", " ", "E", " ", "and", " ", 
             "V"}], ",", " ", 
            RowBox[{
            "must", " ", "start", " ", "coloring", " ", "somewhere"}]}], " ", 
           "*)"}], "\[IndentingNewLine]", "\t\t", "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "\t", "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RejectColoringRules", "[", "k_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"colors", "=", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Green", ",", 
         RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], ",", 
      
      RowBox[{"freezecolors", "=", 
       RowBox[{"{", 
        RowBox[{
        "LightPink", ",", "LightGreen", ",", "LightMagenta", ",", 
         "LightBrown"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w", "\[Rule]", "White"}], ",", 
         RowBox[{"E\[Null]", "->", "Yellow"}], ",", 
         RowBox[{"V", "->", "Yellow"}], ",", 
         RowBox[{"e", "->", "Cyan"}], ",", 
         RowBox[{"v", "->", "Cyan"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"freezecolors", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"E\[Null]", "[", "i", "]"}], "->", 
            RowBox[{"Darker", "[", 
             RowBox[{"freezecolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.864928097898613*^9, 3.864928143408247*^9}, {
  3.864928352559101*^9, 3.8649284011119127`*^9}},
 CellLabel->
  "In[479]:=",ExpressionUUID->"d8564d13-6208-424e-bbf1-c79305bfb85d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PrepareRejectColoringLayout", "[", 
   RowBox[{"option_", ",", "slow_", ",", "fast_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
        RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
        RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
        "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfaceCRN", "=", 
      RowBox[{"SurfaceRejectColoringCRN", "[", 
       RowBox[{"k", ",", "slow", ",", "fast"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurface", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"RejectColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cfsurfaceCRN", ",", " ", "cfsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRN", ",", "fsurface"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrepareRejectColoringLayout", "[", 
   RowBox[{"2", ",", "0.1", ",", "100"}], "]"}], " "}]}], "Input",
 CellChangeTimes->{{3.864928440255987*^9, 3.864928494228097*^9}},
 CellLabel->
  "In[482]:=",ExpressionUUID->"05d041cf-b333-4e96-b904-38856bc44f69"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{3.864928496360016*^9},
 CellLabel->
  "During evaluation of \
In[482]:=",ExpressionUUID->"049f13d1-7d6a-466a-991a-20483a3e093d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"ShowSurfaceCRNState", "[", 
    RowBox[{"cfsurface", ",", "fsurfacecoloring", ",", 
     RowBox[{"PlotLabel", "\[Rule]", "fsurfacetime"}]}], "]"}], "]"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", "halted"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
        "cfsurface"}], "}"}], "=", 
      RowBox[{"InfoRunSurfaceCRN", "[", 
       RowBox[{"cfsurfaceCRN", ",", "cfsurface", ",", "1"}], "]"}]}], ";", 
     RowBox[{"fsurfacetime", "+=", "dt"}], ";", 
     RowBox[{"csurfaceevents", "+=", "devents"}]}]}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{3.864928533143887*^9},
 CellLabel->
  "In[485]:=",ExpressionUUID->"a7ebd154-5073-4de2-bbbb-7e545e775160"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`cfsurface, \
$CellContext`fsurfacecoloring, PlotLabel -> $CellContext`fsurfacetime], 
   StandardForm],
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{{3.8649285049351883`*^9, 3.864928534113443*^9}},
 CellLabel->
  "Out[485]=",ExpressionUUID->"be9f31cd-4d5d-4f98-a906-4a97059cdaf9"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.86492807405173*^9},ExpressionUUID->"ff703a3c-0d9b-4844-99fa-51d976eb4b04"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Statistics and Metrics", "Subtitle",
 CellChangeTimes->{{3.864870778450914*^9, 
  3.86487078522148*^9}},ExpressionUUID->"fbcf7d49-d4ee-4bb0-98f3-\
441e450c012a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindColorableMap", "[", 
   RowBox[{"n_", ",", "m_", ",", "p_", ",", "q_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "SATtime", ",", "sat", ",", 
      RowBox[{"colorable", "=", "False"}], ",", 
      RowBox[{"attempts", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", "colorable"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"n", ",", "m", ",", "p", ",", "q"}], "]"}]}], ";", 
        RowBox[{"attempts", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sat", "=", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SATtime", ",", "colorable"}], "}"}], "=", 
         RowBox[{"AbsoluteTiming", "[", 
          RowBox[{"SatisfiableQ", "[", "sat", "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"attempts", ">", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<It took \>\"", ",", "attempts", ",", 
         "\"\< attempts to find a colorable graph!\>\""}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"attempts", ",", "map", ",", 
       RowBox[{"VertexCount", "[", "graph", "]"}], ",", 
       RowBox[{"EdgeCount", "[", "graph", "]"}], ",", "SATtime"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[420]:=",ExpressionUUID->"51811813-3254-4885-8ac7-1b093bbce73c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SurfaceMapColoringTimes", "[", 
   RowBox[{"map_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"CRNtime", ",", 
      RowBox[{"dt", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fsurfaceCRNorig", "=", 
      RowBox[{"SurfaceMapColoringCRN", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfaceorig", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"MapColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fsurfaceCRN", ",", " ", "fsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRNorig", ",", "fsurfaceorig"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CRNtime", ",", "fsurface"}], "}"}], "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", "halted"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ddt", ",", "eventcount", ",", "halted"}], "}"}], ",", 
              "fsurface"}], "}"}], "=", 
            RowBox[{"InfoRunSurfaceCRN", "[", 
             RowBox[{"fsurfaceCRN", ",", "fsurface", ",", "dt"}], "]"}]}], 
           ";", 
           RowBox[{"fsurfacetime", "+=", "ddt"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "fsurface"}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "CRNtime"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864871033028861*^9, 3.864871034077691*^9}, {
   3.864871475081355*^9, 3.864871514576119*^9}, {3.864871756611927*^9, 
   3.8648717873410883`*^9}, 3.864873461634918*^9},
 CellLabel->
  "In[429]:=",ExpressionUUID->"2135b270-ee9b-49a3-b08b-be70464771e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MapColoringStats", "[", 
    RowBox[{"map_", ",", "k_", ",", "trials_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"SurfaceMapColoringTimes", "[", 
          RowBox[{"map", ",", "k"}], "]"}], ",", "trials"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Around", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "data", "]"}], ",", 
        RowBox[{"StandardDeviation", "[", "data", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.864928575989748*^9},ExpressionUUID->"b313ccf8-d844-4f49-92e4-\
299369f13b87"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SurfaceWalkColoringTimes", "[", 
   RowBox[{"map_", ",", "k_", ",", 
    RowBox[{"slow_", ":", "1"}], ",", 
    RowBox[{"fast_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"CRNtime", ",", 
      RowBox[{"dt", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fsurfaceCRNorig", "=", 
      RowBox[{"SurfaceWalkColoringCRN", "[", 
       RowBox[{"k", ",", " ", "fast", ",", " ", "slow"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfaceorig", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"WalkColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fsurfaceCRN", ",", " ", "fsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRNorig", ",", "fsurfaceorig"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CRNtime", ",", "fsurface"}], "}"}], "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", "halted"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ddt", ",", "eventcount", ",", "halted"}], "}"}], ",", 
              "fsurface"}], "}"}], "=", 
            RowBox[{"InfoRunSurfaceCRN", "[", 
             RowBox[{"fsurfaceCRN", ",", "fsurface", ",", "dt"}], "]"}]}], 
           ";", 
           RowBox[{"fsurfacetime", "+=", "ddt"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "fsurface"}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "CRNtime"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864919431852973*^9, 3.864919526732025*^9}},
 CellLabel->
  "In[471]:=",ExpressionUUID->"6ea31c4b-d9e8-4903-a5be-655c098abec6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"WalkColoringStats", "[", 
   RowBox[{"map_", ",", "k_", ",", "slow_", ",", "fast_", ",", "trials_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SurfaceWalkColoringTimes", "[", 
         RowBox[{"map", ",", "k", ",", "slow", ",", "fast"}], "]"}], ",", 
        "trials"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Around", "[", 
      RowBox[{
       RowBox[{"Mean", "[", "data", "]"}], ",", 
       RowBox[{"StandardDeviation", "[", "data", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.86491953161306*^9, 3.8649195682415953`*^9}, 
   3.8649285636430817`*^9},ExpressionUUID->"e683495b-05d5-4579-9ffd-\
2f255bd0a8fe"],

Cell[BoxData[""], "Input",ExpressionUUID->"3cfa5706-921a-4087-9ff6-93e722c6e238"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RejectWaveColoringTimes", "[", 
   RowBox[{"map_", ",", "k_", ",", 
    RowBox[{"slow_", ":", "1"}], ",", 
    RowBox[{"fast_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"CRNtime", ",", 
      RowBox[{"dt", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fsurfaceCRNorig", "=", 
      RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
       RowBox[{"k", ",", "slow", ",", "fast"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfaceorig", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloringorig", "=", 
      RowBox[{"RejectWaveColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fsurfaceCRN", ",", " ", "fsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRNorig", ",", "fsurfaceorig"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CRNtime", ",", "fsurface"}], "}"}], "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", "halted"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ddt", ",", "eventcount", ",", "halted"}], "}"}], ",", 
              "fsurface"}], "}"}], "=", 
            RowBox[{"InfoRunSurfaceCRN", "[", 
             RowBox[{"fsurfaceCRN", ",", "fsurface", ",", "dt"}], "]"}]}], 
           ";", 
           RowBox[{"fsurfacetime", "+=", "ddt"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "fsurface"}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "CRNtime"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864873724495475*^9, 3.864873743243861*^9}, {
  3.864928572024324*^9, 
  3.864928572592741*^9}},ExpressionUUID->"1f7d109c-b783-4ce6-9c55-\
b9c863bee336"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RejectWaveColoringStats", "[", 
    RowBox[{"map_", ",", "k_", ",", "slow_", ",", "fast_", ",", "trials_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RejectWaveColoringTimes", "[", 
          RowBox[{"map", ",", "k", ",", "slow", ",", "fast"}], "]"}], ",", 
         "trials"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Around", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "data", "]"}], ",", 
        RowBox[{"StandardDeviation", "[", "data", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.864928581730791*^9},ExpressionUUID->"9ccb0171-ef15-4383-92a9-\
36044cfeb694"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RejectColoringTimes", "[", 
   RowBox[{"map_", ",", "k_", ",", 
    RowBox[{"slow_", ":", "1"}], ",", 
    RowBox[{"fast_", ":", "1"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"CRNtime", ",", 
      RowBox[{"dt", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fsurfaceCRNorig", "=", 
      RowBox[{"SurfaceRejectColoringCRN", "[", 
       RowBox[{"k", ",", "slow", ",", "fast"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfaceorig", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloringorig", "=", 
      RowBox[{"RejectColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fsurfaceCRN", ",", " ", "fsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRNorig", ",", "fsurfaceorig"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CRNtime", ",", "fsurface"}], "}"}], "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", "halted"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ddt", ",", "eventcount", ",", "halted"}], "}"}], ",", 
              "fsurface"}], "}"}], "=", 
            RowBox[{"InfoRunSurfaceCRN", "[", 
             RowBox[{"fsurfaceCRN", ",", "fsurface", ",", "dt"}], "]"}]}], 
           ";", 
           RowBox[{"fsurfacetime", "+=", "ddt"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "fsurface"}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "CRNtime"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.864928591109468*^9, {3.864928636729294*^9, 3.864928678201705*^9}},
 CellLabel->
  "In[487]:=",ExpressionUUID->"08d24e51-83f0-4a36-b0bf-b198b96d2049"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RejectColoringStats", "[", 
    RowBox[{"map_", ",", "k_", ",", "slow_", ",", "fast_", ",", "trials_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RejectColoringTimes", "[", 
          RowBox[{"map", ",", "k", ",", "slow", ",", "fast"}], "]"}], ",", 
         "trials"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Around", "[", 
       RowBox[{
        RowBox[{"Mean", "[", "data", "]"}], ",", 
        RowBox[{"StandardDeviation", "[", "data", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8649286444211693`*^9, 3.864928645368723*^9}, {
  3.8649286854302998`*^9, 3.864928689861775*^9}},
 CellLabel->
  "In[488]:=",ExpressionUUID->"29080710-5fce-48a9-911d-3500c735d884"],

Cell[BoxData[
 RowBox[{
  RowBox[{"referencemap", "=", 
   RowBox[{
    RowBox[{"FindColorableMap", "[", 
     RowBox[{"10", ",", "10", ",", "0.3", ",", "0.9", ",", "3"}], "]"}], "[", 
    
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[422]:=",ExpressionUUID->"43e3b6f1-93d0-4af9-9881-e8b44aeebfdd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "10"}], "]"}]], "Input",
 CellChangeTimes->{
  3.864846985199675*^9, {3.864873273809226*^9, 3.86487328023311*^9}, 
   3.864873764270014*^9},
 CellLabel->
  "In[473]:=",ExpressionUUID->"8f8efea9-a618-4d33-9915-df5cbedb5be3"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{"34.", "30."},
   "Around"],
  Around[33.736419999999995`, 29.953593755108738`]]], "Output",
 CellChangeTimes->{3.8649199377492113`*^9},
 CellLabel->
  "Out[473]=",ExpressionUUID->"f7b5d57e-3543-4023-b08f-d0065da08004"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"WalkColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "0.1", ",", "10", ",", "100"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.864919590117749*^9, 3.864919599065571*^9}},
 CellLabel->
  "In[474]:=",ExpressionUUID->"da2fe06b-468c-4fb3-ad4c-8beda48af712"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{"42.", "40."},
   "Around"],
  Around[41.77153527, 40.11142440484197]]], "Output",
 CellChangeTimes->{3.864873385058852*^9, 3.864873644762418*^9, 
  3.864924115710446*^9},
 CellLabel->
  "Out[474]=",ExpressionUUID->"cbe849b5-947f-480e-a5b2-5ad739196d9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RejectWaveColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "10", ",", ".1", ",", "10"}], 
  "]"}]], "Input",
 CellLabel->
  "In[475]:=",ExpressionUUID->"400bdf3e-4f24-430e-accc-0733cf0f5132"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{"10.", "8."},
   "Around"],
  Around[9.7208033, 7.644508587072103]]], "Output",
 CellChangeTimes->{3.86487395816092*^9, 3.864924213556476*^9},
 CellLabel->
  "Out[475]=",ExpressionUUID->"a80a3fd5-eb4b-4e71-81e7-18305254c4da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RejectWaveColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "0.01", ",", "10", ",", "100"}], 
  "]"}]], "Input",
 CellLabel->
  "In[476]:=",ExpressionUUID->"5ea3f04c-c376-4317-87a4-5ba149b458cc"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{"22.", "24."},
   "Around"],
  Around[22.37228194999999, 24.013555123146723`]]], "Output",
 CellChangeTimes->{3.864913786742042*^9, 3.864926768171852*^9},
 CellLabel->
  "Out[476]=",ExpressionUUID->"9608d0a5-488c-4659-ad43-b958c1012d60"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RejectColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "10", ",", ".5", ",", "10"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.864928717421981*^9, 3.864928717909006*^9}},
 CellLabel->
  "In[489]:=",ExpressionUUID->"42f832f9-cffe-4a57-9d19-81b8f7497b3a"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{"178.", "119."},
   "Around"],
  Around[178.225213, 119.33846916573151`]]], "Output",
 CellChangeTimes->{3.864930503896207*^9},
 CellLabel->
  "Out[489]=",ExpressionUUID->"cb8b06b8-149e-42fd-a1ee-cda40774941b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"RejectColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "0.01", ",", "10", ",", "100"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8649287196124887`*^9, 3.864928720353047*^9}},
 CellLabel->
  "In[490]:=",ExpressionUUID->"296d971e-9d02-4704-b194-528bbb6fd14d"],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 2}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 4},ExpressionUUID->"7ff1534e-6571-4506-9f03-b7304819ce24"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ColoringEventCount", "[", 
   RowBox[{"CRN_", ",", "CRNcolors_", ",", "k_", ",", "size_", ",", 
    RowBox[{"pq_", ":", 
     RowBox[{"{", 
      RowBox[{"0.2", ",", "0.5"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", 
      RowBox[{"colorable", "=", "False"}], ",", 
      RowBox[{"p", "=", 
       RowBox[{"First", "[", "pq", "]"}]}], ",", 
      RowBox[{"q", "=", 
       RowBox[{"Last", "[", "pq", "]"}]}], ",", "abstime", ",", "results"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", "colorable"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"size", ",", "size", ",", "p", ",", "q"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"colorable", "=", 
         RowBox[{"SatisfiableQ", "[", 
          RowBox[{"ColoringSAT", "[", 
           RowBox[{"graph", ",", "k"}], "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"for", " ", "hard", " ", "coloring"}], ",", " ", 
       RowBox[{
       "this", " ", "might", " ", "take", " ", "a", " ", "little", " ", 
        "while"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"fsurfaceCRNorig", "=", "CRN"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfaceorig", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", "CRNcolors"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fsurfaceCRN", ",", " ", "fsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRNorig", ",", "fsurfaceorig"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fevents", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"abstime", ",", "results"}], "}"}], "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"With", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dt", "=", 
            RowBox[{"1", "/", 
             RowBox[{"Min", "[", 
              RowBox[{"Last", "/@", "fsurfaceCRNorig"}], "]"}]}]}], "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"!", "halted"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"ddt", ",", "eventcount", ",", "halted"}], "}"}], 
                ",", "fsurface"}], "}"}], "=", 
              RowBox[{"InfoRunSurfaceCRN", "[", 
               RowBox[{"fsurfaceCRN", ",", "fsurface", ",", "dt"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"fsurfacetime", "+=", "ddt"}], ";", 
             RowBox[{"fevents", "+=", "eventcount"}]}]}], "]"}]}], "]"}], 
        ";"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"abstime", ",", "fevents"}], "}"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.864928827943386*^9, {3.864929100784587*^9, 3.864929124945418*^9}, {
   3.8649292468395147`*^9, 3.864929290370846*^9}, 
   3.8650114927651*^9},ExpressionUUID->"98b9762d-306c-40ce-940a-5d89c7dd5301"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
   "CRN_", ",", "CRNcolors_", ",", " ", "k_", ",", "trials_", ",", 
    "timelimit_", ",", 
    RowBox[{"pq_", ":", 
     RowBox[{"{", 
      RowBox[{"0.2", ",", "0.5"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"realtime", ",", "eventcount", ",", "size", ",", "tempdata"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"coloringdata", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"realtime", "=", 
      RowBox[{"Around", "[", 
       RowBox[{
        RowBox[{"timelimit", "/", "2"}], ",", 
        RowBox[{"timelimit", "/", "10"}]}], "]"}]}], ";", 
     RowBox[{"size", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"realtime", "[", "\"\<Value\>\"", "]"}], "<", "timelimit"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempdata", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ColoringEventCount", "[", 
            RowBox[{
            "CRN", ",", "CRNcolors", ",", "3", ",", "size", ",", "pq"}], 
            "]"}], ",", "trials"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"realtime", ",", "eventcount"}], "}"}], "=", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Around", "[", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{"First", "/@", "tempdata"}], "]"}], ",", 
              RowBox[{
               RowBox[{"StandardDeviation", "[", 
                RowBox[{"First", "/@", "tempdata"}], "]"}], "/", 
               RowBox[{"Sqrt", "[", "trials", "]"}]}]}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Around", "[", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{"Last", "/@", "tempdata"}], "]"}], ",", 
              RowBox[{
               RowBox[{"StandardDeviation", "[", 
                RowBox[{"Last", "/@", "tempdata"}], "]"}], "/", 
               RowBox[{"Sqrt", "[", "trials", "]"}]}]}], "]"}]}], "}"}], "//",
           "N"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"PrintTemporary", "[", 
         RowBox[{"{", 
          RowBox[{"size", ",", "eventcount", ",", "realtime"}], "}"}], "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"coloringdata", ",", 
          RowBox[{"{", 
           RowBox[{"size", ",", "eventcount"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"size", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "coloringdata"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",ExpressionUU\
ID->"df7e04cc-e8c2-4e3c-bde1-73a35e2cd0a6"],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 3},ExpressionUUID->"9297742d-c3fb-42c0-85a4-ca8f793f25f1"],

Cell[BoxData[
 RowBox[{"MapColoringDataEasy", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceMapColoringCRN", "[", "3", "]"}], ",", 
    RowBox[{"MapColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "10"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864929733486932*^9, 
  3.8649297335133867`*^9}},ExpressionUUID->"ef072a5f-b326-43d9-993d-\
4078ddcd62b0"],

Cell[BoxData[
 RowBox[{"FreezeColoringDataEasy", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceFreezeColoringCRN", "[", 
     RowBox[{"3", ",", "10"}], "]"}], ",", 
    RowBox[{"FreezeColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "10"}], "]"}]}]], "Input",ExpressionUUID->"7af814d5-0baf-44fc-990c-\
f2ff019efcb2"],

Cell[BoxData[
 RowBox[{"WaveColoringDataEasy", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceWaveColoringCRN", "[", 
     RowBox[{"3", ",", "0.5"}], "]"}], ",", 
    RowBox[{"WaveColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "10"}], "]"}]}]], "Input",ExpressionUUID->"2579e2c0-baf0-426c-b3d8-\
72fe4c0c3c70"],

Cell[BoxData[
 RowBox[{"RejectWaveColoringDataEasy", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
     RowBox[{"3", ",", "0.01", ",", "10"}], "]"}], ",", 
    RowBox[{"RejectWaveColoringRules", "[", "3", "]"}], ",", "3", ",", "25", 
    ",", "10"}], "]"}]}]], "Input",ExpressionUUID->"8913df6e-8629-4e41-8857-\
a2ce2ea809fe"],

Cell[BoxData[
 RowBox[{"RejectColoringDataEasy", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceRejectColoringCRN", "[", 
     RowBox[{"3", ",", "0.1", ",", "100"}], "]"}], ",", 
    RowBox[{"RejectColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "10"}], "]"}]}]], "Input",ExpressionUUID->"0cb9e899-ff46-4e39-bb86-\
d514e59133eb"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "MapColoringDataEasy", ",", "FreezeColoringDataEasy", ",", 
     "WaveColoringDataEasy", ",", "RejectWaveColoringDataEasy", ",", 
     "RejectColoringDataEasy"}], "}"}], ",", 
   RowBox[{"Joined", "->", "True"}], ",", 
   RowBox[{"PlotRange", "->", "All"}], ",", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Map\>\"", ",", "\"\<Freeze\>\"", ",", "\"\<Wave\>\"", ",", 
      "\"\<RejectWave\>\"", ",", "\"\<Reject\>\""}], "}"}]}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Grid Dimensions\>\"", ",", 
      "\"\<Average Number of Reaction Events\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "->", "\"\<Easy Params\>\""}]}], "]"}]], "Input",Expre\
ssionUUID->"4ef13113-294d-46bc-be89-43f983e5aa9d"],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 3},ExpressionUUID->"d0eec615-43a2-4b3a-bca9-bcfc34ae2740"],

Cell[BoxData[
 RowBox[{"MapColoringDataMedium", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceMapColoringCRN", "[", "3", "]"}], ",", 
    RowBox[{"MapColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "10", ",", 
    RowBox[{"{", 
     RowBox[{"0.25", ",", "0.7"}], "}"}]}], "]"}]}]], "Input",ExpressionUUID->\
"221185c8-bf54-4241-997c-2365c2379201"],

Cell[BoxData[
 RowBox[{"FreezeColoringDataMedium", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceFreezeColoringCRN", "[", 
     RowBox[{"3", ",", "10"}], "]"}], ",", 
    RowBox[{"FreezeColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "10", ",", 
    RowBox[{"{", 
     RowBox[{"0.25", ",", "0.7"}], "}"}]}], "]"}]}]], "Input",ExpressionUUID->\
"70a79637-75b1-4013-bfd5-c0f72f89430f"],

Cell[BoxData[
 RowBox[{"WaveColoringDataMedium", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceWaveColoringCRN", "[", 
     RowBox[{"3", ",", "0.5"}], "]"}], ",", 
    RowBox[{"WaveColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "10", ",", 
    RowBox[{"{", 
     RowBox[{"0.25", ",", "0.7"}], "}"}]}], "]"}]}]], "Input",ExpressionUUID->\
"e2eb6f1c-f7a8-41e5-afc6-dd363a20e5cd"],

Cell[BoxData[
 RowBox[{"RejectWaveColoringDataMedium", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
     RowBox[{"3", ",", "0.01", ",", "10"}], "]"}], ",", 
    RowBox[{"RejectWaveColoringRules", "[", "3", "]"}], ",", "3", ",", "25", 
    ",", "10", ",", 
    RowBox[{"{", 
     RowBox[{"0.25", ",", "0.7"}], "}"}]}], "]"}]}]], "Input",ExpressionUUID->\
"b5903bf2-8e30-468e-938f-d832a8d15976"],

Cell[BoxData[
 RowBox[{"RejectColoringDataMedium", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceRejectColoringCRN", "[", 
     RowBox[{"3", ",", "0.1", ",", "100"}], "]"}], ",", 
    RowBox[{"RejectColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "10", ",", 
    RowBox[{"{", 
     RowBox[{"0.25", ",", "0.7"}], "}"}]}], "]"}]}]], "Input",ExpressionUUID->\
"a9db3866-8279-43b3-8dde-484f2d5b9c0e"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "MapColoringDataMedium", ",", "FreezeColoringDataMedium", ",", 
     "WaveColoringDataMedium", ",", "RejectWaveColoringDataMedium", ",", 
     "RejectColoringDataMedium"}], "}"}], ",", 
   RowBox[{"Joined", "->", "True"}], ",", 
   RowBox[{"PlotRange", "->", "All"}], ",", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Map\>\"", ",", "\"\<Freeze\>\"", ",", "\"\<Wave\>\"", ",", 
      "\"\<RejectWave\>\"", ",", "\"\<Reject\>\""}], "}"}]}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Grid Dimensions\>\"", ",", 
      "\"\<Average Number of Reaction Events\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "->", "\"\<Medium Params\>\""}]}], "]"}]], "Input",Exp\
ressionUUID->"1daf1a53-ac16-493a-b4a0-528f57bd92a6"],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 3},ExpressionUUID->"40c31039-0f29-441e-914b-19a01e6496f9"],

Cell[BoxData[
 RowBox[{"MapColoringDataHard", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceMapColoringCRN", "[", "3", "]"}], ",", 
    RowBox[{"MapColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "20", ",", 
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.9"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864930112618795*^9, 3.864930112785555*^9}, {
  3.864930441767337*^9, 
  3.864930441966215*^9}},ExpressionUUID->"bff1dbb5-2f90-49e7-a61a-\
75234325917e"],

Cell[BoxData[
 RowBox[{"FreezeColoringDataHard", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceFreezeColoringCRN", "[", 
     RowBox[{"3", ",", "10"}], "]"}], ",", 
    RowBox[{"FreezeColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "20", ",", 
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.9"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864930110378666*^9, 3.864930110438737*^9}, {
  3.86493043959373*^9, 
  3.8649304397246*^9}},ExpressionUUID->"3b470396-08fe-423b-9bbc-2a1dd01c4e23"],

Cell[BoxData[
 RowBox[{"WaveColoringDataHard", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceWaveColoringCRN", "[", 
     RowBox[{"3", ",", "0.5"}], "]"}], ",", 
    RowBox[{"WaveColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "20", ",", 
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.9"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8649301084318743`*^9, 3.864930108539303*^9}, {
  3.864930438408659*^9, 
  3.864930438524185*^9}},ExpressionUUID->"9860836c-2f20-45ea-bf20-\
fef461dea3b0"],

Cell[BoxData[
 RowBox[{"RejectWaveColoringDataHard", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
     RowBox[{"3", ",", "0.01", ",", "10"}], "]"}], ",", 
    RowBox[{"RejectWaveColoringRules", "[", "3", "]"}], ",", "3", ",", "25", 
    ",", "20", ",", 
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.9"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8649301052439423`*^9, 3.864930105345619*^9}, {
  3.864930432913535*^9, 
  3.864930433048459*^9}},ExpressionUUID->"67c33f67-e423-4f79-afd7-\
1e7ab8ff5d63"],

Cell[BoxData[
 RowBox[{"RejectColoringDataHard", "=", 
  RowBox[{"CollectColoringStats", "[", 
   RowBox[{
    RowBox[{"SurfaceRejectColoringCRN", "[", 
     RowBox[{"3", ",", "0.1", ",", "100"}], "]"}], ",", 
    RowBox[{"RejectColoringRules", "[", "3", "]"}], ",", "3", ",", "25", ",", 
    "20", ",", 
    RowBox[{"{", 
     RowBox[{"0.3", ",", "0.9"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8649301037778273`*^9, 3.8649301038618593`*^9}, {
  3.864930431326159*^9, 
  3.864930431818472*^9}},ExpressionUUID->"98bb7781-0ed7-430a-bb49-\
fffe0e930e8f"],

Cell[BoxData[
 RowBox[{"ListLogPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "MapColoringDataHard", ",", "FreezeColoringDataHard", ",", 
     "WaveColoringDataHard", ",", "RejectWaveColoringDataHard", ",", 
     "RejectColoringDataHard"}], "}"}], ",", 
   RowBox[{"Joined", "->", "True"}], ",", 
   RowBox[{"PlotRange", "->", "All"}], ",", 
   RowBox[{"PlotLegends", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Map\>\"", ",", "\"\<Freeze\>\"", ",", "\"\<Wave\>\"", ",", 
      "\"\<RejectWave\>\"", ",", "\"\<Reject\>\""}], "}"}]}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Grid Dimensions\>\"", ",", 
      "\"\<Average Number of Reaction Events\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "->", "\"\<Hard Params\>\""}]}], "]"}]], "Input",Expre\
ssionUUID->"761b541b-3ffc-4fcb-8838-0147771914c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\

Petford-Welsh\
\>", "Subtitle",
 CellChangeTimes->{{3.865011113999599*^9, 
  3.865011135081059*^9}},ExpressionUUID->"1558f0d1-ae38-476e-992c-\
5aa1972fb40c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AssessPetfordWelsh", "[", 
   RowBox[{"crn_", ",", "newedge_", ",", 
    RowBox[{"{", 
     RowBox[{"c1_", ",", "c2_", ",", "c3_", ",", "c4_"}], "}"}], ",", "c0_", 
    ",", 
    RowBox[{"trials_", ":", "1000"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"template", ",", "map", ",", "data", ",", 
      RowBox[{"dt", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"trials", "==", 
          RowBox[{"-", "1"}]}], ",", "0.1", ",", "100"}], "]"}]}]}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"trials", " ", "==", " ", 
       RowBox[{
        RowBox[{"-", "1"}], " ", "means", " ", "to", " ", "ddo", " ", "one", 
        " ", "trial"}]}], ",", " ", 
      RowBox[{"very", " ", "slowly"}], ",", " ", 
      RowBox[{
      "so", " ", "it", " ", "can", " ", "be", " ", "watched", " ", "with", 
       " ", "a", " ", "dynamic", " ", "printout"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"template", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "v", ",", "w", ",",
           "w", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", "w", ",",
           "w", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", "w", ",",
           "w", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "v", ",",
           "v", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "v", ",",
           "v", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "v", ",", "e", ",", "e", ",", "v", ",", "v", ",", "v", ",", "v", ",",
           "v", ",", "e", ",", "e", ",", "v"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "v", ",",
           "v", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "v", ",",
           "v", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", "w", ",",
           "w", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", "w", ",",
           "w", ",", "w", ",", "w", ",", "w"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
         "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "v", ",", "w", ",",
           "w", ",", "w", ",", "w", ",", "w"}], "}"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"map", "=", 
      RowBox[{"template", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"v", "->", 
          RowBox[{"v", "[", "c0", "]"}]}], ",", 
         RowBox[{"e", "->", 
          RowBox[{"e", "[", "c0", "]"}]}]}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "6"}], "]"}], "]"}], "=", 
      RowBox[{"v", "[", "c1", "]"}]}], ";", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "6"}], "]"}], "]"}], "=", 
      RowBox[{"e", "[", "c1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "11"}], "]"}], "]"}], "=", 
      RowBox[{"v", "[", "c2", "]"}]}], ";", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "10"}], "]"}], "]"}], "=", 
      RowBox[{"e", "[", "c2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"11", ",", "6"}], "]"}], "]"}], "=", 
      RowBox[{"v", "[", "c3", "]"}]}], ";", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"10", ",", "6"}], "]"}], "]"}], "=", 
      RowBox[{"e", "[", "c3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "1"}], "]"}], "]"}], "=", 
      RowBox[{"v", "[", "c4", "]"}]}], ";", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"6", ",", "2"}], "]"}], "]"}], "=", 
      RowBox[{"e", "[", "c4", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"map", "[", 
       RowBox[{"[", 
        RowBox[{"3", ",", "6"}], "]"}], "]"}], "=", "newedge"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"fsurfaceCRNorig", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"crn", ",", 
            RowBox[{"Except", "[", 
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"e", "[", "_", "]"}], "+", 
                RowBox[{"e", "[", "_", "]"}]}], ",", "_", ",", "_"}], "]"}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"fsurfaceorig", "=", "map"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"fsurfaceCRN", ",", " ", "fsurface"}], "}"}], "=", 
          RowBox[{"CompileSurfaceCRN", "[", 
           RowBox[{"fsurfaceCRNorig", ",", "fsurfaceorig"}], "]"}]}], ";", 
         " ", "\[IndentingNewLine]", 
         RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"!", "halted"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ddt", ",", "eventcount", ",", "halted"}], "}"}], ",",
                "fsurface"}], "}"}], "=", 
             RowBox[{"InfoRunSurfaceCRN", "[", 
              RowBox[{"fsurfaceCRN", ",", "fsurface", ",", "dt"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"trials", "==", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"Pause", "[", "0.1", "]"}]}], "]"}], ";"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"RevertSurfaceCRNState", "[", "fsurface", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "6"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Abs", "[", "trials", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"KeySort", "[", 
      RowBox[{"Counts", "[", "data", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.865011460786326*^9, 3.865011507166122*^9}, {
  3.865011824638576*^9, 3.86501182882999*^9}, {3.8650119448564243`*^9, 
  3.865011967891066*^9}},
 CellLabel->
  "In[588]:=",ExpressionUUID->"91aa29e3-0c9b-4b13-a4b0-dc66349210d6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AssessPetfordWelsh", "[", 
   RowBox[{
    RowBox[{"SurfaceWaveColoringCRN", "[", 
     RowBox[{"3", ",", "0.5"}], "]"}], ",", 
    RowBox[{"E\[Null]", "[", "2", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", "1", ",", 
    "10000"}], "]"}], " "}]], "Input",
 CellLabel->
  "In[589]:=",ExpressionUUID->"203328cd-1fc5-4a0f-a8ed-115eacae4bfe"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], "\[Rule]", "732"}], ",", 
   RowBox[{
    RowBox[{"v", "[", "2", "]"}], "\[Rule]", "7185"}], ",", 
   RowBox[{
    RowBox[{"v", "[", "3", "]"}], "\[Rule]", "2083"}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.865011893306611*^9, 3.8650119949060698`*^9},
 CellLabel->
  "Out[589]=",ExpressionUUID->"38cb819f-bc81-4243-b189-d1223bfccaf3"]
}, Open  ]],

Cell["", "Text",
 CellChangeTimes->{{3.864837884452323*^9, 3.864837886676248*^9}, {
   3.8648388594132147`*^9, 3.864838882079335*^9}, 3.864845002590157*^9, {
   3.8648452237856503`*^9, 3.8648452243390493`*^9}, 3.8648457886709137`*^9, 
   3.864846370378364*^9, 
   3.864929732234551*^9},ExpressionUUID->"005ddb10-38dd-4514-8696-\
37fee3e24a87"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.865011860758348*^9, 
  3.865011860975409*^9}},ExpressionUUID->"c69938e0-c9a9-42be-ac08-\
960eff40f774"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{316, Automatic}, {Automatic, 50}},
Magnification->1.5,
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"db548663-cae8-49bc-8e95-80c966277e43"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 179, 3, 146, "Title",ExpressionUUID->"5377b741-064c-4bfd-9618-9c003df36aba"],
Cell[762, 27, 480, 11, 140, "Input",ExpressionUUID->"af126133-130f-4f5f-9bc9-3e5c1d8555de"],
Cell[CellGroupData[{
Cell[1267, 42, 170, 3, 79, "Subtitle",ExpressionUUID->"ad04706b-4c9c-4107-9bfd-b4b2ddcaa615"],
Cell[1440, 47, 2818, 57, 531, "Text",ExpressionUUID->"c79309bd-00ee-40c4-a32b-60a42fc3526b"],
Cell[4261, 106, 14208, 350, 966, "Code",ExpressionUUID->"db77a4dc-5fc7-4648-82df-4d4595ec3b3a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18506, 461, 206, 6, 127, "Subtitle",ExpressionUUID->"3536790e-3449-453b-87c1-c2d094ee4d28"],
Cell[18715, 469, 4547, 115, 485, "Code",ExpressionUUID->"1c1aa549-3870-48ca-8bd8-77c482da4641"],
Cell[CellGroupData[{
Cell[23287, 588, 3443, 78, 653, "Input",ExpressionUUID->"42d6d275-9d5b-41b8-a2df-ed14cf6989e4"],
Cell[26733, 668, 239, 5, 36, "Print",ExpressionUUID->"13ecba7e-0bc6-4787-b85b-8e057f9042c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27009, 678, 1811, 37, 219, "Input",ExpressionUUID->"752db4b5-bdde-454e-a617-7d5718c7bbb5"],
Cell[28823, 717, 942, 16, 345, "Output",ExpressionUUID->"8e3d9c82-4a13-4bf1-9327-ce8c7b873356"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29814, 739, 220, 4, 79, "Subtitle",ExpressionUUID->"0800482e-d0a4-4d57-a50d-7fa316592fd7"],
Cell[30037, 745, 10080, 242, 763, "Code",ExpressionUUID->"9a61a7b5-e66a-4633-a3f3-d323a83b67d5"],
Cell[CellGroupData[{
Cell[40142, 991, 3619, 80, 622, "Input",ExpressionUUID->"7f167c9f-c058-45ff-9504-2299899c358f"],
Cell[43764, 1073, 431, 8, 36, "Print",ExpressionUUID->"3261627a-0771-4620-b6f1-5cf681c3a169"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44232, 1086, 1079, 28, 188, "Input",ExpressionUUID->"78180cd0-fb4f-4019-a5f1-e43d4b44126f"],
Cell[45314, 1116, 654, 12, 345, "Output",ExpressionUUID->"bae51b4a-8e85-4230-b72d-1f6f2bd4dd31"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46017, 1134, 166, 3, 79, "Subtitle",ExpressionUUID->"4c070306-031b-4c9e-9114-39140cb053f0"],
Cell[46186, 1139, 9354, 224, 705, "Code",ExpressionUUID->"910d4a30-bea9-40f9-863d-43f900ab9c90"],
Cell[CellGroupData[{
Cell[55565, 1367, 3685, 85, 653, "Input",ExpressionUUID->"957fc8d6-558e-413a-993c-16f5e499ca01"],
Cell[59253, 1454, 216, 4, 36, "Print",ExpressionUUID->"4ad04be9-b75c-43bd-9394-d61f97fa09d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59506, 1463, 838, 24, 188, "Input",ExpressionUUID->"68ea8bbd-21b7-4abd-bc71-e91ea7e59fd0"],
Cell[60347, 1489, 386, 8, 345, "Output",ExpressionUUID->"eb37516b-f336-4b2b-a210-cdb704a92605"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60782, 1503, 218, 4, 79, "Subtitle",ExpressionUUID->"6a5b6613-1a9c-4128-9b00-feb6fc9f2f75"],
Cell[61003, 1509, 13877, 323, 995, "Code",ExpressionUUID->"9b4e0e9a-559a-487b-b191-6562d321185b"],
Cell[74883, 1834, 3357, 77, 591, "Input",ExpressionUUID->"02800625-b98f-4f5c-9a77-b4f3f83495f3"],
Cell[78243, 1913, 556, 14, 109, "Input",ExpressionUUID->"e5f7e767-74dd-4ddf-adcd-4c12b4cdc995"],
Cell[78802, 1929, 478, 10, 78, "Input",ExpressionUUID->"c250b494-246c-4872-95b0-68585eb35967"],
Cell[CellGroupData[{
Cell[79305, 1943, 459, 11, 63, "Input",ExpressionUUID->"a3fe906c-2b6c-42a6-888d-bc5629d634fc"],
Cell[79767, 1956, 316, 6, 36, "Print",ExpressionUUID->"aa2d5fc5-603a-438e-a10b-17746834e33f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80120, 1967, 838, 24, 188, "Input",ExpressionUUID->"9bc4270c-17b0-45aa-a0bb-e0f74f299a03"],
Cell[80961, 1993, 438, 9, 345, "Output",ExpressionUUID->"b756fc58-d0d8-4a99-9891-e405d8583888"],
Cell[81402, 2004, 232, 4, 69, "Output",ExpressionUUID->"9780aa54-64d9-4dfe-bdc8-56d486a8ed05"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[81683, 2014, 252, 6, 127, "Subtitle",ExpressionUUID->"664ba610-d11e-4afb-a0b8-f363cd8a41bf"],
Cell[81938, 2022, 18026, 417, 1343, "Code",ExpressionUUID->"d8564d13-6208-424e-bbf1-c79305bfb85d"],
Cell[CellGroupData[{
Cell[99989, 2443, 3435, 79, 622, "Input",ExpressionUUID->"05d041cf-b333-4e96-b904-38856bc44f69"],
Cell[103427, 2524, 192, 4, 36, "Print",ExpressionUUID->"049f13d1-7d6a-466a-991a-20483a3e093d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103656, 2533, 880, 25, 188, "Input",ExpressionUUID->"a7ebd154-5073-4de2-bbbb-7e545e775160"],
Cell[104539, 2560, 390, 8, 345, "Output",ExpressionUUID->"be9f31cd-4d5d-4f98-a906-4a97059cdaf9"]
}, Open  ]],
Cell[104944, 2571, 144, 2, 78, "Input",ExpressionUUID->"ff703a3c-0d9b-4844-99fa-51d976eb4b04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105125, 2578, 167, 3, 79, "Subtitle",ExpressionUUID->"fbcf7d49-d4ee-4bb0-98f3-441e450c012a"],
Cell[105295, 2583, 1794, 44, 250, "Input",ExpressionUUID->"51811813-3254-4885-8ac7-1b093bbce73c"],
Cell[107092, 2629, 2284, 52, 529, "Input",ExpressionUUID->"2135b270-ee9b-49a3-b08b-be70464771e5"],
Cell[109379, 2683, 821, 22, 171, "Input",ExpressionUUID->"b313ccf8-d844-4f49-92e4-299369f13b87"],
Cell[110203, 2707, 2295, 53, 529, "Input",ExpressionUUID->"6ea31c4b-d9e8-4903-a5be-655c098abec6"],
Cell[112501, 2762, 881, 22, 140, "Input",ExpressionUUID->"e683495b-05d5-4579-9ffd-2f255bd0a8fe"],
Cell[113385, 2786, 81, 0, 46, "Input",ExpressionUUID->"3cfa5706-921a-4087-9ff6-93e722c6e238"],
Cell[113469, 2788, 2326, 54, 512, "Input",ExpressionUUID->"1f7d109c-b783-4ce6-9c55-b9c863bee336"],
Cell[115798, 2844, 890, 23, 171, "Input",ExpressionUUID->"9ccb0171-ef15-4383-92a9-36044cfeb694"],
Cell[116691, 2869, 2313, 54, 529, "Input",ExpressionUUID->"08d24e51-83f0-4a36-b0bf-b198b96d2049"],
Cell[119007, 2925, 982, 24, 188, "Input",ExpressionUUID->"29080710-5fce-48a9-911d-3500c735d884"],
Cell[119992, 2951, 327, 9, 63, "Input",ExpressionUUID->"43e3b6f1-93d0-4af9-9881-e8b44aeebfdd"],
Cell[CellGroupData[{
Cell[120344, 2964, 313, 7, 63, "Input",ExpressionUUID->"8f8efea9-a618-4d33-9915-df5cbedb5be3"],
Cell[120660, 2973, 268, 7, 69, "Output",ExpressionUUID->"f7b5d57e-3543-4023-b08f-d0065da08004"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120965, 2985, 291, 6, 63, "Input",ExpressionUUID->"da2fe06b-468c-4fb3-ad4c-8beda48af712"],
Cell[121259, 2993, 303, 8, 69, "Output",ExpressionUUID->"cbe849b5-947f-480e-a5b2-5ad739196d9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121599, 3006, 229, 5, 63, "Input",ExpressionUUID->"400bdf3e-4f24-430e-accc-0733cf0f5132"],
Cell[121831, 3013, 274, 7, 69, "Output",ExpressionUUID->"a80a3fd5-eb4b-4e71-81e7-18305254c4da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122142, 3025, 232, 5, 63, "Input",ExpressionUUID->"5ea3f04c-c376-4317-87a4-5ba149b458cc"],
Cell[122377, 3032, 286, 7, 69, "Output",ExpressionUUID->"9608d0a5-488c-4659-ad43-b958c1012d60"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122700, 3044, 291, 6, 63, "Input",ExpressionUUID->"42f832f9-cffe-4a57-9d19-81b8f7497b3a"],
Cell[122994, 3052, 259, 7, 69, "Output",ExpressionUUID->"cb8b06b8-149e-42fd-a1ee-cda40774941b"]
}, Open  ]],
Cell[123268, 3062, 296, 6, 63, "Input",ExpressionUUID->"296d971e-9d02-4704-b194-528bbb6fd14d"],
Cell[123567, 3070, 329, 10, 13, "Text",ExpressionUUID->"7ff1534e-6571-4506-9f03-b7304819ce24"],
Cell[123899, 3082, 3753, 88, 698, "Input",ExpressionUUID->"98b9762d-306c-40ce-940a-5d89c7dd5301"],
Cell[127655, 3172, 2863, 72, 419, "Input",ExpressionUUID->"df7e04cc-e8c2-4e3c-bde1-73a35e2cd0a6"],
Cell[130521, 3246, 331, 10, 9, "Text",ExpressionUUID->"9297742d-c3fb-42c0-85a4-ca8f793f25f1"],
Cell[130855, 3258, 398, 9, 46, "Input",ExpressionUUID->"ef072a5f-b326-43d9-993d-4078ddcd62b0"],
Cell[131256, 3269, 363, 8, 78, "Input",ExpressionUUID->"7af814d5-0baf-44fc-990c-f2ff019efcb2"],
Cell[131622, 3279, 358, 8, 46, "Input",ExpressionUUID->"2579e2c0-baf0-426c-b3d8-72fe4c0c3c70"],
Cell[131983, 3289, 388, 8, 78, "Input",ExpressionUUID->"8913df6e-8629-4e41-8857-a2ce2ea809fe"],
Cell[132374, 3299, 376, 8, 78, "Input",ExpressionUUID->"0cb9e899-ff46-4e39-bb86-d514e59133eb"],
Cell[132753, 3309, 898, 22, 140, "Input",ExpressionUUID->"4ef13113-294d-46bc-be89-43f983e5aa9d"],
Cell[133654, 3333, 331, 10, 9, "Text",ExpressionUUID->"d0eec615-43a2-4b3a-bca9-bcfc34ae2740"],
Cell[133988, 3345, 395, 9, 78, "Input",ExpressionUUID->"221185c8-bf54-4241-997c-2365c2379201"],
Cell[134386, 3356, 431, 10, 78, "Input",ExpressionUUID->"70a79637-75b1-4013-bfd5-c0f72f89430f"],
Cell[134820, 3368, 426, 10, 78, "Input",ExpressionUUID->"e2eb6f1c-f7a8-41e5-afc6-dd363a20e5cd"],
Cell[135249, 3380, 456, 10, 78, "Input",ExpressionUUID->"b5903bf2-8e30-468e-938f-d832a8d15976"],
Cell[135708, 3392, 444, 10, 78, "Input",ExpressionUUID->"a9db3866-8279-43b3-8dde-484f2d5b9c0e"],
Cell[136155, 3404, 910, 22, 140, "Input",ExpressionUUID->"1daf1a53-ac16-493a-b4a0-528f57bd92a6"],
Cell[137068, 3428, 331, 10, 9, "Text",ExpressionUUID->"40c31039-0f29-441e-914b-19a01e6496f9"],
Cell[137402, 3440, 510, 12, 46, "Input",ExpressionUUID->"bff1dbb5-2f90-49e7-a61a-75234325917e"],
Cell[137915, 3454, 541, 12, 78, "Input",ExpressionUUID->"3b470396-08fe-423b-9bbc-2a1dd01c4e23"],
Cell[138459, 3468, 543, 13, 78, "Input",ExpressionUUID->"9860836c-2f20-45ea-bf20-fef461dea3b0"],
Cell[139005, 3483, 573, 13, 78, "Input",ExpressionUUID->"67c33f67-e423-4f79-afd7-1e7ab8ff5d63"],
Cell[139581, 3498, 563, 13, 78, "Input",ExpressionUUID->"98bb7781-0ed7-430a-bb49-fffe0e930e8f"],
Cell[140147, 3513, 898, 22, 140, "Input",ExpressionUUID->"761b541b-3ffc-4fcb-8838-0147771914c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141082, 3540, 168, 6, 127, "Subtitle",ExpressionUUID->"1558f0d1-ae38-476e-992c-5aa1972fb40c"],
Cell[141253, 3548, 7867, 200, 1118, "Input",ExpressionUUID->"91aa29e3-0c9b-4b13-a4b0-dc66349210d6"],
Cell[CellGroupData[{
Cell[149145, 3752, 422, 11, 63, "Input",ExpressionUUID->"203328cd-1fc5-4a0f-a8ed-115eacae4bfe"],
Cell[149570, 3765, 458, 12, 69, "Output",ExpressionUUID->"38cb819f-bc81-4243-b189-d1223bfccaf3"]
}, Open  ]],
Cell[150043, 3780, 343, 6, 53, "Text",ExpressionUUID->"005ddb10-38dd-4514-8696-37fee3e24a87"],
Cell[150389, 3788, 152, 3, 46, "Input",ExpressionUUID->"c69938e0-c9a9-42be-ac08-960eff40f774"]
}, Open  ]]
}, Open  ]]
}
]
*)

