(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     96685,       2361]
NotebookOptionsPosition[     91443,       2269]
NotebookOutlinePosition[     91862,       2286]
CellTagsIndexPosition[     91819,       2283]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Surface CRNs for k-coloring (2022)", "Title",
 CellChangeTimes->{{3.864837892488171*^9, 
  3.8648379113924026`*^9}},ExpressionUUID->"5377b741-064c-4bfd-9618-\
9c003df36aba"],

Cell["Generating random graphs", "Subtitle",
 CellChangeTimes->{{3.864838618475706*^9, 
  3.864838622108232*^9}},ExpressionUUID->"ad04706b-4c9c-4107-9bfd-\
b4b2ddcaa615"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s generate random planar maps using a percolation \
approach: N x M vertices, with probability ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "adef657a-d571-47cf-82f5-be031c5463e1"],
 " for connecting a region to a von Neumann  neighbor via a \
\[OpenCurlyDoubleQuote]land bridge\[CloseCurlyDoubleQuote] to make them the \
same map region, and otherwise a probability ",
 Cell[BoxData[
  FormBox["q", TraditionalForm]],ExpressionUUID->
  "c67caf6b-ae51-405d-b40f-7599b5633fc0"],
 " for creating an \[OpenCurlyDoubleQuote]edge\[CloseCurlyDoubleQuote] to the \
neighbor (unless it ends up being the same region as connected by land \
bridges) .  So between two lattice sites, probability ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "c38b442e-1096-4844-9de6-88e2dca6533c"],
 " is a land bridge, probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], "q"}], TraditionalForm]],ExpressionUUID->
  "82a2f414-1b37-4d41-95aa-941cb85ac28c"],
 " is an edge, and probability ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "p"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "q"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "8dea6be0-029b-48bf-b8fd-9607d65fd905"],
 " is empty. The size of single-color regions now depends on the percolation \
parameter p.   For large enough ",
 Cell[BoxData[
  FormBox["p", TraditionalForm]],ExpressionUUID->
  "78791b77-eaf7-48fc-8be7-fa559ab72d8e"],
 ", these regions may bend around on themselves, and allowing a formal edge \
to be made between a region and another part of itself -- thus making the \
entire graph not colorable.   This being far too common, our code below goes \
to some lengths to identify and remove such edges.   While we\
\[CloseCurlyQuote]re at it, we construct a formal graph corresponding to the \
layout, so that we can use SatisfiableQ / MiniSAT to test colorability before \
asking our surface CRN to try it.\n\nIt would be a lot easier to just use a \
regular square grid or regular hexagonal grid, with a random subset of edges \
-- but any subset of a square grid is 2-colorable, and any subset of a hex \
grid is 3-colorable.  Granted, any subset of a planar graph is 4-colorable, \
yet it\[CloseCurlyQuote]s still interesting (and hard) to actually find a \
coloring.   Still, the land bridges in the random maps result in regions that \
permit arbitrary graphs, hence the NP-completeness of planar 3-colorability \
(cf Garey & Johnson, 1979) means we\[CloseCurlyQuote]re in the zone for \
genuinely hard decisions problems.  "
}], "Text",
 CellChangeTimes->{3.8648387957642603`*^9},
 Background->RGBColor[
  0.9, 1, 1],ExpressionUUID->"c79309bd-00ee-40c4-a32b-60a42fc3526b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ColoringSAT", "[", 
    RowBox[{"G_", ",", "k_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"v", "=", 
        RowBox[{"VertexList", "[", "G", "]"}]}], ",", 
       RowBox[{"e", "=", 
        RowBox[{"EdgeList", "[", "G", "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"And", "@@", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"V", "[", 
              RowBox[{
               RowBox[{"edge", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "c"}], "]"}]}], "||", 
            RowBox[{"!", 
             RowBox[{"V", "[", 
              RowBox[{
               RowBox[{"edge", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "c"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"c", ",", 
             RowBox[{"Range", "[", "k", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"edge", ",", "e"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Or", "@@", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"V", "[", 
               RowBox[{"i", ",", "c"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"c", ",", 
                RowBox[{"Range", "[", "k", "]"}]}], "}"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "v"}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", 
             RowBox[{"V", "[", 
              RowBox[{"i", ",", "c1"}], "]"}]}], "||", 
            RowBox[{"!", 
             RowBox[{"V", "[", 
              RowBox[{"i", ",", "c2"}], "]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"c1", ",", "1", ",", 
             RowBox[{"k", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"c2", ",", 
             RowBox[{"c1", "+", "1"}], ",", "k"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "v"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "\t", "]"}], "]"}]}]}], "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomSquareColoringMap", "[", 
    RowBox[{"N_", ",", "M_", ",", "p_", ",", "q_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "map", ",", "ID", ",", "IDE", ",", "badE", ",", "goodE", ",", "graph"}],
       "}"}], ",", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"map", "=", 
       RowBox[{"ArrayPad", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"ArrayFlatten", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"mid", ",", "ver"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"hor", ",", "cor"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", "N", "}"}], ",", 
               RowBox[{"{", "M", "}"}]}], "]"}], "/.", 
             RowBox[{"{", "\[IndentingNewLine]", "\t\t", 
              RowBox[{
               RowBox[{"mid", "\[Rule]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"v", "[", "1", "]"}], ",", "3", ",", "3"}], "]"}]}],
                ",", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"ver", "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RandomReal", "[", "]"}], "<", "p"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], ",", "3", ",", "2"}], "]"}],
                   ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", "q"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"w", ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"e", "[", "1", "]"}], ",", 
                    RowBox[{"e", "[", "1", "]"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", "w"}], "}"}]}], "}"}], ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"w", ",", "3", ",", "2"}], "]"}]}], "]"}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"hor", "\[RuleDelayed]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RandomReal", "[", "]"}], "<", "p"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"v", "[", "1", "]"}], ",", "2", ",", "3"}], "]"}],
                   ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", "q"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"w", ",", 
                    RowBox[{"e", "[", "1", "]"}], ",", "w"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"w", ",", 
                    RowBox[{"e", "[", "1", "]"}], ",", "w"}], "}"}]}], "}"}], 
                    ",", 
                    RowBox[{"Table", "[", 
                    RowBox[{"w", ",", "2", ",", "3"}], "]"}]}], "]"}]}], 
                 "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
               RowBox[{"cor", "\[Rule]", 
                RowBox[{"Table", "[", 
                 RowBox[{"w", ",", "2", ",", "2"}], "]"}]}]}], 
              "\[IndentingNewLine]", "\t\t", "}"}]}], "\[IndentingNewLine]", 
            "\t", "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", 
             RowBox[{"-", "3"}]}], ",", 
            RowBox[{"1", ";;", 
             RowBox[{"-", "3"}]}]}], "]"}], "]"}], ",", "1", ",", "w"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "this", " ", "map", " ", "might", " ", "have", " ", "large", " ", 
         "regions", " ", "that", " ", "curve", " ", "around", " ", "back", 
         " ", "on", " ", "themselves", " ", "and", " ", "then", " ", "have", 
         " ", "edges", " ", "to", " ", "themselves"}], ",", " ", 
        RowBox[{"making", " ", "them", " ", 
         RowBox[{"uncolorable", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]",
       "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"the", " ", "larger", " ", "the", " ", "map"}], ",", " ", 
        RowBox[{
        "the", " ", "more", " ", "likely", " ", "this", " ", "will", " ", 
         RowBox[{"occur", ".", "  ", "annoying"}]}], ",", " ", 
        RowBox[{
         RowBox[{"so", " ", 
          RowBox[{"let", "'"}], "s", " ", "just", " ", "eliminate", " ", 
          "these", " ", "self"}], "-", 
         RowBox[{"edges", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "we", " ", "give", " ", "each", " ", "region", " ", "a", " ", 
         "unique", " ", "ID"}], ",", " ", 
        RowBox[{
        "then", " ", "test", " ", "each", " ", "edge", " ", "for", " ", "IDs",
          " ", "being", " ", 
         RowBox[{"different", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"ID", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"ArrayReshape", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"i", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Times", "@@", 
                RowBox[{"Dimensions", "[", "map", "]"}]}]}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"Dimensions", "[", "map", "]"}]}], "]"}], " ", "*", " ", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", "===", 
               RowBox[{"v", "[", "1", "]"}]}], ",", "1", ",", "0"}], "]"}], 
            "&"}], ",", "map", ",", 
           RowBox[{"{", "2", "}"}]}], "]"}]}], "/.", 
        RowBox[{"{", 
         RowBox[{"0", "\[Rule]", "Infinity"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"ID", "=", 
       RowBox[{"FixedPoint", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#1", "<", "Infinity"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4", ",", "#5"}], 
                "]"}], ",", "Infinity"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"RotateLeft", "/@", "#"}], ",", 
              RowBox[{"RotateRight", "/@", "#"}], ",", 
              RowBox[{"RotateLeft", "[", "#", "]"}], ",", 
              RowBox[{"RotateRight", "[", "#", "]"}]}], "}"}], ",", "2"}], 
           "]"}], "&"}], ",", "ID"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{"(*", " ", 
       RowBox[{"only", " ", "care", " ", "for", " ", "edge", " ", 
        RowBox[{"sites", ":", " ", 
         RowBox[{
          RowBox[{"what", "'"}], "s", " ", "neighbor", " ", 
          RowBox[{"ID", "?"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"IDE", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "===", 
             RowBox[{"e", "[", "1", "]"}]}], ",", 
            RowBox[{"Min", "[", 
             RowBox[{"#2", ",", "#3", ",", "#4", ",", "#5"}], "]"}], ",", 
            "Infinity"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"map", ",", 
           RowBox[{"RotateLeft", "/@", "ID"}], ",", 
           RowBox[{"RotateRight", "/@", "ID"}], ",", 
           RowBox[{"RotateLeft", "[", "ID", "]"}], ",", 
           RowBox[{"RotateRight", "[", "ID", "]"}]}], "}"}], ",", "2"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
       "a", " ", "bad", " ", "edge", " ", "is", " ", "if", " ", "you", " ", 
        "have", " ", "an", " ", "e", " ", "neighbor", " ", "but", " ", "its", 
        " ", "ID", " ", "is", " ", "the", " ", "same"}], " ", "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"badE", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"#1", "===", 
             RowBox[{"e", "[", "1", "]"}]}], " ", "&&", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"#3", ",", "#4", ",", "#5", ",", "#6"}], "]"}], "<", 
             "Infinity"}], "&&", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{"#3", ",", "#4", ",", "#5", ",", "#6"}], "]"}], "===", 
             "#2"}]}], ")"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"map", ",", "IDE", ",", 
           RowBox[{"RotateLeft", "/@", "IDE"}], ",", 
           RowBox[{"RotateRight", "/@", "IDE"}], ",", 
           RowBox[{"RotateLeft", "[", "IDE", "]"}], ",", 
           RowBox[{"RotateRight", "[", "IDE", "]"}]}], "}"}], ",", "2"}], 
        "]"}]}], ";", " ", "\[IndentingNewLine]", "\t", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"ID", "//", "MatrixForm"}], ",", "\"\<\\n\>\"", ",", 
          RowBox[{"IDE", "//", "MatrixForm"}], ",", "\"\<\\n\>\"", ",", 
          RowBox[{
           RowBox[{"Boole", "[", "badE", "]"}], "//", "MatrixForm"}]}], "]"}],
         ";"}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
      RowBox[{"map", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{"#2", ",", "w", ",", "#1"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"map", ",", "badE"}], "}"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"goodE", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "===", 
             RowBox[{"e", "[", "1", "]"}]}], ",", " ", 
            RowBox[{"UndirectedEdge", "@@", 
             RowBox[{"Sort", "[", 
              RowBox[{"{", 
               RowBox[{"#2", ",", 
                RowBox[{"Min", "[", 
                 RowBox[{"#3", ",", "#4", ",", "#5", ",", "#6"}], "]"}]}], 
               "}"}], "]"}]}], ",", 
            RowBox[{"{", "}"}]}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{"map", ",", "IDE", ",", 
           RowBox[{"RotateLeft", "/@", "IDE"}], ",", 
           RowBox[{"RotateRight", "/@", "IDE"}], ",", 
           RowBox[{"RotateLeft", "[", "IDE", "]"}], ",", 
           RowBox[{"RotateRight", "[", "IDE", "]"}]}], "}"}], ",", "2"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"graph", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "ID", "]"}], "]"}], ",", 
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", "goodE", "]"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"{", 
       RowBox[{"map", ",", "graph"}], "}"}]}]}], "\[IndentingNewLine]", "\t", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.864838684320099*^9, 3.864838764777924*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"db77a4dc-5fc7-4648-82df-4d4595ec3b3a"],

Cell[CellGroupData[{

Cell["\<\

Surface Map Coloring: an intuitive first approach\
\>", "Subtitle",
 CellChangeTimes->{{3.8648436865554256`*^9, 
  3.864843716492249*^9}},ExpressionUUID->"3536790e-3449-453b-87c1-\
c2d094ee4d28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceMapColoringCRN", "[", "k_", "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "0.01"}], "]"}]}], "    ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
              " ", "different"}], ";", " ", 
             RowBox[{"if", " ", "not"}]}], ",", " ", 
            RowBox[{"one", " ", "randomly", " ", "changes"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "}"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MapColoringRules", "[", "k_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"colors", "=", 
      RowBox[{"{", 
       RowBox[{"Red", ",", "Green", ",", 
        RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", "\[Rule]", "White"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{
  3.864843702277635*^9},ExpressionUUID->"1c1aa549-3870-48ca-8bd8-\
77c482da4641"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PrepareColoringLayout", "[", "option_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
         RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
         RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
         RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
         RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"map", ",", "graph"}], "}"}], "=", 
          RowBox[{"RandomSquareColoringMap", "[", 
           RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
         RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SatisfiableQ", "[", 
          RowBox[{"ColoringSAT", "[", 
           RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
         "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"solidmap", "=", "map"}], ";", "\[IndentingNewLine]", 
      RowBox[{"solidCRN", "=", 
       RowBox[{"SurfaceMapColoringCRN", "[", "k", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solidcolors", "=", 
       RowBox[{"MapColoringRules", "[", "k", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"solidtime", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"csolidCRN", ",", " ", "csolidmap"}], "}"}], "=", 
       RowBox[{"CompileSurfaceCRN", "[", 
        RowBox[{"solidCRN", ",", "solidmap"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"csolidevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"PrepareColoringLayout", "[", "2", "]"}]}], "Input",
 CellChangeTimes->{
  3.8648442014268303`*^9, {3.8648453088405457`*^9, 3.864845313192916*^9}, {
   3.8648455317219763`*^9, 3.864845539060069*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"42d6d275-9d5b-41b8-a2df-ed14cf6989e4"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{3.8648442195456*^9, 3.864845320493079*^9, 
  3.8648455408110237`*^9},
 CellLabel->
  "During evaluation of \
In[318]:=",ExpressionUUID->"13ecba7e-0bc6-4787-b85b-8e057f9042c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Dynamic", "[", 
    RowBox[{"ShowSurfaceCRNState", "[", 
     RowBox[{"csolidmap", ",", "solidcolors", ",", 
      RowBox[{"PlotLabel", "\[Rule]", "solidtime"}]}], "]"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"!", "halted"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
          "csolidmap"}], "}"}], "=", 
        RowBox[{"InfoRunSurfaceCRN", "[", 
         RowBox[{"csolidCRN", ",", "csolidmap", ",", "1"}], "]"}]}], ";", 
       RowBox[{"solidtime", "+=", "dt"}], ";", 
       RowBox[{"csolidevents", "+=", "devents"}]}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.864838883236459*^9, 3.864838883256586*^9}, 
   3.8648389284924507`*^9, {3.864838964757721*^9, 3.864838989535461*^9}, {
   3.86483902152812*^9, 3.864839044331067*^9}, {3.86484250156015*^9, 
   3.864842503240693*^9}, {3.864842638880292*^9, 3.864842640384644*^9}, {
   3.864842678867921*^9, 3.8648427832923393`*^9}, {3.864842910925869*^9, 
   3.86484299354056*^9}, 3.8648431116920357`*^9, {3.8648431992662086`*^9, 
   3.864843214718504*^9}, {3.864843290327044*^9, 3.8648434023522778`*^9}, {
   3.864843451734273*^9, 3.864843453801602*^9}, {3.8648435057892437`*^9, 
   3.864843531398703*^9}, {3.864843590572846*^9, 3.8648435936197767`*^9}, {
   3.864843631296777*^9, 3.8648436324687843`*^9}, {3.8648442106105824`*^9, 
   3.864844214670589*^9}, {3.864845122459076*^9, 3.864845122761161*^9}, {
   3.8648453057236547`*^9, 3.864845307238386*^9}, 3.864845542420031*^9},
 CellLabel->
  "In[320]:=",ExpressionUUID->"752db4b5-bdde-454e-a617-7d5718c7bbb5"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`csolidmap, \
$CellContext`solidcolors, PlotLabel -> $CellContext`solidtime], StandardForm],
  
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{{3.864838967344555*^9, 3.86483899011576*^9}, {
   3.864839022102961*^9, 3.8648390596563272`*^9}, {3.864842479858189*^9, 
   3.864842504124585*^9}, 3.8648425451298437`*^9, 3.864842640819581*^9, 
   3.864842676739584*^9, {3.8648427705850058`*^9, 3.864842788325795*^9}, 
   3.8648428897751827`*^9, {3.864842995207428*^9, 3.8648429988159237`*^9}, {
   3.864843104897334*^9, 3.864843136177992*^9}, 3.86484331255869*^9, 
   3.86484341014914*^9, 3.8648434542929773`*^9, {3.8648435076336803`*^9, 
   3.864843531861115*^9}, 3.864843594090074*^9, 3.8648442217981462`*^9, 
   3.864845322476862*^9, 3.864845545911146*^9},
 CellLabel->
  "Out[320]=",ExpressionUUID->"8e3d9c82-4a13-4bf1-9327-ce8c7b873356"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Walk Coloring Surface CRN", "Subtitle",
 CellChangeTimes->{{3.864843887213017*^9, 3.864843894521365*^9}, {
  3.864844286154813*^9, 
  3.864844287816494*^9}},ExpressionUUID->"0800482e-d0a4-4d57-a50d-\
7fa316592fd7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceWalkColoringCRN", "[", 
   RowBox[{"k_", ",", "slow_", ",", "fast_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", " ", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "chooses", " ", "to", " ", 
              "recolor"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", 
             RowBox[{"slow", "/", "100"}]}], "]"}], ",", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
               " ", "different"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "tries", " ", "to", " ", 
              "change"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"tryv", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"edges", " ", "initiate", " ", "trials"}], ",", " ", 
             RowBox[{
             "which", " ", "propagate", " ", "to", " ", "the", " ", 
              "region"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"tryv", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"tryv", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "trial", " ", "colors", " ", "propagate", " ", "to", " ", "other",
              " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"tryv", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"tryv", "[", "c2", "]"}], "+", 
              RowBox[{"tryv", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "new", " ", "trial", " ", "colors", " ", "propagate", " ", 
             "throughout", " ", "the", " ", "region"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"tryv", "[", "c2", "]"}], ",", 
             RowBox[{"v", "[", "c2", "]"}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{"slowly", " ", "solidify", " ", "trials"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"trye", "[", "c2", "]"}], ",", 
             RowBox[{"e", "[", "c2", "]"}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{"slowly", " ", "solidify", " ", "trials"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"tryv", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "if", " ", "a", " ", "trial", " ", "color", " ", "solidifies", 
              " ", "anywhere"}], ",", " ", 
             RowBox[{"the", " ", "solidification", " ", "propagates"}]}], " ",
             "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "solidification", " ", "propagates", " ", "to", " ", "edges"}], 
            " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c2", "]"}], "+", 
              RowBox[{"trye", "[", "c1", "]"}]}], ",", "1"}], "]"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
           "how", " ", "does", " ", "a", " ", "trial", " ", "color", " ", 
            "change", " ", "get", " ", 
            RowBox[{"rejected", "?", " ", "choose"}], " ", "something", " ", 
            "else", " ", "to", " ", "try"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t\t", "}"}], ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "\t", "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WalkColoringRules", "[", "k_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"colors", "=", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Green", ",", 
         RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], ",", 
      
      RowBox[{"trycolors", "=", 
       RowBox[{"{", 
        RowBox[{
        "LightPink", ",", "LightGreen", ",", "LightMagenta", ",", 
         "LightBrown"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", "\[Rule]", "White"}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"tryv", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"trycolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"trye", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"trycolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{
  3.864843913209446*^9, {3.864843993379266*^9, 3.864844057180807*^9}, {
   3.864846852402871*^9, 3.864846860440462*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"9a61a7b5-e66a-4633-a3f3-d323a83b67d5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PrepareWalkColoringLayout", "[", "option_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
        RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
        RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
        "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfaceCRN", "=", 
      RowBox[{"SurfaceWalkColoringCRN", "[", 
       RowBox[{"k", ",", ".1", ",", "10"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurface", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"WalkColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cfsurfaceCRN", ",", " ", "cfsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRN", ",", "fsurface"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PrepareWalkColoringLayout", "[", "3", "]"}]}], "Input",
 CellChangeTimes->{{3.864844077419813*^9, 3.864844114882512*^9}, {
  3.864844159423915*^9, 3.864844173536518*^9}, {3.864844990561261*^9, 
  3.8648449912402897`*^9}, {3.864845068687512*^9, 3.8648451330248623`*^9}, {
  3.864845488408297*^9, 3.864845488584532*^9}, {3.8648466601507998`*^9, 
  3.864846687456513*^9}, {3.864846871383596*^9, 3.864846873998177*^9}},
 CellLabel->
  "In[383]:=",ExpressionUUID->"7f167c9f-c058-45ff-9504-2299899c358f"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{
  3.864844080235529*^9, 3.864845002816639*^9, 3.864845148185564*^9, 
   3.864845232100813*^9, {3.864845469804088*^9, 3.8648454907746*^9}, 
   3.864845887394075*^9, 3.864846524203752*^9, 3.8648466897541847`*^9, {
   3.864846865321116*^9, 3.864846903457736*^9}},
 CellLabel->
  "During evaluation of \
In[383]:=",ExpressionUUID->"3261627a-0771-4620-b6f1-5cf681c3a169"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"ShowSurfaceCRNState", "[", 
    RowBox[{"cfsurface", ",", "fsurfacecoloring", ",", 
     RowBox[{"PlotLabel", "\[Rule]", "fsurfacetime"}]}], "]"}], "]"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", "halted"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
        "cfsurface"}], "}"}], "=", 
      RowBox[{"InfoRunSurfaceCRN", "[", 
       RowBox[{"cfsurfaceCRN", ",", "cfsurface", ",", "1"}], "]"}]}], ";", 
     RowBox[{"fsurfacetime", "+=", "dt"}], ";", 
     RowBox[{"csurfaceevents", "+=", "devents"}]}]}], "]"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.864845004820507*^9, 3.86484500484135*^9}, {
   3.864845151125202*^9, 3.864845201589918*^9}, {3.864846014989496*^9, 
   3.864846018576722*^9}, {3.864846698271241*^9, 3.8648467142095957`*^9}, 
   3.8648468894215183`*^9},
 CellLabel->
  "In[385]:=",ExpressionUUID->"78180cd0-fb4f-4019-a5f1-e43d4b44126f"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`cfsurface, \
$CellContext`fsurfacecoloring, PlotLabel -> $CellContext`fsurfacetime], 
   StandardForm],
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{{3.86484520216081*^9, 3.864845235402631*^9}, 
   3.86484530023435*^9, {3.864845475944107*^9, 3.864845492487533*^9}, 
   3.864845883012908*^9, {3.864846009398426*^9, 3.864846019059319*^9}, {
   3.864846691279255*^9, 3.864846714495162*^9}, 3.864846821812389*^9, {
   3.8648468672528563`*^9, 3.864846920323923*^9}},
 CellLabel->
  "Out[385]=",ExpressionUUID->"bae51b4a-8e85-4230-b72d-1f6f2bd4dd31"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Surface Wave CRN", "Subtitle",
 CellChangeTimes->{{3.8648469714069757`*^9, 
  3.8648469764554653`*^9}},ExpressionUUID->"4c070306-031b-4c9e-9114-\
39140cb053f0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceWaveColoringCRN", "[", 
   RowBox[{"k_", ",", "slow_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", " ", "\[IndentingNewLine]", "\t\t\t", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "chooses", " ", "to", " ", 
              "recolor", " ", "but", " ", 
              RowBox[{"doesn", "'"}], "t", " ", "freeze"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"V", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"V", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"recolored", "/", "frozen"}], " ", "nodes", " ", "pass",
               " ", "their", " ", "new", " ", "color", " ", "to", " ", 
              "their", " ", "neighbors"}], ",", " ", 
             RowBox[{"and", " ", "freeze", " ", "them"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           
           RowBox[{"(*", " ", 
            RowBox[{
            "recolored", " ", "edges", " ", "propagate", " ", "their", " ", 
             "change", " ", "and", " ", "freeze", " ", "vertex", " ", 
             "sites"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"E", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "recolored", " ", "vertex", " ", "sites", " ", "pass", " ", 
             "their", " ", "color", " ", "to", " ", "outgoing", " ", "edges", 
             " ", "NOTE", " ", "EDITED", " ", "FROM", " ", "WINFREE", " ", 
             "CODE", " ", "TO", " ", 
             RowBox[{"E", "[", "c1", "]"}]}], "*)"}], "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", 
             RowBox[{"slow", "/", "100"}]}], "]"}], ",", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
               " ", "different"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"one", " ", "randomly", " ", "changes"}], " ", "&"}], 
              " ", "freezes"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "[", "c2", "]"}], ",", 
             RowBox[{"v", "[", "c2", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"slowly", " ", "melt", " ", "frozen", " ", "nodes"}], 
             ",", " ", 
             RowBox[{
             "allowing", " ", "them", " ", "to", " ", "change", " ", 
              "again"}]}], "  ", "*)"}], "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "[", "c2", "]"}], ",", 
             RowBox[{"e", "[", "c2", "]"}], ",", "slow"}], "]"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"slowly", " ", "melt", " ", "frozen", " ", "nodes"}], ",",
             " ", 
            RowBox[{
            "allowing", " ", "them", " ", "to", " ", "change", " ", 
             "again"}]}], "  ", "*)"}], "\[IndentingNewLine]", "\t\t", "}"}], 
         ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "\t", "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WaveColoringRules", "[", "k_", "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"colors", "=", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Green", ",", 
         RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], ",", 
      
      RowBox[{"freezecolors", "=", 
       RowBox[{"{", 
        RowBox[{
        "LightPink", ",", "LightGreen", ",", "LightMagenta", ",", 
         "LightBrown"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", "\[Rule]", "White"}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"freezecolors", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"E\[Null]", "[", "i", "]"}], "->", 
            RowBox[{"Darker", "[", 
             RowBox[{"freezecolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t\t", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.864868013516211*^9, 3.864868102319459*^9}, {
  3.864868332261446*^9, 3.864868349999477*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"910d4a30-bea9-40f9-863d-43f900ab9c90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PrepareWaveColoringLayout", "[", 
   RowBox[{"option_", ",", "slow_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
        RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
        RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
        "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfaceCRN", "=", 
      RowBox[{"SurfaceWaveColoringCRN", "[", 
       RowBox[{"k", ",", "slow"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurface", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"WalkColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cfsurfaceCRN", ",", " ", "cfsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRN", ",", "fsurface"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrepareWaveColoringLayout", "[", 
   RowBox[{"2", ",", "0.5"}], "]"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"mysteriously", ",", " ", 
    RowBox[{
    "optimal", " ", "performance", " ", "comes", " ", "from", " ", "slow", 
     " ", "between", " ", "0.5", " ", "and", " ", "1"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.864868153533854*^9, 3.864868223099801*^9}, {
  3.8648682879616947`*^9, 3.8648682902669907`*^9}},
 CellLabel->
  "In[395]:=",ExpressionUUID->"957fc8d6-558e-413a-993c-16f5e499ca01"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{3.8648682930290127`*^9, 3.864868355840057*^9},
 CellLabel->
  "During evaluation of \
In[395]:=",ExpressionUUID->"4ad04be9-b75c-43bd-9394-d61f97fa09d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"ShowSurfaceCRNState", "[", 
    RowBox[{"cfsurface", ",", "fsurfacecoloring", ",", 
     RowBox[{"PlotLabel", "\[Rule]", "fsurfacetime"}]}], "]"}], "]"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", "halted"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
        "cfsurface"}], "}"}], "=", 
      RowBox[{"InfoRunSurfaceCRN", "[", 
       RowBox[{"cfsurfaceCRN", ",", "cfsurface", ",", "1"}], "]"}]}], ";", 
     RowBox[{"fsurfacetime", "+=", "dt"}], ";", 
     RowBox[{"csurfaceevents", "+=", "devents"}]}]}], "]"}], ";"}]}], "Input",\

 CellLabel->
  "In[397]:=",ExpressionUUID->"68ea8bbd-21b7-4abd-bc71-e91ea7e59fd0"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`cfsurface, \
$CellContext`fsurfacecoloring, PlotLabel -> $CellContext`fsurfacetime], 
   StandardForm],
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{3.864868299547153*^9, 3.864868371115086*^9},
 CellLabel->
  "Out[397]=",ExpressionUUID->"eb37516b-f336-4b2b-a210-cdb704a92605"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Surface Reject Wave CRN", "Subtitle",
 CellChangeTimes->{{3.864868498209792*^9, 3.864868508976306*^9}, {
  3.864869327695691*^9, 
  3.864869328042144*^9}},ExpressionUUID->"6a5b6613-1a9c-4128-9b00-\
feb6fc9f2f75"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
   RowBox[{"k_", ",", "slow_", ",", "fast_"}], "]"}], ":=", 
  RowBox[{"Union", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", "\[IndentingNewLine]", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"{", " ", "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "chooses", " ", "to", " ", 
              "recolor", " ", "but", " ", 
              RowBox[{"doesn", "'"}], "t", " ", "freeze"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "slow"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", 
             RowBox[{"slow", "/", "100"}]}], "]"}], ",", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
               " ", "different"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"one", " ", "randomly", " ", "changes"}], " ", "&"}], 
              " ", "freezes"}]}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"V", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"V", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"recolored", "/", "frozen"}], " ", "nodes", " ", "pass",
               " ", "their", " ", "new", " ", "color", " ", "to", " ", 
              "their", " ", "neighbors"}], ",", " ", 
             RowBox[{"and", " ", "freeze", " ", "them"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           
           RowBox[{"(*", " ", 
            RowBox[{
            "recolored", " ", "edges", " ", "propagate", " ", "their", " ", 
             "change", " ", "and", " ", "freeze", " ", "vertex", " ", 
             "sites"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", 
           " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "recolored", " ", "vertex", " ", "sites", " ", "pass", " ", 
              "their", " ", "color", " ", "to", " ", "outgoing", " ", 
              "edges"}], ",", " ", 
             RowBox[{
             "which", " ", "will", " ", "initially", " ", "be", " ", 
              "frozen"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", "E\[Null]"}], ",", "fast"}],
             "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "if", " ", "a", " ", "recoloring", " ", "clashes", " ", "with", 
              " ", "a", " ", "neighbor"}], ",", " ", 
             RowBox[{
             "initiate", " ", "a", " ", "fast", " ", "reversion", " ", "to", 
              " ", "restore", " ", "the", " ", "original", " ", "colors"}]}], 
            " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{"E\[Null]", "+", "V"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "edge", " ", "propagates", " ", 
             "rejeection", " ", "to", " ", "neighboring", " ", "vertex", " ", 
             "sites"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "+", 
              RowBox[{"V", "[", "c1", "]"}]}], ",", 
             RowBox[{"V", "+", "V"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "vertex", " ", "site", " ", 
             "propagates", " ", "rejection", " ", "to", " ", "neighboring", 
             " ", "vertex", " ", "sites"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "+", 
              RowBox[{"E\[Null]", "[", "c1", "]"}]}], ",", 
             RowBox[{"V", "+", "E\[Null]"}], ",", "fast"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "vertex", " ", "site", " ", 
             "propagates", " ", "rejection", " ", "to", " ", "neighboring", 
             " ", "edge"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", "V"}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "vertex", " ", "site", " ", "adopts", 
             " ", "color", " ", "of", " ", "any", " ", "remaining", " ", 
             "unchanged", " ", "site", " ", "or", " ", "restored", " ", 
             "site"}], " ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", "E\[Null]"}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "fast"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
            "a", " ", "rejected", " ", "edge", " ", "adopts", " ", "color", 
             " ", "of", " ", "any", " ", "remaining", " ", "unchanged", " ", 
             "site", " ", "or", " ", "restored", " ", "site"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{"E\[Null]", ",", 
             RowBox[{"e", "[", "c1", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", "things", " ", "got", " ", "stuck"}], ",", 
             " ", 
             RowBox[{"color", " ", "somehow"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{"V", ",", 
             RowBox[{"v", "[", "c1", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"if", " ", "things", " ", "got", " ", "stuck"}], ",", 
             " ", 
             RowBox[{"color", " ", "somehow"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"V", "[", "c2", "]"}], ",", 
             RowBox[{"v", "[", "c2", "]"}], ",", "slow"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"slowly", " ", "melt", " ", "frozen", " ", "nodes"}], 
             ",", " ", 
             RowBox[{
             "allowing", " ", "them", " ", "to", " ", "change", " ", 
              "again"}]}], "  ", "*)"}], "\[IndentingNewLine]", "\t\t", 
           RowBox[{"rxno", "[", 
            RowBox[{
             RowBox[{"E\[Null]", "[", "c2", "]"}], ",", 
             RowBox[{"e", "[", "c2", "]"}], ",", "slow"}], "]"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"slowly", " ", "melt", " ", "frozen", " ", "nodes"}], ",",
             " ", 
            RowBox[{
            "allowing", " ", "them", " ", "to", " ", "change", " ", 
             "again"}]}], "  ", "*)"}], "\[IndentingNewLine]", "\t\t", "}"}], 
         ",", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}], 
     "\[IndentingNewLine]", "\t", "}"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RejectWaveColoringRules", "[", "k_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"colors", "=", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Green", ",", 
         RowBox[{"Lighter", "[", "Blue", "]"}], ",", "Black"}], "}"}]}], ",", 
      
      RowBox[{"freezecolors", "=", 
       RowBox[{"{", 
        RowBox[{
        "LightPink", ",", "LightGreen", ",", "LightMagenta", ",", 
         "LightBrown"}], "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w", "\[Rule]", "White"}], ",", 
         RowBox[{"E\[Null]", "->", "Yellow"}], ",", 
         RowBox[{"V", "->", "Yellow"}]}], "}"}], ",", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"freezecolors", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"E\[Null]", "[", "i", "]"}], "->", 
            RowBox[{"Darker", "[", 
             RowBox[{"freezecolors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\t", "]"}], "]"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.864869345962461*^9, 3.864869425537858*^9}, {
  3.864869648869812*^9, 3.86486966377658*^9}},
 CellLabel->
  "In[408]:=",ExpressionUUID->"9b4e0e9a-559a-487b-b191-6562d321185b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareRejectWaveColoringLayout", "[", 
   RowBox[{"option_", ",", "slow_", ",", "fast_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "k"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{"option", ",", "\[IndentingNewLine]", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0", ",", "1"}], "]"}]}], ";", 
        RowBox[{"k", "=", "2"}]}], ",", "\[IndentingNewLine]", "1", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.1", ",", ".7"}], "]"}]}], ";", 
        RowBox[{"k", "=", "4"}]}], ",", "\[IndentingNewLine]", "2", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "40", ",", "0.2", ",", ".5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "3", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"20", ",", "20", ",", "0.35", ",", ".25"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}], ",", "\[IndentingNewLine]", "4", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"10", ",", "10", ",", "0.5", ",", "0.5"}], "]"}]}], ";", 
        RowBox[{"k", "=", "3"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"SatisfiableQ", "[", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}], "]"}], ",", 
        "\"\<Colorable!\>\"", ",", "\"\<Not colorable!\>\""}], "]"}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfaceCRN", "=", 
      RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
       RowBox[{"k", ",", "slow", ",", "fast"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurface", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"RejectWaveColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cfsurfaceCRN", ",", " ", "cfsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRN", ",", "fsurface"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8648695019413767`*^9, 3.86486951885288*^9}, {
  3.864869580553462*^9, 3.86486958275313*^9}},
 CellLabel->
  "In[416]:=",ExpressionUUID->"02800625-b98f-4f5c-9a77-b4f3f83495f3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareRejectWaveColoringLayout", "[", 
   RowBox[{"2", ",", "10", ",", "0.1"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "making", " ", "slow", " ", "fast", " ", "and", " ", "fast", " ", "slow", 
     " ", "seems", " ", "to", " ", "work", " ", "best"}], ",", " ", "again", 
    ",", " ", 
    RowBox[{"but", " ", 
     RowBox[{"why", "?"}]}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.864869602860602*^9, 
  3.8648696061369333`*^9}},ExpressionUUID->"e5f7e767-74dd-4ddf-adcd-\
4c12b4cdc995"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareRejectWaveColoringLayout", "[", 
   RowBox[{"2", ",", "0.1", ",", "10"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "slow", " ", "being", " ", "slow", " ", "and", " ", "fast", " ", "being", 
    " ", "fast", " ", "seems", " ", "to", " ", "go", " ", "nowhere", " ", 
    RowBox[{"(", 
     RowBox[{"except", " ", "when", " ", "lucky"}], ")"}]}], " ", 
   "*)"}]}]], "Input",ExpressionUUID->"c250b494-246c-4872-95b0-68585eb35967"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareRejectWaveColoringLayout", "[", 
   RowBox[{"2", ",", "0.01", ",", "10"}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "slow", " ", "being", " ", "even", " ", "slower", " ", "makes", " ", 
    "this", " ", "the", " ", "best", " ", 
    RowBox[{"CRN", "!"}]}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{3.8648696349154243`*^9},
 CellLabel->
  "In[417]:=",ExpressionUUID->"a3fe906c-2b6c-42a6-888d-bc5629d634fc"],

Cell[BoxData["\<\"Colorable!\"\>"], "Print",
 CellChangeTimes->{{3.8648696259686728`*^9, 3.864869637629013*^9}, 
   3.86486967465094*^9, 3.864870060090767*^9},
 CellLabel->
  "During evaluation of \
In[417]:=",ExpressionUUID->"aa03f1e7-2283-4187-a805-ace839753b99"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Dynamic", "[", 
   RowBox[{"ShowSurfaceCRNState", "[", 
    RowBox[{"cfsurface", ",", "fsurfacecoloring", ",", 
     RowBox[{"PlotLabel", "\[Rule]", "fsurfacetime"}]}], "]"}], "]"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{"!", "halted"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dt", ",", "devents", ",", "halted"}], "}"}], ",", 
        "cfsurface"}], "}"}], "=", 
      RowBox[{"InfoRunSurfaceCRN", "[", 
       RowBox[{"cfsurfaceCRN", ",", "cfsurface", ",", "1"}], "]"}]}], ";", 
     RowBox[{"fsurfacetime", "+=", "dt"}], ";", 
     RowBox[{"csurfaceevents", "+=", "devents"}]}]}], "]"}], ";"}]}], "Input",\

 CellLabel->
  "In[418]:=",ExpressionUUID->"9bc4270c-17b0-45aa-a0bb-e0f74f299a03"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   $CellContext`ShowSurfaceCRNState[$CellContext`cfsurface, \
$CellContext`fsurfacecoloring, PlotLabel -> $CellContext`fsurfacetime], 
   StandardForm],
  ImageSizeCache->{540., {147., 155.}}]], "Output",
 CellChangeTimes->{{3.864869638874983*^9, 3.864869678322094*^9}, 
   3.864870062437605*^9},
 CellLabel->
  "Out[418]=",ExpressionUUID->"4244bf02-251c-461f-ad52-41feeddff3e2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Statistics and Metrics", "Subtitle",
 CellChangeTimes->{{3.864870778450914*^9, 
  3.86487078522148*^9}},ExpressionUUID->"fbcf7d49-d4ee-4bb0-98f3-\
441e450c012a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FindColorableMap", "[", 
   RowBox[{"n_", ",", "m_", ",", "p_", ",", "q_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", "graph", ",", "SATtime", ",", "sat", ",", 
      RowBox[{"colorable", "=", "False"}], ",", 
      RowBox[{"attempts", "=", "0"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"!", "colorable"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"map", ",", "graph"}], "}"}], "=", 
         RowBox[{"RandomSquareColoringMap", "[", 
          RowBox[{"n", ",", "m", ",", "p", ",", "q"}], "]"}]}], ";", 
        RowBox[{"attempts", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"sat", "=", 
         RowBox[{"ColoringSAT", "[", 
          RowBox[{"graph", ",", "k"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"SATtime", ",", "colorable"}], "}"}], "=", 
         RowBox[{"AbsoluteTiming", "[", 
          RowBox[{"SatisfiableQ", "[", "sat", "]"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"attempts", ">", "10"}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<It took \>\"", ",", "attempts", ",", 
         "\"\< attempts to find a colorable graph!\>\""}], "]"}]}], "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"attempts", ",", "map", ",", 
       RowBox[{"VertexCount", "[", "graph", "]"}], ",", 
       RowBox[{"EdgeCount", "[", "graph", "]"}], ",", "SATtime"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellLabel->
  "In[420]:=",ExpressionUUID->"51811813-3254-4885-8ac7-1b093bbce73c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SurfaceMapColoringTimes", "[", 
   RowBox[{"map_", ",", "k_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"CRNtime", ",", 
      RowBox[{"dt", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fsurfaceCRNorig", "=", 
      RowBox[{"SurfaceMapColoringCRN", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fsurfaceorig", "=", "map"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacecoloring", "=", 
      RowBox[{"MapColoringRules", "[", "k", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fsurfaceCRN", ",", " ", "fsurface"}], "}"}], "=", 
      RowBox[{"CompileSurfaceCRN", "[", 
       RowBox[{"fsurfaceCRNorig", ",", "fsurfaceorig"}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"csurfaceevents", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"CRNtime", ",", "fsurface"}], "}"}], "=", 
      RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"!", "halted"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ddt", ",", "eventcount", ",", "halted"}], "}"}], ",", 
              "fsurface"}], "}"}], "=", 
            RowBox[{"InfoRunSurfaceCRN", "[", 
             RowBox[{"fsurfaceCRN", ",", "fsurface", ",", "dt"}], "]"}]}], 
           ";", 
           RowBox[{"fsurfacetime", "+=", "ddt"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "fsurface"}], "\[IndentingNewLine]", "]"}]}], 
     ";", "\[IndentingNewLine]", "CRNtime"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.864871033028861*^9, 3.864871034077691*^9}, {
   3.864871475081355*^9, 3.864871514576119*^9}, {3.864871756611927*^9, 
   3.8648717873410883`*^9}, 3.864873461634918*^9},
 CellLabel->
  "In[429]:=",ExpressionUUID->"2135b270-ee9b-49a3-b08b-be70464771e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapColoringStats", "[", 
   RowBox[{"map_", ",", "k_", ",", "trials_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SurfaceMapColoringTimes", "[", 
         RowBox[{"map", ",", "k"}], "]"}], ",", "trials"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Around", "[", 
      RowBox[{
       RowBox[{"Mean", "[", "data", "]"}], ",", 
       RowBox[{"StandardDeviation", "[", "data", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[425]:=",ExpressionUUID->"b313ccf8-d844-4f49-92e4-299369f13b87"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RejectWaveColoringTimes", "[", 
    RowBox[{"map_", ",", "k_", ",", 
     RowBox[{"slow_", ":", "1"}], ",", 
     RowBox[{"fast_", ":", "1"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"CRNtime", ",", 
       RowBox[{"dt", "=", "1000"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fsurfaceCRNorig", "=", 
       RowBox[{"SurfaceRejectWaveColoringCRN", "[", 
        RowBox[{"k", ",", "slow", ",", "fast"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"fsurfaceorig", "=", "map"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fsurfacecoloringorig", "=", 
       RowBox[{"RejectWaveColoringRules", "[", "k", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"fsurfaceCRN", ",", " ", "fsurface"}], "}"}], "=", 
       RowBox[{"CompileSurfaceCRN", "[", 
        RowBox[{"fsurfaceCRNorig", ",", "fsurfaceorig"}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"halted", "=", "False"}], ";", "\[IndentingNewLine]", 
      RowBox[{"csurfaceevents", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"fsurfacetime", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"CRNtime", ",", "fsurface"}], "}"}], "=", 
       RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"!", "halted"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"ddt", ",", "eventcount", ",", "halted"}], "}"}], ",",
                "fsurface"}], "}"}], "=", 
             RowBox[{"InfoRunSurfaceCRN", "[", 
              RowBox[{"fsurfaceCRN", ",", "fsurface", ",", "dt"}], "]"}]}], 
            ";", 
            RowBox[{"fsurfacetime", "+=", "ddt"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "fsurface"}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", "CRNtime"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.864873724495475*^9, 3.864873743243861*^9}},
 CellLabel->
  "In[432]:=",ExpressionUUID->"1f7d109c-b783-4ce6-9c55-b9c863bee336"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RejectWaveColoringStats", "[", 
   RowBox[{"map_", ",", "k_", ",", "slow_", ",", "fast_", ",", "trials_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"RejectWaveColoringTimes", "[", 
         RowBox[{"map", ",", "k", ",", "slow", ",", "fast"}], "]"}], ",", 
        "trials"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Around", "[", 
      RowBox[{
       RowBox[{"Mean", "[", "data", "]"}], ",", 
       RowBox[{"StandardDeviation", "[", "data", "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->
  "In[433]:=",ExpressionUUID->"9ccb0171-ef15-4383-92a9-36044cfeb694"],

Cell[BoxData[
 RowBox[{
  RowBox[{"referencemap", "=", 
   RowBox[{
    RowBox[{"FindColorableMap", "[", 
     RowBox[{"10", ",", "10", ",", "0.3", ",", "0.9", ",", "3"}], "]"}], "[", 
    
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]], "Input",
 CellLabel->
  "In[422]:=",ExpressionUUID->"43e3b6f1-93d0-4af9-9881-e8b44aeebfdd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MapColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "10"}], "]"}]], "Input",
 CellChangeTimes->{
  3.864846985199675*^9, {3.864873273809226*^9, 3.86487328023311*^9}, 
   3.864873764270014*^9},ExpressionUUID->"8f8efea9-a618-4d33-9915-\
df5cbedb5be3"],

Cell[BoxData[
 InterpretationBox[
  TemplateBox[{"14.", "16."},
   "Around"],
  Around[14.0203081, 16.091241891665177`]]], "Output",
 CellChangeTimes->{3.864873385058852*^9, 3.864873644762418*^9},
 CellLabel->
  "Out[431]=",ExpressionUUID->"f1827301-ca4b-4e70-b7dd-014ff95ccbd9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RejectWaveColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "10", ",", ".1", ",", "10"}], 
  "]"}]], "Input",
 CellLabel->
  "In[434]:=",ExpressionUUID->"400bdf3e-4f24-430e-accc-0733cf0f5132"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.86487395816092*^9},
 CellLabel->
  "Out[434]=",ExpressionUUID->"7d45d183-1dbb-4468-9846-fe1dcdfd9398"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"RejectWaveColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "10", ",", ".5", ",", "10"}], 
  "]"}]], "Input",ExpressionUUID->"538e513f-40a8-4990-9dfd-c083cec057c5"],

Cell[BoxData[
 RowBox[{"RejectWaveColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "5", ",", ".2", ",", "10"}], 
  "]"}]], "Input",ExpressionUUID->"5b8670ed-6bc3-4495-9ede-b42efcc423c0"],

Cell[BoxData[
 RowBox[{"RejectWaveColoringStats", "[", 
  RowBox[{"referencemap", ",", "3", ",", "0.01", ",", "10", ",", "100"}], 
  "]"}]], "Input",
 CellLabel->
  "In[435]:=",ExpressionUUID->"5ea3f04c-c376-4317-87a4-5ba149b458cc"],

Cell["", "Text",
 CellChangeTimes->{{3.864837884452323*^9, 3.864837886676248*^9}, {
   3.8648388594132147`*^9, 3.864838882079335*^9}, 3.864845002590157*^9, {
   3.8648452237856503`*^9, 3.8648452243390493`*^9}, 3.8648457886709137`*^9, 
   3.864846370378364*^9},ExpressionUUID->"005ddb10-38dd-4514-8696-\
37fee3e24a87"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{316, Automatic}, {Automatic, 50}},
Magnification->1.5,
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"db548663-cae8-49bc-8e95-80c966277e43"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 179, 3, 146, "Title",ExpressionUUID->"5377b741-064c-4bfd-9618-9c003df36aba"],
Cell[762, 27, 170, 3, 79, "Subtitle",ExpressionUUID->"ad04706b-4c9c-4107-9bfd-b4b2ddcaa615"],
Cell[935, 32, 2818, 57, 531, "Text",ExpressionUUID->"c79309bd-00ee-40c4-a32b-60a42fc3526b"],
Cell[3756, 91, 14204, 349, 949, "Code",ExpressionUUID->"db77a4dc-5fc7-4648-82df-4d4595ec3b3a"],
Cell[CellGroupData[{
Cell[17985, 444, 206, 6, 127, "Subtitle",ExpressionUUID->"3536790e-3449-453b-87c1-c2d094ee4d28"],
Cell[18194, 452, 4547, 115, 485, "Code",ExpressionUUID->"1c1aa549-3870-48ca-8bd8-77c482da4641"],
Cell[CellGroupData[{
Cell[22766, 571, 3443, 78, 653, "Input",ExpressionUUID->"42d6d275-9d5b-41b8-a2df-ed14cf6989e4"],
Cell[26212, 651, 239, 5, 36, "Print",ExpressionUUID->"13ecba7e-0bc6-4787-b85b-8e057f9042c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26488, 661, 1811, 37, 219, "Input",ExpressionUUID->"752db4b5-bdde-454e-a617-7d5718c7bbb5"],
Cell[28302, 700, 942, 16, 345, "Output",ExpressionUUID->"8e3d9c82-4a13-4bf1-9327-ce8c7b873356"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[29293, 722, 220, 4, 79, "Subtitle",ExpressionUUID->"0800482e-d0a4-4d57-a50d-7fa316592fd7"],
Cell[29516, 728, 10080, 242, 763, "Code",ExpressionUUID->"9a61a7b5-e66a-4633-a3f3-d323a83b67d5"],
Cell[CellGroupData[{
Cell[39621, 974, 3619, 80, 622, "Input",ExpressionUUID->"7f167c9f-c058-45ff-9504-2299899c358f"],
Cell[43243, 1056, 431, 8, 36, "Print",ExpressionUUID->"3261627a-0771-4620-b6f1-5cf681c3a169"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43711, 1069, 1079, 28, 188, "Input",ExpressionUUID->"78180cd0-fb4f-4019-a5f1-e43d4b44126f"],
Cell[44793, 1099, 654, 12, 345, "Output",ExpressionUUID->"bae51b4a-8e85-4230-b72d-1f6f2bd4dd31"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45496, 1117, 166, 3, 79, "Subtitle",ExpressionUUID->"4c070306-031b-4c9e-9114-39140cb053f0"],
Cell[45665, 1122, 9354, 224, 705, "Code",ExpressionUUID->"910d4a30-bea9-40f9-863d-43f900ab9c90"],
Cell[CellGroupData[{
Cell[55044, 1350, 3685, 85, 653, "Input",ExpressionUUID->"957fc8d6-558e-413a-993c-16f5e499ca01"],
Cell[58732, 1437, 216, 4, 36, "Print",ExpressionUUID->"4ad04be9-b75c-43bd-9394-d61f97fa09d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58985, 1446, 838, 24, 188, "Input",ExpressionUUID->"68ea8bbd-21b7-4abd-bc71-e91ea7e59fd0"],
Cell[59826, 1472, 386, 8, 345, "Output",ExpressionUUID->"eb37516b-f336-4b2b-a210-cdb704a92605"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60261, 1486, 218, 4, 79, "Subtitle",ExpressionUUID->"6a5b6613-1a9c-4128-9b00-feb6fc9f2f75"],
Cell[60482, 1492, 13877, 323, 995, "Code",ExpressionUUID->"9b4e0e9a-559a-487b-b191-6562d321185b"],
Cell[74362, 1817, 3357, 77, 591, "Input",ExpressionUUID->"02800625-b98f-4f5c-9a77-b4f3f83495f3"],
Cell[77722, 1896, 556, 14, 109, "Input",ExpressionUUID->"e5f7e767-74dd-4ddf-adcd-4c12b4cdc995"],
Cell[78281, 1912, 478, 10, 78, "Input",ExpressionUUID->"c250b494-246c-4872-95b0-68585eb35967"],
Cell[CellGroupData[{
Cell[78784, 1926, 459, 11, 63, "Input",ExpressionUUID->"a3fe906c-2b6c-42a6-888d-bc5629d634fc"],
Cell[79246, 1939, 265, 5, 36, "Print",ExpressionUUID->"aa03f1e7-2283-4187-a805-ace839753b99"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79548, 1949, 838, 24, 188, "Input",ExpressionUUID->"9bc4270c-17b0-45aa-a0bb-e0f74f299a03"],
Cell[80389, 1975, 414, 9, 345, "Output",ExpressionUUID->"4244bf02-251c-461f-ad52-41feeddff3e2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80852, 1990, 167, 3, 79, "Subtitle",ExpressionUUID->"fbcf7d49-d4ee-4bb0-98f3-441e450c012a"],
Cell[81022, 1995, 1794, 44, 250, "Input",ExpressionUUID->"51811813-3254-4885-8ac7-1b093bbce73c"],
Cell[82819, 2041, 2284, 52, 529, "Input",ExpressionUUID->"2135b270-ee9b-49a3-b08b-be70464771e5"],
Cell[85106, 2095, 749, 20, 157, "Input",ExpressionUUID->"b313ccf8-d844-4f49-92e4-299369f13b87"],
Cell[85858, 2117, 2411, 55, 591, "Input",ExpressionUUID->"1f7d109c-b783-4ce6-9c55-b9c863bee336"],
Cell[88272, 2174, 817, 21, 157, "Input",ExpressionUUID->"9ccb0171-ef15-4383-92a9-36044cfeb694"],
Cell[89092, 2197, 327, 9, 63, "Input",ExpressionUUID->"43e3b6f1-93d0-4af9-9881-e8b44aeebfdd"],
Cell[CellGroupData[{
Cell[89444, 2210, 287, 6, 46, "Input",ExpressionUUID->"8f8efea9-a618-4d33-9915-df5cbedb5be3"],
Cell[89734, 2218, 279, 7, 69, "Output",ExpressionUUID->"f1827301-ca4b-4e70-b7dd-014ff95ccbd9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90050, 2230, 229, 5, 63, "Input",ExpressionUUID->"400bdf3e-4f24-430e-accc-0733cf0f5132"],
Cell[90282, 2237, 159, 3, 69, "Output",ExpressionUUID->"7d45d183-1dbb-4468-9846-fe1dcdfd9398"]
}, Open  ]],
Cell[90456, 2243, 201, 3, 46, "Input",ExpressionUUID->"538e513f-40a8-4990-9dfd-c083cec057c5"],
Cell[90660, 2248, 200, 3, 46, "Input",ExpressionUUID->"5b8670ed-6bc3-4495-9ede-b42efcc423c0"],
Cell[90863, 2253, 232, 5, 63, "Input",ExpressionUUID->"5ea3f04c-c376-4317-87a4-5ba149b458cc"],
Cell[91098, 2260, 317, 5, 53, "Text",ExpressionUUID->"005ddb10-38dd-4514-8696-37fee3e24a87"]
}, Open  ]]
}, Open  ]]
}
]
*)

