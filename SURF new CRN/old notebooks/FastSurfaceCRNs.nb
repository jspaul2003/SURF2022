(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    462919,       9829]
NotebookOptionsPosition[    442697,       9495]
NotebookOutlinePosition[    448350,       9615]
CellTagsIndexPosition[    448307,       9612]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Fast and faster surface CRN simulators", "Title",
 CellChangeTimes->{
  3.818565174571698*^9, {3.818565208420986*^9, 3.8185652354340067`*^9}, {
   3.821763550797429*^9, 3.8217635610181513`*^9}, {3.8293084226104307`*^9, 
   3.8293084282985764`*^9}, {3.829427718137992*^9, 
   3.829427721446808*^9}},ExpressionUUID->"cc7c940f-23d2-4ce7-95e7-\
a576cb9ba273"],

Cell[TextData[{
 "This notebook was prepared by Erik Winfree <winfree@caltech.edu> for \
Caltech BE/CS 191b, Spring 2021.  \n",
 StyleBox["Do not share this with anyone who is not currently taking the \
class unless you have permission from Erik Winfree.",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.820351424938045*^9, 3.820351445782344*^9}, {
   3.820368437453093*^9, 3.8203684819722643`*^9}, 3.820472677966508*^9, {
   3.8207972478187237`*^9, 3.820797249605282*^9}, {3.8209411813285847`*^9, 
   3.820941181418469*^9}, {3.821765265511417*^9, 3.821765275847251*^9}, {
   3.8224426511554527`*^9, 3.822442651472589*^9}, {3.8227729227817373`*^9, 
   3.822772923151351*^9}, {3.822874981028717*^9, 3.822875001880706*^9}, {
   3.823471187852744*^9, 3.823471188143159*^9}, {3.823475014813491*^9, 
   3.823475034418499*^9}, {3.82347517537428*^9, 3.823475204864468*^9}, {
   3.825512650242001*^9, 3.825512661066691*^9}, {3.825513071463574*^9, 
   3.825513071522691*^9}, {3.825513223801775*^9, 3.8255132415902977`*^9}, {
   3.8255467804189034`*^9, 3.825546783978465*^9}, {3.829308432675383*^9, 
   3.829308433089655*^9}, {3.831999506655518*^9, 3.8319995071746607`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"9d092be7-87fc-4418-8d02-1d63f91e6e4f"],

Cell[CellGroupData[{

Cell["Code from and for the well-mixed stochastic CRN simulator", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 
  3.8217636024725533`*^9}},ExpressionUUID->"99990c80-f429-42da-b2a3-\
1454896505b4"],

Cell["\<\
This is the simulator that can pre-process large (may reactions) CRNs for \
faster simulation, as used in the WalkSATCRN paper.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
  3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
  3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
  3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
  3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
  3.829308482435864*^9}, {3.829309335623828*^9, 3.8293093447975473`*^9}, {
  3.8293093810059557`*^9, 3.8293094288789797`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"de843a09-6ce5-4447-babf-ac4d071081d1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<CRNSimulator.m\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", "\"\<CRNSimulatorSSA5.m\>\"", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.756939388737718*^9, 3.7569394056949167`*^9}, 
   3.756939438583961*^9, {3.7572866561186523`*^9, 3.7572866562936563`*^9}, {
   3.757734559281149*^9, 3.757734566896432*^9}, 3.821300854746962*^9, 
   3.821301124988103*^9, 3.8293092004281282`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"dfc26316-e2a9-4d63-928b-6b8bc9ea88bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Code from and for the original surface CRN simulator", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.829309268487936*^9, 
  3.829309270948065*^9}},ExpressionUUID->"66ded67b-3e71-4a2e-8dc7-\
6d800ce0792b"],

Cell["\<\
For comparison and validation of the faster surface CRN simulator.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
  3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
  3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
  3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
  3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
  3.829308482435864*^9}, {3.82930932487986*^9, 3.829309328492969*^9}, {
  3.82930943409247*^9, 3.829309446378063*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"a39cfb25-3a34-49c2-b01a-76d11455661e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"RunSurfaceCRN", "[", 
   RowBox[{"crn_", ",", "state_", ",", "tmax_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "state", "]"}]}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"First", "[", "state", "]"}], "]"}]}], ",", "species", ",", 
      RowBox[{"t", "=", "0"}], ",", "kmax", ",", "unirules", ",", "birules", 
      ",", "S", ",", "i", ",", "j", ",", "di", ",", "dj", ",", "actions", ",",
       "new1", ",", "new2", ",", "ktot"}], "}"}], ",", "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{"S", "=", "state"}], ";", "\[IndentingNewLine]", 
     RowBox[{"birules", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"crn", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{
              RowBox[{"a_", "+", "b_"}], ",", 
              RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{
              RowBox[{"2", "a_"}], ",", 
              RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{
              RowBox[{"a_", "+", "b_"}], ",", 
              RowBox[{"2", "c_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"c", ",", "c", ",", "k"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{
              RowBox[{"2", "a_"}], ",", 
              RowBox[{"2", "c_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"c", ",", "c", ",", "k"}], "}"}]}], ")"}]}]}], "}"}]}],
         ",", "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"unirules", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"crn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{"_Times", ",", "___"}], "]"}], "\[Rule]", "None"}], ",", 
           
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{"_Plus", ",", "___"}], "]"}], "\[Rule]", "None"}], ",", 
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{"a_", ",", "b_", ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "a", "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"b", ",", "k"}], "}"}]}], ")"}]}]}], "}"}]}], ",", 
        "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"species", "=", 
      RowBox[{"SpeciesInRxnsys", "[", "crn", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"kmax", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", 
          RowBox[{"Last", "/@", 
           RowBox[{"Last", "/@", "#"}]}], "]"}], "&"}], "/@", 
        RowBox[{"GatherBy", "[", 
         RowBox[{
          RowBox[{"unirules", "~", "Join", "~", "birules"}], ",", "First"}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"t", "<", "tmax"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", "+=", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            RowBox[{"RandomReal", "[", "]"}], "]"}]}], "/", 
          RowBox[{"(", 
           RowBox[{"5", " ", "kmax", " ", "n", " ", "m"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i", ",", "j"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "n"}], "}"}], "]"}], ",", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "m"}], "}"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RandomReal", "[", "]"}], "<", 
           RowBox[{"1", "/", "5"}]}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{
           "unimolecular", " ", "rate", " ", "should", " ", "be", " ", 
            "balanced", " ", "with", " ", "the", " ", "4", " ", "bimolecular",
             " ", "rates"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"actions", "=", 
            RowBox[{"ReplaceList", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"S", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}], "}"}], ",", 
              "unirules"}], "]"}]}], ";", 
           RowBox[{"ktot", "=", 
            RowBox[{"Total", "[", 
             RowBox[{"Last", "/@", "actions"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "actions", "]"}], ">", "0"}], "&&", 
              RowBox[{"ktot", ">", "0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"new1", "=", 
               RowBox[{"RandomChoice", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Last", "/@", "actions"}], ")"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"First", "/@", "actions"}], ")"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"RandomReal", "[", "]"}], "<", 
                 RowBox[{"ktot", "/", "kmax"}]}], ",", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", "new1"}]}], 
               "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"else", " ", "bimolecular"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"di", ",", "dj"}], "}"}], "=", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"+", "1"}]}], "}"}]}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"1", "\[LessEqual]", 
               RowBox[{"i", "+", "di"}], "\[LessEqual]", "n"}], "&&", 
              RowBox[{"1", "\[LessEqual]", 
               RowBox[{"j", "+", "dj"}], "\[LessEqual]", "m"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"actions", "=", 
               RowBox[{"ReplaceList", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}]}], "]"}], "]"}]}], "}"}], ",", 
                 "birules"}], "]"}]}], ";", 
              RowBox[{"ktot", "=", 
               RowBox[{"Total", "[", 
                RowBox[{"Last", "/@", "actions"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "actions", "]"}], ">", "0"}], "&&", 
                 RowBox[{"ktot", ">", "0"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"new1", ",", "new2"}], "}"}], "=", 
                  RowBox[{"RandomChoice", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Last", "/@", "actions"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Take", "[", 
                    RowBox[{"#", ",", "2"}], "]"}], "&"}], "/@", "actions"}], 
                    ")"}]}], "]"}]}], ";", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", 
                    RowBox[{"ktot", "/", "kmax"}]}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}]}], "]"}], "]"}]}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "new2"}], "}"}]}]}], "]"}]}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "S"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781651274360599*^9, 3.7816514892033*^9}, {
   3.781652096422318*^9, 3.78165218455435*^9}, {3.781652229362276*^9, 
   3.781652268909336*^9}, {3.781652314506386*^9, 3.781652373223322*^9}, {
   3.78165242238306*^9, 3.78165261948767*^9}, {3.781654087654706*^9, 
   3.781654123965427*^9}, {3.7816541963116627`*^9, 3.781654211103456*^9}, 
   3.781655688215148*^9, {3.821488443569254*^9, 3.821488578375073*^9}, {
   3.821488805867117*^9, 3.8214888143777857`*^9}, {3.821488848084844*^9, 
   3.8214888679954233`*^9}, {3.821489134769868*^9, 3.821489149295885*^9}, {
   3.821489691151334*^9, 3.82148981467875*^9}, {3.821489851077654*^9, 
   3.821489910530439*^9}, {3.821489942489389*^9, 3.821489963583885*^9}, {
   3.821490100290226*^9, 3.821490117237113*^9}, {3.8214903353966312`*^9, 
   3.821490393056683*^9}, {3.821490468899506*^9, 3.821490721497278*^9}, {
   3.821490778067947*^9, 3.821490837427792*^9}, {3.8214911590355053`*^9, 
   3.821491161946781*^9}, {3.821491357788289*^9, 3.821491366357773*^9}, {
   3.8214914279736433`*^9, 3.821491492246211*^9}, {3.821492187521584*^9, 
   3.821492380396805*^9}, {3.82149276261454*^9, 3.821492798042297*^9}, {
   3.821493397740169*^9, 3.821493562202622*^9}, {3.821493639905229*^9, 
   3.821493640361871*^9}, {3.821494773695602*^9, 3.821495009630947*^9}, {
   3.821667626415061*^9, 3.821667711419366*^9}, {3.821667743027349*^9, 
   3.82166776790061*^9}, 3.8226083777829447`*^9, {3.822608410543561*^9, 
   3.822608478371851*^9}, {3.8226090090507174`*^9, 3.8226091581076593`*^9}, {
   3.822609376091175*^9, 3.822609381961532*^9}, 3.827680801146142*^9, 
   3.827680850930419*^9, {3.8276813320701714`*^9, 3.827681337019346*^9}, {
   3.827681398645331*^9, 3.827681422937181*^9}, {3.8276815880857153`*^9, 
   3.8276816662040586`*^9}, {3.8276822049948606`*^9, 3.827682212794751*^9}, {
   3.827686280834577*^9, 3.827686281228088*^9}, {3.82768634303336*^9, 
   3.8276863977573347`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"e859825e-af7b-488c-b12f-1c16d1746e4f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HaltedSurfaceCRNQ", "[", 
   RowBox[{"crn_", ",", "state_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "state", "]"}]}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"First", "[", "state", "]"}], "]"}]}], ",", "unirules", ",", 
      "birules", ",", 
      RowBox[{"S", "=", "state"}], ",", "ExistsReactionQ"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"birules", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"crn", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{
              RowBox[{"a_", "+", "b_"}], ",", 
              RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{
              RowBox[{"2", "a_"}], ",", 
              RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{
              RowBox[{"a_", "+", "b_"}], ",", 
              RowBox[{"2", "c_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"c", ",", "c", ",", "k"}], "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{
              RowBox[{"2", "a_"}], ",", 
              RowBox[{"2", "c_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"c", ",", "c", ",", "k"}], "}"}]}], ")"}]}]}], "}"}]}],
         ",", "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"unirules", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{
        RowBox[{"crn", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{"_Times", ",", "___"}], "]"}], "\[Rule]", "None"}], ",", 
           
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{"_Plus", ",", "___"}], "]"}], "\[Rule]", "None"}], ",", 
           RowBox[{
            RowBox[{"rxn", "[", 
             RowBox[{"a_", ",", "b_", ",", "k_"}], "]"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "a", "}"}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"b", ",", "k"}], "}"}]}], ")"}]}]}], "}"}]}], ",", 
        "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExistsReactionQ", "[", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Join", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ReplaceList", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}], "}"}], ",", 
             "unirules"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "<", "n"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "1"}], ",", "j"}], "]"}], "]"}]}], 
                "}"}], ",", "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", ">", "1"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}], 
                "}"}], ",", "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", "<", "m"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "+", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
               "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"j", ">", "1"}], ",", 
             RowBox[{"ReplaceList", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", 
                    RowBox[{"j", "-", "1"}]}], "]"}], "]"}]}], "}"}], ",", 
               "birules"}], "]"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}], "]"}], "]"}], ">", "0"}], ")"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"!", 
      RowBox[{"AnyTrue", "[", 
       RowBox[{
        RowBox[{"Tuples", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", "n", "]"}], ",", 
           RowBox[{"Range", "[", "m", "]"}]}], "}"}], "]"}], ",", 
        "ExistsReactionQ"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781651274360599*^9, 3.7816514892033*^9}, {
   3.781652096422318*^9, 3.78165218455435*^9}, {3.781652229362276*^9, 
   3.781652268909336*^9}, {3.781652314506386*^9, 3.781652373223322*^9}, {
   3.78165242238306*^9, 3.78165261948767*^9}, {3.781654087654706*^9, 
   3.781654123965427*^9}, {3.7816541963116627`*^9, 3.781654211103456*^9}, 
   3.781655688215148*^9, {3.821488443569254*^9, 3.821488578375073*^9}, {
   3.821488805867117*^9, 3.8214888143777857`*^9}, {3.821488848084844*^9, 
   3.8214888679954233`*^9}, {3.821489134769868*^9, 3.821489149295885*^9}, {
   3.821489691151334*^9, 3.82148981467875*^9}, {3.821489851077654*^9, 
   3.821489910530439*^9}, {3.821489942489389*^9, 3.821489963583885*^9}, {
   3.821490100290226*^9, 3.821490117237113*^9}, {3.8214903353966312`*^9, 
   3.821490393056683*^9}, {3.821490468899506*^9, 3.821490721497278*^9}, {
   3.821490778067947*^9, 3.821490837427792*^9}, {3.8214911590355053`*^9, 
   3.821491161946781*^9}, {3.821491357788289*^9, 3.821491366357773*^9}, {
   3.8214914279736433`*^9, 3.821491492246211*^9}, {3.821492187521584*^9, 
   3.821492380396805*^9}, {3.82149276261454*^9, 3.821492798042297*^9}, {
   3.821493397740169*^9, 3.821493562202622*^9}, {3.821493639905229*^9, 
   3.821493640361871*^9}, {3.821494773695602*^9, 3.821495009630947*^9}, {
   3.821667626415061*^9, 3.821667711419366*^9}, {3.821667743027349*^9, 
   3.82166776790061*^9}, {3.8221597971863737`*^9, 3.822159832660551*^9}, {
   3.822159878401012*^9, 3.8221599019053288`*^9}, {3.822159939933475*^9, 
   3.822159940378166*^9}, {3.822159973749579*^9, 3.822160224038684*^9}, {
   3.822160257177094*^9, 3.822160412588707*^9}, {3.822160553117717*^9, 
   3.8221605652423887`*^9}, {3.822160776398992*^9, 3.822160777564622*^9}, {
   3.822160809275507*^9, 3.822160822982099*^9}, {3.82216095267922*^9, 
   3.822160959424983*^9}, {3.822161019465481*^9, 3.8221610206559353`*^9}, {
   3.823303920584174*^9, 3.8233039208402042`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"96944310-f4ff-4d9a-9835-3e6997ff3d20"]
}, Open  ]],

Cell[CellGroupData[{

Cell["A test case will be 2D diffusion-limited aggregation", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.8293093013511972`*^9, 
  3.82930930344156*^9}, {3.8293156298397093`*^9, 3.82931563816496*^9}, {
  3.829315738401884*^9, 
  3.8293157428071747`*^9}},ExpressionUUID->"15bdaf1b-8646-45b4-9b84-\
6872e8be98ae"],

Cell["\<\
This is meant to be a reasonably typical surface CRN example, which we\
\[CloseCurlyQuote]ll use for initial testing.  Later, we\[CloseCurlyQuote]ll \
try more examples.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
   3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
   3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
   3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
   3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
   3.829308482435864*^9}, {3.829311907880188*^9, 3.829311912318799*^9}, {
   3.8293121025759373`*^9, 3.829312117521493*^9}, {3.8293171485477133`*^9, 
   3.829317173276876*^9}, {3.829331821875764*^9, 3.829331853437752*^9}, 
   3.829331926731311*^9, {3.8294283187790537`*^9, 3.829428343589019*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"e6a29f15-4c63-4e9c-b07a-b51438e215f6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"init2D", "=", 
   RowBox[{"ArrayPad", "[", 
    RowBox[{
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", "F", "}"}], "}"}], ",", "20", ",", "W"}], "]"}], ",", 
     "1", ",", "G"}], "]"}]}], ";", 
  RowBox[{"space2D", "=", "init2D"}], ";", " ", 
  RowBox[{"time2D", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coloring2D", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"F", "\[Rule]", "Cyan"}], ",", 
     RowBox[{"G", "\[Rule]", 
      RowBox[{"Lighter", "[", "Gray", "]"}]}], ",", 
     RowBox[{"P", "\[Rule]", "Gray"}], ",", " ", 
     RowBox[{"W", "\[Rule]", "White"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DLAcrn", "=", "\[IndentingNewLine]", 
  RowBox[{"{", "  ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"G", "+", "W"}], ",", 
      RowBox[{"G", "+", "P"}], ",", "0.1"}], "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
     "create", " ", "a", " ", "new", " ", "diffusing", " ", "particle", " ", 
      "near", " ", "the", " ", "generative", " ", "boundary", " ", "of", " ", 
      "\"\<G\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"G", "+", "P"}], ",", 
      RowBox[{"G", "+", "W"}], ",", "1"}], "]"}], ",", " ", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "particles", " ", "can", " ", "also", " ", "diffuse", " ", "out", " ", 
       "through", " ", "the", " ", "G", " ", "walls"}], ",", " ", 
      RowBox[{
       RowBox[{"so", " ", "steady"}], "-", 
       RowBox[{"state", " ", "concentration", " ", "is", " ", "10", "%"}]}]}],
      " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"P", "+", "W"}], ",", 
      RowBox[{"W", "+", "P"}], ",", "1"}], "]"}], ",", 
    RowBox[{"(*", " ", 
     RowBox[{"particle", " ", "diffuses", " ", "through", " ", "water"}], " ",
      "*)"}], "\[IndentingNewLine]", 
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"P", "+", "F"}], ",", 
      RowBox[{"F", "+", "F"}], ",", "10"}], "]"}]}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "particle", " ", "freezes", " ", "when", " ", "it", " ", "touches", " ", 
     "frozen", " ", "molecules"}], " ", "*)"}], "\[IndentingNewLine]", 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.8264996895813427`*^9, 3.826499737796554*^9}, {
   3.8264997742397833`*^9, 3.8264997939540586`*^9}, {3.8264999167906723`*^9, 
   3.826499926469016*^9}, {3.826500029638318*^9, 3.826500029939207*^9}, {
   3.826500421423396*^9, 3.826500425089904*^9}, {3.826500531151617*^9, 
   3.826500531481823*^9}, {3.826502361878281*^9, 3.8265023842688093`*^9}, {
   3.8265033827760277`*^9, 3.826503390447267*^9}, {3.826504179273624*^9, 
   3.826504239545396*^9}, {3.826504534877653*^9, 3.8265045366355667`*^9}, {
   3.826504632039052*^9, 3.8265046396276217`*^9}, {3.8265053735977507`*^9, 
   3.826505487206479*^9}, {3.8265055477485857`*^9, 3.826505629440769*^9}, {
   3.826505659712998*^9, 3.826505911832775*^9}, {3.826505950412156*^9, 
   3.82650595117912*^9}, {3.826505981279467*^9, 3.826506091659033*^9}, {
   3.826506227090391*^9, 3.826506227410582*^9}, {3.826506263703318*^9, 
   3.826506271795012*^9}, {3.827432476601519*^9, 3.827432500902001*^9}, {
   3.8274325434657507`*^9, 3.8274325534119596`*^9}, {3.827432624356997*^9, 
   3.827432781757617*^9}, 3.827454495960462*^9, {3.827456800281636*^9, 
   3.827456800693369*^9}, {3.8276986531028423`*^9, 3.827698742454764*^9}, {
   3.827698895577091*^9, 3.827698898361462*^9}, {3.829315652217708*^9, 
   3.829315664241089*^9}, {3.829315988034835*^9, 3.829315988433991*^9}, {
   3.829316227362216*^9, 3.829316232283485*^9}, {3.829331907701565*^9, 
   3.829331932766954*^9}, {3.829331965331389*^9, 3.829331991292667*^9}, {
   3.829332147217218*^9, 3.829332147503584*^9}, {3.829335925805994*^9, 
   3.829335953215469*^9}},ExpressionUUID->"f47552db-a581-438a-a6b3-\
5e92ff003b68"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"G", "+", "W"}], " ", 
    OverscriptBox["\[RightArrow]", 
     RowBox[{" ", "0.1`", " "}]], " ", 
    RowBox[{"G", "+", "P"}]}], " ", ",", 
   RowBox[{
    RowBox[{"G", "+", "P"}], " ", 
    OverscriptBox["\[RightArrow]", 
     RowBox[{" ", "1", " "}]], " ", 
    RowBox[{"G", "+", "W"}]}], " ", ",", 
   RowBox[{
    RowBox[{"P", "+", "W"}], " ", 
    OverscriptBox["\[RightArrow]", 
     RowBox[{" ", "1", " "}]], " ", 
    RowBox[{"W", "+", "P"}]}], " ", ",", 
   RowBox[{
    RowBox[{"P", "+", "F"}], " ", 
    OverscriptBox["\[RightArrow]", 
     RowBox[{" ", "10", " "}]], " ", 
    RowBox[{"2", " ", "F"}]}]}], " ", "}"}]], "Output",
 CellChangeTimes->{
  3.8293157465744267`*^9, {3.82931596642533*^9, 3.829315988908638*^9}, 
   3.829316243027733*^9, 3.8293163672953863`*^9, 3.829316655685274*^9, {
   3.829331937532195*^9, 3.82933199291628*^9}, 3.829332153440383*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"a0316145-b15a-4e1d-9b16-4e4e6272ae80"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"space2D", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", "coloring2D"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "time2D"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.821491024929027*^9, 3.821491036723599*^9}, {
   3.8214912667784557`*^9, 3.821491269984231*^9}, {3.821666402739387*^9, 
   3.8216664361548443`*^9}, {3.821847159700281*^9, 3.821847173989032*^9}, {
   3.8218557100028763`*^9, 3.821855751741219*^9}, 3.821855792356524*^9, {
   3.8218559241964493`*^9, 3.8218559276879263`*^9}, {3.8218559866120996`*^9, 
   3.8218560397531757`*^9}, {3.821883127575139*^9, 3.8218831340419083`*^9}, {
   3.821883203231083*^9, 3.821883210963731*^9}, {3.821894833691724*^9, 
   3.8218948453692636`*^9}, {3.829315798777371*^9, 3.829315837005123*^9}, {
   3.829315956700979*^9, 3.829315957501523*^9}, {3.829316237820953*^9, 
   3.829316241247119*^9}, {3.8293319951102047`*^9, 3.829331995401763*^9}, {
   3.82933215104847*^9, 
   3.8293321513064423`*^9}},ExpressionUUID->"c212fa81-c4b2-4f68-8235-\
e50809a73bb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"time2D", "=", "0"}], ";", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"space2D", "=", 
        RowBox[{"RunSurfaceCRN", "[", 
         RowBox[{"DLAcrn", ",", "space2D", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"time2D", "+=", "dt"}]}], ",", "1000"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.82166644256629*^9, 
   3.821666452132885*^9}, 3.821666515815844*^9, {3.82166839068404*^9, 
   3.82166842602209*^9}, {3.821847178235992*^9, 3.821847189020856*^9}, {
   3.821847650881916*^9, 3.821847678627214*^9}, 3.821847903273849*^9, {
   3.821848012199296*^9, 3.821848012650454*^9}, {3.821848608605753*^9, 
   3.821848608876388*^9}, {3.821855776849679*^9, 3.821855787763978*^9}, {
   3.821855820331203*^9, 3.821855917955414*^9}, 3.821855975565772*^9, {
   3.821883253710037*^9, 3.8218832537610807`*^9}, 3.82188666698765*^9, 
   3.821886921149913*^9, 3.821894905177718*^9, {3.829315848004698*^9, 
   3.82931588607215*^9}, {3.829316247700232*^9, 3.8293162504112177`*^9}, {
   3.829331998045542*^9, 3.829332030461441*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"8abd42f8-c1b6-4f58-a008-9cd2ae0d23b7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunSurfaceCRN", "[", 
    RowBox[{"DLAcrn", ",", "space2D", ",", "100"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8214941208359423`*^9, 3.821494148838941*^9}, {
   3.821495511260285*^9, 3.821495512708765*^9}, {3.8216687602638893`*^9, 
   3.821668771193119*^9}, {3.821847192780324*^9, 3.821847195763915*^9}, {
   3.821847659364608*^9, 3.8218476756481733`*^9}, {3.829315893763999*^9, 
   3.829315899605915*^9}, 3.829316150535265*^9, {3.829316252214962*^9, 
   3.8293162525134*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"67c9e129-e5a5-4e07-a767-b23a57819bf4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"90.691856`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.821494127056902*^9, 3.821494150318115*^9}, 
   3.821495513904023*^9, {3.821668792410816*^9, 3.82166879517176*^9}, 
   3.821668841670136*^9, 3.821847199510709*^9, {3.821847664377255*^9, 
   3.821847676473131*^9}, {3.829316148288684*^9, 3.82931615315164*^9}, 
   3.8293164757185802`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"6e65be63-f134-4e29-a18b-ce1adc705c0d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["New code for the fast surface CRN simulator", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.8293093013511972`*^9, 
  3.82930930344156*^9}, {3.829347501234201*^9, 
  3.8293475020790653`*^9}},ExpressionUUID->"c42ad146-f408-4eff-9904-\
dfcacbda4936"],

Cell["\<\
The simulator will be for 3D.  There will be both 2D and 3D plotting \
functions.  First we just try compiling, but using the same intrinsically \
slow algorithm.   About 10x speed up, depending...\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
  3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
  3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
  3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
  3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
  3.829308482435864*^9}, {3.829311907880188*^9, 3.829311912318799*^9}, {
  3.8293121025759373`*^9, 3.829312117521493*^9}, {3.8293171485477133`*^9, 
  3.829317173276876*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"6fd05b60-3908-4332-be81-9953da3e8ef3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"EngineNeighbors", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"+", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"+", "1"}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"EngineFastSurfaceCRN", "=", " ", 
  RowBox[{"Compile", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"space", ",", "_Integer", ",", "3"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"unireactions", ",", "_Integer", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"unirates", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bireactions", ",", "_Integer", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"birates", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"kmax", ",", "_Real"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"tmax", ",", "_Real"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", "space", "]"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", "space", "]"}], "]"}]}], ",", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "space", "]"}], "]"}], "]"}]}], ",", 
        RowBox[{"t", "=", "0.0"}], ",", 
        RowBox[{"S", "=", "space"}], ",", "i", ",", "j", ",", "k", ",", "di", 
        ",", "dj", ",", "dk", ",", "r", ",", "actions", ",", "act", ",", "na",
         ",", "new1", ",", "new2", ",", "ktot", ",", "ksum", ",", "a", ",", 
        "b", ",", "newp"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"actions", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"Length", "[", "unirates", "]"}], ",", 
             RowBox[{
              RowBox[{"Length", "[", "birates", "]"}], "+", "1"}]}], "]"}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"t", "<", "tmax"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"t", "+=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"RandomReal", "[", "]"}], "]"}]}], "/", 
            RowBox[{"(", 
             RowBox[{"7", " ", "kmax", " ", "d", " ", "n", " ", "m"}], 
             ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "k"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "d"}], "}"}], "]"}], ",", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "n"}], "}"}], "]"}], ",", 
             RowBox[{"RandomInteger", "[", 
              RowBox[{"{", 
               RowBox[{"1", ",", "m"}], "}"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RandomReal", "[", "]"}], "<", 
             RowBox[{"1", "/", "7"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "unimolecular", " ", "rate", " ", "should", " ", "be", " ", 
              "balanced", " ", "with", " ", "the", " ", "6", " ", 
              RowBox[{"bimolecular", "/", "diffusion"}], " ", "rates"}], " ", 
             "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"na", "=", "0"}], ";", 
                RowBox[{"ktot", "=", "0.0"}], ";", 
                RowBox[{"r", "=", "1"}]}], ",", 
               RowBox[{"r", "\[LessEqual]", 
                RowBox[{"Length", "[", "unireactions", "]"}]}], ",", 
               RowBox[{"r", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"S", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], 
                  "\[Equal]", 
                  RowBox[{"unireactions", "[", 
                   RowBox[{"[", 
                    RowBox[{"r", ",", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"actions", "[", 
                    RowBox[{"[", 
                    RowBox[{"++", "na"}], "]"}], "]"}], "=", "r"}], ";", 
                  RowBox[{"ktot", "+=", 
                   RowBox[{"unirates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";",
              "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"na", ">", "0"}], "&&", 
                RowBox[{"ktot", ">", "0"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"newp", "=", 
                 RowBox[{
                  RowBox[{"RandomReal", "[", "]"}], "*", "ktot"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ksum", "=", 
                    RowBox[{"unirates", "[", 
                    RowBox[{"[", 
                    RowBox[{"actions", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
                   RowBox[{"act", "=", "1"}]}], ",", 
                  RowBox[{
                   RowBox[{"act", "<", "na"}], "&&", 
                   RowBox[{"ksum", "<", "newp"}]}], ",", 
                  RowBox[{"act", "++"}], ",", 
                  RowBox[{"ksum", "+=", 
                   RowBox[{"unirates", "[", 
                    RowBox[{"[", 
                    RowBox[{"actions", "[", 
                    RowBox[{"[", 
                    RowBox[{"act", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}]}],
                  "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"new1", "=", 
                 RowBox[{"unireactions", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"actions", "[", 
                    RowBox[{"[", "act", "]"}], "]"}], ",", "2"}], "]"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"RandomReal", "[", "]"}], "<", 
                   RowBox[{"ktot", "/", "kmax"}]}], ",", 
                  RowBox[{
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
                   "new1"}]}], "]"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"else", " ", "bimolecular"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
              RowBox[{"RandomChoice", "[", "EngineNeighbors", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"1", "\[LessEqual]", 
                 RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                RowBox[{"1", "\[LessEqual]", 
                 RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                RowBox[{"1", "\[LessEqual]", 
                 RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"a", "=", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ";", 
                RowBox[{"b", "=", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"For", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ktot", "=", "0.0"}], ";", 
                   RowBox[{"na", "=", "0"}], ";", 
                   RowBox[{"r", "=", "1"}]}], ",", 
                  RowBox[{"r", "\[LessEqual]", 
                   RowBox[{"Length", "[", "bireactions", "]"}]}], ",", 
                  RowBox[{"r", "++"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], "}"}], 
                    "\[Equal]", 
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"actions", "[", 
                    RowBox[{"[", 
                    RowBox[{"++", "na"}], "]"}], "]"}], "=", "r"}], ";", 
                    RowBox[{"ktot", "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}]}]}], "]"}]}], "]"}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"na", ">", "0"}], "&&", 
                   RowBox[{"ktot", ">", "0"}]}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"newp", "=", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "*", "ktot"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ksum", "=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"actions", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ";", 
                    RowBox[{"act", "=", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"act", "<", "na"}], "&&", 
                    RowBox[{"ksum", "<", "newp"}]}], ",", 
                    RowBox[{"act", "++"}], ",", 
                    RowBox[{"ksum", "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"actions", "[", 
                    RowBox[{"[", 
                    RowBox[{"act", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}]}],
                     "]"}], ";", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "new2"}], "}"}], "=", 
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"actions", "[", 
                    RowBox[{"[", "act", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", 
                    RowBox[{"ktot", "/", "kmax"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
                    "new1"}], ";", 
                    RowBox[{
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}], "=", 
                    "new2"}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
                ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", "S"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CompilationOptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       ",", 
       RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}]}], "}"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
    RowBox[{"Parallelization", "->", "True"}], ",", 
    RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781651274360599*^9, 3.7816514892033*^9}, {
   3.781652096422318*^9, 3.78165218455435*^9}, {3.781652229362276*^9, 
   3.781652268909336*^9}, {3.781652314506386*^9, 3.781652373223322*^9}, {
   3.78165242238306*^9, 3.78165261948767*^9}, {3.781654087654706*^9, 
   3.781654123965427*^9}, {3.7816541963116627`*^9, 3.781654211103456*^9}, 
   3.781655688215148*^9, {3.821488443569254*^9, 3.821488578375073*^9}, {
   3.821488805867117*^9, 3.8214888143777857`*^9}, {3.821488848084844*^9, 
   3.8214888679954233`*^9}, {3.821489134769868*^9, 3.821489149295885*^9}, {
   3.821489691151334*^9, 3.82148981467875*^9}, {3.821489851077654*^9, 
   3.821489910530439*^9}, {3.821489942489389*^9, 3.821489963583885*^9}, {
   3.821490100290226*^9, 3.821490117237113*^9}, {3.8214903353966312`*^9, 
   3.821490393056683*^9}, {3.821490468899506*^9, 3.821490721497278*^9}, {
   3.821490778067947*^9, 3.821490837427792*^9}, {3.8214911590355053`*^9, 
   3.821491161946781*^9}, {3.821491357788289*^9, 3.821491366357773*^9}, {
   3.8214914279736433`*^9, 3.821491492246211*^9}, {3.821492187521584*^9, 
   3.821492380396805*^9}, {3.82149276261454*^9, 3.821492798042297*^9}, {
   3.821493397740169*^9, 3.821493562202622*^9}, {3.821493639905229*^9, 
   3.821493640361871*^9}, {3.821494773695602*^9, 3.821495009630947*^9}, {
   3.821667626415061*^9, 3.821667711419366*^9}, {3.821667743027349*^9, 
   3.82166776790061*^9}, 3.8226083777829447`*^9, {3.822608410543561*^9, 
   3.822608478371851*^9}, {3.8226090090507174`*^9, 3.8226091581076593`*^9}, {
   3.822609376091175*^9, 3.822609381961532*^9}, {3.826490117841283*^9, 
   3.826490127965609*^9}, {3.826490296804644*^9, 3.8264903190663023`*^9}, {
   3.8264904472396*^9, 3.8264904499324207`*^9}, {3.8264904889045143`*^9, 
   3.826490694257897*^9}, {3.8264907906283083`*^9, 3.826490790988693*^9}, {
   3.826491034152959*^9, 3.8264910867757473`*^9}, {3.826494658889443*^9, 
   3.826494701454627*^9}, {3.8264952080065117`*^9, 3.8264952441429377`*^9}, {
   3.826495391718115*^9, 3.826495426008934*^9}, {3.82649545916541*^9, 
   3.826495461823557*^9}, {3.826495514842798*^9, 3.826495629911133*^9}, {
   3.826495707526843*^9, 3.826495729409141*^9}, {3.82649578602295*^9, 
   3.826495987146162*^9}, {3.826496945583682*^9, 3.8264969915024157`*^9}, {
   3.826497036091778*^9, 3.826497104159731*^9}, {3.82649715387149*^9, 
   3.8264971828931093`*^9}, {3.826497240700202*^9, 3.826497409414976*^9}, {
   3.82649758367306*^9, 3.8264976459917927`*^9}, {3.8264976934790897`*^9, 
   3.826497730453253*^9}, {3.826497939923622*^9, 3.826497994593171*^9}, {
   3.826498046440185*^9, 3.8264980986670713`*^9}, {3.826499604645473*^9, 
   3.826499610112589*^9}, {3.82650076491949*^9, 3.826500786463396*^9}, {
   3.826500847488289*^9, 3.826500882816243*^9}, {3.8265009208231287`*^9, 
   3.8265009211713657`*^9}, {3.826500988858039*^9, 3.826501027155529*^9}, {
   3.8265014710833473`*^9, 3.826501522045053*^9}, 3.826501997846107*^9, {
   3.826502032680872*^9, 3.826502072085429*^9}, {3.826502140526155*^9, 
   3.8265021581655893`*^9}, {3.8274351123592978`*^9, 
   3.8274351245598297`*^9}, {3.8274351921608047`*^9, 
   3.8274352095176077`*^9}, {3.827435268635062*^9, 3.8274353071722193`*^9}, {
   3.8274353768251534`*^9, 3.82743552009692*^9}, {3.827435562863843*^9, 
   3.827435576653614*^9}, {3.827435657406066*^9, 3.8274356874027367`*^9}, {
   3.827435763080701*^9, 3.827435778299739*^9}, {3.8274358385137777`*^9, 
   3.827435849242551*^9}, {3.827435879546389*^9, 3.827435889122077*^9}, {
   3.827439059515089*^9, 3.827439125085788*^9}, {3.827439171200235*^9, 
   3.827439473804582*^9}, {3.827440544484023*^9, 3.8274405908105707`*^9}, {
   3.8274438300291443`*^9, 3.8274439854668007`*^9}, {3.827444105281102*^9, 
   3.827444187118676*^9}, {3.827444241544485*^9, 3.827444251013945*^9}, {
   3.827444939623866*^9, 3.8274449654403687`*^9}, {3.827445409476548*^9, 
   3.827445599832376*^9}, {3.827445634723226*^9, 3.827445677554667*^9}, {
   3.827445839398787*^9, 3.827445861840085*^9}, 3.827445916855886*^9, {
   3.827446199026907*^9, 3.827446361000649*^9}, {3.8274466270153913`*^9, 
   3.8274466387037907`*^9}, {3.82744671007747*^9, 3.827446726783412*^9}, {
   3.8274478312160273`*^9, 3.827447839514165*^9}, {3.827447880858128*^9, 
   3.827447932332026*^9}, {3.827448587556196*^9, 3.827448658356574*^9}, {
   3.827448776923015*^9, 3.8274487878106127`*^9}, {3.8274494332828903`*^9, 
   3.827449496988875*^9}, {3.827449530123499*^9, 3.8274497262404213`*^9}, {
   3.827449771997669*^9, 3.827449777029212*^9}, {3.827449810417149*^9, 
   3.827449926368108*^9}, {3.827449959856124*^9, 3.827450025047139*^9}, {
   3.827450081003139*^9, 3.827450165529408*^9}, {3.8274502352702436`*^9, 
   3.827450288304428*^9}, {3.8274503346044893`*^9, 3.827450372710339*^9}, {
   3.8274552179018517`*^9, 3.827455279500752*^9}, {3.8274553240930977`*^9, 
   3.8274553412921267`*^9}, {3.827455461362588*^9, 3.82745554006597*^9}, {
   3.8274556490265837`*^9, 3.827455673473378*^9}, {3.827455861689157*^9, 
   3.827455872362143*^9}, {3.827456171424363*^9, 3.827456194301757*^9}, {
   3.827456403945945*^9, 3.827456439089635*^9}, {3.827456518198135*^9, 
   3.827456525475007*^9}, {3.8274565790153217`*^9, 3.8274566115069447`*^9}, {
   3.827456657463909*^9, 3.827456667558611*^9}, {3.82745670109046*^9, 
   3.827456715283847*^9}, {3.8276860801451797`*^9, 3.827686083297187*^9}, {
   3.827686440700819*^9, 3.8276866821423197`*^9}, {3.827687138276053*^9, 
   3.827687138636119*^9}, {3.827687182269754*^9, 3.827687187815103*^9}, {
   3.827687234472637*^9, 3.827687237224285*^9}, {3.827687322163837*^9, 
   3.827687378460202*^9}, {3.827687419741844*^9, 3.827687419841092*^9}, {
   3.827687477485483*^9, 3.827687515184065*^9}, {3.827688910570066*^9, 
   3.82768892258862*^9}, {3.827689455641632*^9, 3.827689468926861*^9}, 
   3.8276895076673317`*^9, {3.82769145706855*^9, 3.827691478569367*^9}, {
   3.827691679856038*^9, 3.8276917064620333`*^9}, {3.827691834857884*^9, 
   3.82769183948332*^9}, {3.8276919973695517`*^9, 3.827692059800847*^9}, 
   3.8276922126574802`*^9, {3.8276922727183523`*^9, 3.827692301838957*^9}, {
   3.827692345238646*^9, 3.8276923491117153`*^9}, {3.8276929383258057`*^9, 
   3.827693043530583*^9}, {3.8276931511196632`*^9, 3.827693173171525*^9}, {
   3.827693213660039*^9, 3.82769326159099*^9}, {3.827693583747015*^9, 
   3.8276936878414097`*^9}, {3.8276937568317213`*^9, 
   3.8276937679334507`*^9}, {3.8276945232525473`*^9, 3.827694579565968*^9}, {
   3.827694649406556*^9, 3.827694649837871*^9}, {3.8276947219253674`*^9, 
   3.827694768944418*^9}, {3.827694864995953*^9, 3.827694865492052*^9}, {
   3.8276949255058413`*^9, 3.8276949981318808`*^9}, {3.829311071079625*^9, 
   3.8293110870472107`*^9}, {3.829311674079611*^9, 3.8293116837638187`*^9}, {
   3.829311717698142*^9, 3.829311757581853*^9}, {3.829311788546165*^9, 
   3.829311811571733*^9}, {3.82931212172125*^9, 3.8293121240325193`*^9}, 
   3.829313173107744*^9, {3.8293132378299503`*^9, 3.8293132389853477`*^9}, {
   3.829313367819182*^9, 3.829313375224931*^9}, {3.8293134412381496`*^9, 
   3.8293135261663523`*^9}, {3.829313565362571*^9, 3.8293135681235723`*^9}, {
   3.82931540052383*^9, 3.82931540428677*^9}, {3.829315441729999*^9, 
   3.829315447344001*^9}, {3.82935083575909*^9, 3.829350836117942*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"99c148a2-7f4b-43e5-a7c7-fe01c7c22633"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["CompiledFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
                 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                
                "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
             AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["7", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  StyleBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real", ",", 
                    "_Real"}], "}"}], ContentPadding -> False, FrameMargins -> 
                    0, StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                   False], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
                 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                
                "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
             AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["7", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", "_Real", ",", 
                    "_Real"}], "}"}], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "space", ",", "unireactions", ",", "unirates", ",", 
                    "bireactions", ",", "birates", ",", "kmax", ",", "tmax"}],
                     "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "=", 
                    RowBox[{"Length", "[", "space", "]"}]}], ",", 
                    RowBox[{"n", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "[", "space", "]"}], "]"}]}], ",", 
                    RowBox[{"m", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "space", "]"}], "]"}], "]"}]}], ",", 
                    RowBox[{"t", "=", "0.`"}], ",", 
                    RowBox[{"S", "=", "space"}], ",", "i", ",", "j", ",", "k",
                     ",", "di", ",", "dj", ",", "dk", ",", "r", ",", 
                    "actions", ",", "act", ",", "na", ",", "new1", ",", 
                    "new2", ",", "ktot", ",", "ksum", ",", "a", ",", "b", ",",
                     "newp"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"actions", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0", ",", 
                    RowBox[{"{", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"Length", "[", "unirates", "]"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "birates", "]"}], "+", "1"}]}], 
                    "]"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"t", "<", "tmax"}], ",", 
                    RowBox[{
                    RowBox[{"t", "+=", 
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"Log", "[", 
                    RowBox[{"RandomReal", "[", "]"}], "]"}], 
                    
                    RowBox[{"7", " ", "kmax", " ", "d", " ", "n", " ", 
                    "m"}]]}]}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j", ",", "k"}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "d"}], "}"}], "]"}], ",", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "n"}], "}"}], "]"}], ",", 
                    RowBox[{"RandomInteger", "[", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "m"}], "}"}], "]"}]}], "}"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", 
                    FractionBox["1", "7"]}], ",", 
                    RowBox[{
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"na", "=", "0"}], ";", 
                    RowBox[{"ktot", "=", "0.`"}], ";", 
                    RowBox[{"r", "=", "1"}]}], ",", 
                    RowBox[{"r", "\[LessEqual]", 
                    RowBox[{"Length", "[", "unireactions", "]"}]}], ",", 
                    RowBox[{"r", "++"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"actions", "\[LeftDoubleBracket]", 
                    RowBox[{"++", "na"}], "\[RightDoubleBracket]"}], "=", 
                    "r"}], ";", 
                    RowBox[{"ktot", "+=", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"na", ">", "0"}], "&&", 
                    RowBox[{"ktot", ">", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"newp", "=", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], " ", "ktot"}]}], ";", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ksum", "=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    
                    RowBox[{"actions", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"act", "=", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"act", "<", "na"}], "&&", 
                    RowBox[{"ksum", "<", "newp"}]}], ",", 
                    RowBox[{"act", "++"}], ",", 
                    RowBox[{"ksum", "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"actions", "\[LeftDoubleBracket]", 
                    RowBox[{"act", "+", "1"}], "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
                    RowBox[{"new1", "=", 
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    
                    RowBox[{"actions", "\[LeftDoubleBracket]", "act", 
                    "\[RightDoubleBracket]"}], ",", "2"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", 
                    FractionBox["ktot", "kmax"]}], ",", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "=", "new1"}]}], "]"}]}]}], 
                    "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{"RandomChoice", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    RowBox[{
                    RowBox[{"a", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"b", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ktot", "=", "0.`"}], ";", 
                    RowBox[{"na", "=", "0"}], ";", 
                    RowBox[{"r", "=", "1"}]}], ",", 
                    RowBox[{"r", "\[LessEqual]", 
                    RowBox[{"Length", "[", "bireactions", "]"}]}], ",", 
                    RowBox[{"r", "++"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    "}"}], "\[Equal]", 
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"actions", "\[LeftDoubleBracket]", 
                    RowBox[{"++", "na"}], "\[RightDoubleBracket]"}], "=", 
                    "r"}], ";", 
                    RowBox[{"ktot", "+=", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"na", ">", "0"}], "&&", 
                    RowBox[{"ktot", ">", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"newp", "=", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], " ", "ktot"}]}], ";", 
                    RowBox[{"For", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"ksum", "=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    
                    RowBox[{"actions", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"act", "=", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{"act", "<", "na"}], "&&", 
                    RowBox[{"ksum", "<", "newp"}]}], ",", 
                    RowBox[{"act", "++"}], ",", 
                    RowBox[{"ksum", "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"actions", "\[LeftDoubleBracket]", 
                    RowBox[{"act", "+", "1"}], "\[RightDoubleBracket]"}], 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "new2"}], "}"}], "=", 
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    
                    RowBox[{"actions", "\[LeftDoubleBracket]", "act", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], "<", 
                    FractionBox["ktot", "kmax"]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "=", "new1"}], ";", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}], 
                    "=", "new2"}]}]}], "]"}]}]}], "]"}], ";"}]}], "]"}], 
                    ";"}]}], "]"}], ";"}]}], "]"}], ";", "S"}]}], "]"}], 
                   ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 0, 
                   StripOnInput -> True], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  CompiledFunction[{11, 13., 7768}, {{
     Blank[Integer], 3}, {
     Blank[Integer], 2}, {
     Blank[Real], 1}, {
     Blank[Integer], 2}, {
     Blank[Real], 1}, 
    Blank[Real], 
    Blank[Real]}, {{2, 3, 0}, {2, 2, 1}, {3, 1, 2}, {2, 2, 3}, {3, 1, 4}, {3, 
   0, 0}, {3, 0, 1}, {2, 3, 
   10}}, {{False, {1, 0, 4}}, {0, {2, 0, 9}}, {1., {3, 0, 3}}, {
    5, {2, 0, 22}}, {2, {2, 0, 12}}, {{1, 2}, {2, 1, 9}}, {
    7, {2, 0, 10}}, {{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 
     0, -1}, {0, 0, 1}}, {2, 2, 8}}, {1, {2, 0, 1}}, {
    3, {2, 0, 11}}, {{3, 4}, {2, 1, 11}}, {0., {3, 0, 2}}}, {8, 27, 11, 0, 
   13}, {{33, 0, 19}, {38, 0, 0, 1, 2, 5}, {33, 5, 15}, {38, 0, 0, 1, 2, 5}, {
    38, 5, 0, 1, 1, 10}, {33, 10, 17}, {7, 2, 5}, {
    42, "CopyTensor", 2, 3, 0, 2, 3, 10}, {33, 2, 5}, {33, 4, 14}, {12, 14, 1,
     14}, {42, "MaxI", 2, 0, 5, 2, 0, 14, 2, 0, 6}, {6, 9, 14}, {35, 6, 2, 
    5}, {6, 9, 5}, {3, 2}, {36, 14, 9, 2, 5}, {4, 5, 6, -1}, {27, 3, 2, 5, 1, 
    0}, {2, 0, 204}, {42, "RandomReal", 3, 0, 2, 3, 0, 3, 3, 0, 6}, {40, 34, 
    3, 0, 6, 3, 0, 7}, {19, 7, 6}, {10, 10, 7}, {10, 19, 4}, {10, 15, 8}, {10,
     17, 9}, {16, 7, 0, 4, 8, 9, 7}, {40, 60, 3, 0, 7, 3, 0, 4}, {16, 6, 4, 
    6}, {13, 5, 6, 4}, {7, 4, 5}, {
    42, "RandomInteger", 2, 0, 1, 2, 0, 19, 2, 0, 13}, {
    42, "RandomInteger", 2, 0, 1, 2, 0, 15, 2, 0, 4}, {
    42, "RandomInteger", 2, 0, 1, 2, 0, 17, 2, 0, 14}, {34, 1, 3, 13, 4, 14, 
    2, 7}, {33, 7, 13}, {24, 13, 11, 1}, {32, 1, 1}, {2, 1, 3}, {49}, {3, 
    1}, {37, 7, 1, 2, 13}, {37, 7, 12, 2, 4}, {37, 7, 11, 2, 14}, {
    42, "RandomReal", 3, 0, 2, 3, 0, 3, 3, 0, 4}, {10, 10, 6}, {40, 60, 3, 0, 
    6, 3, 0, 7}, {27, 3, 2, 4, 7, 1}, {2, 1, 62}, {6, 9, 5}, {7, 2, 4}, {6, 1,
     6}, {33, 1, 8}, {26, 6, 8, 6}, {2, 6, 16}, {38, 10, 0, 13, 0, 4, 0, 14, 
    0, 7}, {38, 1, 0, 6, 0, 1, 0, 3}, {24, 7, 3, 3}, {2, 3, 8}, {12, 5, 1, 
    7}, {6, 7, 5}, {39, 5, 0, 5, 0, 6}, {38, 2, 0, 6, 0, 7}, {13, 4, 7, 6}, {
    7, 6, 4}, {3, 1}, {6, 6, 8}, {12, 8, 1, 7}, {6, 7, 6}, {3, -17}, {25, 9, 
    5, 6}, {2, 6, 5}, {10, 9, 6}, {27, 7, 2, 4, 6, 3}, {5, 3, 7}, {3, 2}, {5, 
    4, 7}, {2, 7, 32}, {42, "RandomReal", 3, 0, 2, 3, 0, 3, 3, 0, 6}, {16, 6, 
    4, 6}, {38, 5, 0, 1, 0, 8}, {38, 2, 0, 8, 0, 7}, {6, 1, 8}, {25, 8, 5, 
    6}, {2, 6, 4}, {27, 3, 2, 7, 6, 3}, {5, 3, 5}, {3, 2}, {5, 4, 5}, {2, 5, 
    10}, {12, 8, 1, 3}, {38, 5, 0, 3, 0, 2}, {38, 2, 0, 2, 0, 8}, {13, 7, 8, 
    9}, {7, 9, 7}, {6, 8, 7}, {12, 7, 1, 3}, {6, 3, 8}, {3, -15}, {38, 5, 0, 
    8, 0, 7}, {38, 1, 0, 7, 0, 12, 0, 2}, {
    42, "RandomReal", 3, 0, 2, 3, 0, 3, 3, 0, 9}, {40, 60, 3, 0, 0, 3, 0, 
    8}, {16, 4, 8, 10}, {27, 3, 2, 9, 10, 5}, {2, 5, 3}, {39, 10, 0, 13, 0, 4,
     0, 14, 0, 2}, {3, 1}, {3, 1}, {3, 112}, {
    42, "RandomChoice", 2, 2, 8, 2, 1, 7}, {33, 7, 7}, {24, 7, 11, 7}, {32, 7,
     7}, {2, 7, 3}, {49}, {3, 1}, {37, 7, 1, 2, 7}, {37, 7, 12, 2, 3}, {37, 7,
     11, 2, 0}, {12, 13, 7, 21}, {26, 1, 21, 19, 7}, {2, 7, 11}, {12, 4, 3, 
    21}, {26, 1, 21, 15, 5}, {2, 5, 5}, {12, 14, 0, 21}, {26, 1, 21, 17, 6}, {
    5, 6, 3}, {3, 2}, {5, 4, 3}, {5, 3, 5}, {3, 2}, {5, 4, 5}, {2, 5, 87}, {
    38, 10, 0, 13, 0, 4, 0, 14, 0, 21}, {12, 13, 7, 18}, {12, 4, 3, 20}, {12, 
    14, 0, 16}, {38, 10, 0, 18, 0, 20, 0, 16, 0, 23}, {7, 2, 4}, {6, 9, 5}, {
    6, 1, 6}, {33, 3, 18}, {26, 6, 18, 7}, {2, 7, 21}, {38, 10, 0, 13, 0, 4, 
    0, 14, 0, 20}, {12, 13, 7, 16}, {12, 4, 3, 24}, {12, 14, 0, 25}, {38, 10, 
    0, 16, 0, 24, 0, 25, 0, 26}, {34, 1, 2, 20, 26, 2, 7}, {38, 3, 0, 6, 1, 9,
     1, 12}, {
    42, "CompareTensor", 2, 0, 22, 3, 0, 2, 2, 1, 7, 2, 1, 12, 1, 0, 6}, {2, 
    6, 8}, {12, 5, 1, 20}, {6, 20, 5}, {39, 5, 0, 5, 0, 6}, {38, 4, 0, 6, 0, 
    9}, {13, 4, 9, 10}, {7, 10, 4}, {3, 1}, {6, 6, 18}, {12, 18, 1, 20}, {6, 
    20, 6}, {3, -22}, {25, 9, 5, 7}, {2, 7, 5}, {10, 9, 10}, {27, 7, 2, 4, 10,
     6}, {5, 6, 3}, {3, 2}, {5, 4, 3}, {2, 3, 47}, {
    42, "RandomReal", 3, 0, 2, 3, 0, 3, 3, 0, 10}, {16, 10, 4, 10}, {7, 10, 
    6}, {38, 5, 0, 1, 0, 18}, {38, 4, 0, 18, 0, 10}, {7, 10, 7}, {6, 1, 8}, {
    25, 8, 5, 7}, {2, 7, 4}, {27, 3, 2, 7, 6, 6}, {5, 6, 2}, {3, 2}, {5, 4, 
    2}, {2, 2, 10}, {12, 8, 1, 20}, {38, 5, 0, 20, 0, 26}, {38, 4, 0, 26, 0, 
    10}, {13, 7, 10, 9}, {7, 9, 7}, {6, 8, 18}, {12, 18, 1, 20}, {6, 20, 8}, {
    3, -15}, {38, 5, 0, 8, 0, 18}, {38, 3, 0, 18, 1, 11, 1, 7}, {33, 7, 18}, {
    24, 18, 12, 2}, {32, 2, 2}, {2, 2, 3}, {49}, {3, 1}, {37, 7, 1, 2, 18}, {
    6, 18, 2}, {37, 7, 12, 2, 18}, {
    42, "RandomReal", 3, 0, 2, 3, 0, 3, 3, 0, 9}, {40, 60, 3, 0, 0, 3, 0, 
    10}, {16, 4, 10, 8}, {27, 3, 2, 9, 8, 2}, {2, 2, 7}, {39, 10, 0, 13, 0, 4,
     0, 14, 0, 2}, {12, 13, 7, 26}, {12, 4, 3, 20}, {12, 14, 0, 16}, {39, 10, 
    0, 26, 0, 20, 0, 16, 0, 18}, {3, 1}, {3, 1}, {3, 1}, {3, -204}, {1}}, 
   Function[{$CellContext`space, $CellContext`unireactions, \
$CellContext`unirates, $CellContext`bireactions, $CellContext`birates, \
$CellContext`kmax, $CellContext`tmax}, 
    Module[{$CellContext`d = Length[$CellContext`space], $CellContext`n = 
      Length[
        First[$CellContext`space]], $CellContext`m = Length[
        First[
         First[$CellContext`space]]], $CellContext`t = 
      0., $CellContext`S = $CellContext`space, $CellContext`i, \
$CellContext`j, $CellContext`k, $CellContext`di, $CellContext`dj, \
$CellContext`dk, $CellContext`r, $CellContext`actions, $CellContext`act, \
$CellContext`na, $CellContext`new1, $CellContext`new2, $CellContext`ktot, \
$CellContext`ksum, $CellContext`a, $CellContext`b, $CellContext`newp}, \
$CellContext`actions = Table[0, {
         Max[
          Length[$CellContext`unirates], Length[$CellContext`birates] + 1]}]; 
     While[$CellContext`t < $CellContext`tmax, AddTo[$CellContext`t, (-Log[
            RandomReal[]])/(
         7 $CellContext`kmax $CellContext`d $CellContext`n $CellContext`m)]; \
{$CellContext`i, $CellContext`j, $CellContext`k} = {
          RandomInteger[{1, $CellContext`d}], 
          RandomInteger[{1, $CellContext`n}], 
          RandomInteger[{1, $CellContext`m}]}; 
       If[RandomReal[] < 1/7, 
         For[$CellContext`na = 0; $CellContext`ktot = 0.; $CellContext`r = 
            1, $CellContext`r <= Length[$CellContext`unireactions], 
           Increment[$CellContext`r], 
           If[
           Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k] == Part[$CellContext`unireactions, $CellContext`r, 1], 
            Part[$CellContext`actions, 
               PreIncrement[$CellContext`na]] = $CellContext`r; 
            AddTo[$CellContext`ktot, 
              Part[$CellContext`unirates, $CellContext`r]]]]; If[
           
           And[$CellContext`na > 0, $CellContext`ktot > 0], $CellContext`newp = 
            RandomReal[] $CellContext`ktot; 
           For[$CellContext`ksum = Part[$CellContext`unirates, 
                Part[$CellContext`actions, 1]]; $CellContext`act = 1, 
             
             And[$CellContext`act < $CellContext`na, $CellContext`ksum < \
$CellContext`newp], 
             Increment[$CellContext`act], 
             AddTo[$CellContext`ksum, 
              Part[$CellContext`unirates, 
               
               Part[$CellContext`actions, $CellContext`act + 
                1]]]]; $CellContext`new1 = Part[$CellContext`unireactions, 
              Part[$CellContext`actions, $CellContext`act], 2]; 
           If[RandomReal[] < $CellContext`ktot/$CellContext`kmax, 
             Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k] = $CellContext`new1]], {$CellContext`di, $CellContext`dj, \
$CellContext`dk} = 
          RandomChoice[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 
            0, -1}, {0, 0, 1}}]; If[
           And[
           1 <= $CellContext`i + $CellContext`di <= $CellContext`d, 
            1 <= $CellContext`j + $CellContext`dj <= $CellContext`n, 
            1 <= $CellContext`k + $CellContext`dk <= $CellContext`m], \
$CellContext`a = 
            Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]; $CellContext`b = 
            Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]; 
           For[$CellContext`ktot = 0.; $CellContext`na = 0; $CellContext`r = 
              1, $CellContext`r <= Length[$CellContext`bireactions], 
             Increment[$CellContext`r], 
             If[{
                
                Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k], 
                
                Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]} == 
              Part[$CellContext`bireactions, $CellContext`r, {1, 2}], 
              Part[$CellContext`actions, 
                 PreIncrement[$CellContext`na]] = $CellContext`r; 
              AddTo[$CellContext`ktot, 
                Part[$CellContext`birates, $CellContext`r]]]]; If[
             
             And[$CellContext`na > 0, $CellContext`ktot > 
              0], $CellContext`newp = RandomReal[] $CellContext`ktot; 
             For[$CellContext`ksum = Part[$CellContext`birates, 
                  Part[$CellContext`actions, 1]]; $CellContext`act = 1, 
               
               And[$CellContext`act < $CellContext`na, $CellContext`ksum < \
$CellContext`newp], 
               Increment[$CellContext`act], 
               AddTo[$CellContext`ksum, 
                Part[$CellContext`birates, 
                 
                 Part[$CellContext`actions, $CellContext`act + 
                  1]]]]; {$CellContext`new1, $CellContext`new2} = 
              Part[$CellContext`bireactions, 
                Part[$CellContext`actions, $CellContext`act], {3, 4}]; 
             If[RandomReal[] < $CellContext`ktot/$CellContext`kmax, 
               Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k] = $CellContext`new1; 
               Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk] = \
$CellContext`new2]]; Null]; Null]; Null]; $CellContext`S]], Evaluate, 
   LibraryFunction[
   "/Users/winfree/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/EriksMBlame2018-26744/compiledFunction3.dylib", 
    "compiledFunction3", {{Integer, 3, "Constant"}, {
     Integer, 2, "Constant"}, {Real, 1, "Constant"}, {
     Integer, 2, "Constant"}, {Real, 1, "Constant"}, {Real, 0, "Constant"}, {
     Real, 0, "Constant"}}, {Integer, 3}]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{3.829315238201021*^9, 3.829315405638453*^9, 
  3.829315448460225*^9, 3.829316660817391*^9, 3.829350932442009*^9, 
  3.8295036575803003`*^9, 3.8296978317483377`*^9, 3.8319994615329723`*^9, 
  3.8333278332599173`*^9, 3.846111418418737*^9, 3.8461162381259613`*^9, 
  3.856803579628306*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"97d24aec-c757-4514-90df-d787d2f937b8"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PreprocessFastSurfaceCRN", "[", 
    RowBox[{"crn_", ",", "space_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "species", ",", "species2index", ",", "index2species", ",", "kmax", ",",
        "\[IndentingNewLine]", "unirules", ",", "birules", ",", "bireactions",
        ",", "birates", ",", "unireactions", ",", "unirates"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"species", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"SpeciesInRxnsys", "[", "crn", "]"}], ",", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", "space", "]"}], "]"}], ",", 
           RowBox[{"SpeciesInRxnsys", "[", "crn", "]"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"species2index", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"species", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "species", "]"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"index2species", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "species", "]"}], "]"}], ",", "species"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"birules", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"crn", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{"a_", "+", "b_"}], ",", 
               RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{"2", "a_"}], ",", 
               RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{"a_", "+", "b_"}], ",", 
               RowBox[{"2", "c_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"c", ",", "c", ",", "k"}], "}"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{"2", "a_"}], ",", 
               RowBox[{"2", "c_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"c", ",", "c", ",", "k"}], "}"}]}], ")"}]}]}], 
           "}"}]}], ",", "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"bireactions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "/.", 
            "species2index"}]}], "}"}], "&"}], "/@", "birules"}]}], ";", 
      RowBox[{"birates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}], "/@", "birules"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"unirules", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"crn", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{"_Times", ",", "___"}], "]"}], "\[Rule]", "None"}], ",", 
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{"_Plus", ",", "___"}], "]"}], "\[Rule]", "None"}], ",", 
            
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{"a_", ",", "b_", ",", "k_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "a", "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"b", ",", "k"}], "}"}]}], ")"}]}]}], "}"}]}], ",", 
         "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"unireactions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "/.", "species2index"}],
            ",", 
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#", "]"}], "]"}], "/.", 
            "species2index"}]}], "}"}], "&"}], "/@", "unirules"}]}], ";", 
      RowBox[{"unirates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}], "/@", "unirules"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"kmax", "=", 
       RowBox[{"Max", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"Last", "/@", 
              RowBox[{"Last", "/@", "#"}]}], "]"}], "&"}], "/@", 
           RowBox[{"GatherBy", "[", 
            RowBox[{"unirules", ",", "First"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", 
             RowBox[{"Last", "/@", 
              RowBox[{"Last", "/@", "#"}]}], "]"}], "&"}], "/@", 
           RowBox[{"GatherBy", "[", 
            RowBox[{"birules", ",", "First"}], "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"FastSurfaceCRN", "[", 
       RowBox[{
       "unireactions", ",", "unirates", ",", "bireactions", ",", "birates", 
        ",", "kmax", ",", "index2species", ",", "species2index"}], "]"}]}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Convert2FastSpace", "[", 
   RowBox[{"space_", ",", "fastcrn_"}], "]"}], ":=", 
  RowBox[{"space", "/.", 
   RowBox[{"fastcrn", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RevertFast2Space", "[", 
   RowBox[{"fspace_", ",", "fastcrn_"}], "]"}], ":=", 
  RowBox[{"fspace", "/.", 
   RowBox[{"fastcrn", "[", 
    RowBox[{"[", 
     RowBox[{"-", "2"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Convert2FastColoring", "[", 
   RowBox[{"coloring_", ",", "fastcrn_"}], "]"}], ":=", 
  RowBox[{"coloring", "/.", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Rule", "[", 
      RowBox[{"s_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Rule", "[", 
      RowBox[{
       RowBox[{"Convert2FastSpace", "[", 
        RowBox[{"s", ",", "fastcrn"}], "]"}], ",", "c"}], "]"}]}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RunFastSurfaceCRN", "[", 
   RowBox[{"fastcrn_", ",", "fspace_", ",", "dt_"}], "]"}], ":=", 
  RowBox[{"EngineFastSurfaceCRN", "@@", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "fspace", "}"}], ",", 
     RowBox[{"Drop", "[", 
      RowBox[{
       RowBox[{"List", "@@", "fastcrn"}], ",", 
       RowBox[{"-", "2"}]}], "]"}], ",", 
     RowBox[{"{", "dt", "}"}]}], "]"}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8274513485122147`*^9, 3.827451395952838*^9}, {
   3.827451700344174*^9, 3.827452054169599*^9}, {3.827452097987815*^9, 
   3.8274522896352386`*^9}, {3.8274523424724283`*^9, 3.827452483439533*^9}, {
   3.827452999912855*^9, 3.827453061682334*^9}, 3.827453336321184*^9, {
   3.82745408866516*^9, 3.827454106812829*^9}, {3.8274541467466993`*^9, 
   3.827454244423703*^9}, {3.827454574720418*^9, 3.827454581446801*^9}, {
   3.829313650554076*^9, 3.829313671529771*^9}, {3.8293137103569403`*^9, 
   3.829313757496499*^9}, {3.8293137922592773`*^9, 3.829313806960951*^9}, {
   3.829350847844095*^9, 3.829350848238134*^9}, {3.8293509286415586`*^9, 
   3.829350929088077*^9}, {3.8293518674500093`*^9, 3.829351888415122*^9}, {
   3.829351993014214*^9, 3.829351995937648*^9}, {3.829429264687989*^9, 
   3.829429294482369*^9}, {3.83021804071317*^9, 3.830218044661067*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"005c54bf-848c-4f84-aca3-0035ceae2189"],

Cell[TextData[{
 "How to use the fast surface CRN simulator (compiled, but still using the \
basic slow algorithm):\n\nThe main issue is that compiled code is most \
efficient with numeric arrays, so the symbolic nature of the original \
simulator requires conversion to and from an integer representation.  \
Basically, each species that appears in a reaction or in a given initial \
state (such as inert species) is given a number, starting at 1.   Reactions \
are rewritten and stored in arrays, along with interconversion information, \
within a ",
 StyleBox["FastSurfaceCRN", "Code"],
 " object.  Convenience functions for doing the conversion are given.  Care \
must still be taken, e.g. to convert 2D surface CRN states into 3D surface \
CRN states, and to take them back to 2D for ",
 StyleBox["ArrayPlot", "Code"],
 ", since we went ahead with that generalization for the fast simulator."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvWIVx4fnFW8cDzh++wiifXT8voHoMypFYJpvzqp/
QpVvHB1u7WISBtJiM/aogug5XWmaILrq0ppsEL1U8W8OiE5oeaxmAaRFe89q
gmit7Xuv2gHp9L7H10G0zemPU/OB9JLL6tNB9AGmmJbL7W8cZ37y7QDRDVo1
JleB9CxjLlMQLZJ3yQdEC23Y4Aei77VNPHwdSGvfWXEMRCfdWyPC1/HG8eW/
7Uogmo01Rx1EP9rEYQ6in8zTSgPRC1n000H01ksbs0F0zulNBSBax3V3J4he
9jqsG0T/crWdCKLFWk/PANFNX3mWgGitf+dWgmgAhlWc+g==
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"96df9646-e852-4be5-8171-5f5dafd10526"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fastDLAcrn", "=", 
   RowBox[{"PreprocessFastSurfaceCRN", "[", 
    RowBox[{"DLAcrn", ",", 
     RowBox[{"{", "init2D", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fspace", "=", 
   RowBox[{"Convert2FastSpace", "[", 
    RowBox[{
     RowBox[{"{", "init2D", "}"}], ",", "fastDLAcrn"}], "]"}]}], ";", " ", 
  RowBox[{"ftime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fcoloring", "=", 
   RowBox[{"Convert2FastColoring", "[", 
    RowBox[{"coloring2D", ",", "fastDLAcrn"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"First", "[", "fspace", "]"}], ",", 
    RowBox[{"ColorRules", "\[Rule]", "fcoloring"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "ftime"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQPbGAq6ui6Y3jtyMHwfQp/+nTKoG00U73OSB6iXP/
BRDNt/Y7mJ5S9XyqZ8sbxz6h2Bkg2ofr0TwQPWXmtvkgWsbwxjoQzfRAawOI
5k8oUPUC0kbH6tVAdNecvfogekblRVMQ/fbRJEsQHfVDygZEn5n62wtEH/nA
7Q2iLx1+VgOi9y35CKY/GAg3g2ixi8rtIFqlqj7hIJDOu8ySCKJPsD6Zd739
jWNA4JbFIHr6Vd2NIFp8guZWEC12tofrPpAua8vlAdFC3ZNtQPSdDXPBtDlP
huULIL1UuBxMs7XN7OXreON44MiJfhDdlzVjLYg+s0h7HYgGAGuXp4o=
  "],
 CellLabel->
  "In[190]:=",ExpressionUUID->"c783f518-cc0f-460f-afde-1e0d45d10f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fspace", "=", 
        RowBox[{"RunFastSurfaceCRN", "[", 
         RowBox[{"fastDLAcrn", ",", "fspace", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"ftime", "+=", "dt"}]}], ",", "1000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}},
 CellLabel->
  "In[194]:=",ExpressionUUID->"09edd5c4-fe1c-4a58-b78e-13f4ddfb6849"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunFastSurfaceCRN", "[", 
    RowBox[{"fastDLAcrn", ",", "fspace", ",", "100"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8274568443617573`*^9, 3.8274568968917418`*^9}, {
  3.82931710156116*^9, 3.829317117244265*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"52055511-6668-4faf-aae3-ba7c743f21f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11.382939`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.827456899237506*^9, 3.82752337585714*^9, {3.8276895482096443`*^9, 
   3.827689555423439*^9}, 3.827698448780013*^9, 3.8276989466503687`*^9, 
   3.829317128820662*^9, 3.8294296917248383`*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"3d5a6659-c6f7-46a4-bac5-fe3ecf171a80"]
}, Open  ]],

Cell[TextData[{
 "Displaying 3D spaces benefits from a little more grunge work, mainly \
because one usually wants one (or more) species to be entirely transparent.   \
",
 StyleBox["ArrayPlot3D", "Code"],
 " treats the integer 0 as empty, however it feels more consistent to  use ",
 StyleBox["Empty", "Code"],
 " in color rules, so that\[CloseCurlyQuote]s what we do here.  Also note \
that semi-transparent cubes can also be used in addition to ",
 StyleBox["Empty", "Code"],
 " and colors, e.g. ",
 StyleBox["Opacity[0.5,Cyan]", "Code"],
 ".   We also put 8 tiny dots in the corners, so Mathematica doesn\
\[CloseCurlyQuote]t automatically zoom in on just the non-empty stuff."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8215741333315496`*^9, 
   3.821574165839142*^9}, {3.821574445893565*^9, 3.82157447520442*^9}, {
   3.821575005400693*^9, 3.821575015910357*^9}, {3.821650231109909*^9, 
   3.821650254423472*^9}, {3.821663917928609*^9, 3.821663935111133*^9}, {
   3.821763759556059*^9, 3.821763769244585*^9}, {3.8293084508753357`*^9, 
   3.829308482435864*^9}, {3.829311907880188*^9, 3.829311912318799*^9}, {
   3.8293121025759373`*^9, 3.829312117521493*^9}, {3.8293171485477133`*^9, 
   3.829317173276876*^9}, {3.8294283894021463`*^9, 3.829428501749867*^9}, {
   3.829428539375613*^9, 3.8294286642718363`*^9}, {3.829429041331896*^9, 
   3.829429049469315*^9}, {3.829429085556971*^9, 3.829429125587332*^9}, {
   3.829429325852194*^9, 3.8294293387162657`*^9}, {3.829429385914792*^9, 
   3.829429446359996*^9}, {3.829429536404969*^9, 3.829429582468526*^9}, 
   3.829429759010611*^9, {3.829430291542243*^9, 3.82943029280435*^9}, {
   3.829430428982582*^9, 3.829430443790697*^9}, {3.8294304838443327`*^9, 
   3.82943053361014*^9}, {3.829430569313154*^9, 3.829430645554965*^9}, {
   3.829430706500722*^9, 3.829430726000553*^9}, {3.8294308012958*^9, 
   3.829430821416123*^9}, {3.829430890569911*^9, 3.829430919232027*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"1b85ef5e-269f-4043-a6cc-de1ee4eeac06"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowSurface3D", "[", 
   RowBox[{"space_", ",", "colorrules_", ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"symbols", ",", "map", ",", "mappedcolorrules", ",", "empty"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"empty", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"colorrules", ",", 
        RowBox[{
         RowBox[{"r_", "[", 
          RowBox[{"s_", ",", "Empty"}], "]"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"s", "\[Rule]", "0"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"symbols", "=", 
      RowBox[{"Keys", "[", "colorrules", "]"}]}], ";", 
     RowBox[{"map", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{"Rule", ",", 
        RowBox[{"{", 
         RowBox[{"symbols", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "symbols", "]"}], "]"}]}], "}"}]}], "]"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"mappedcolorrules", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"First", "[", "#", "]"}], "/.", "map"}], ")"}], "\[Rule]", 
          RowBox[{"Last", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
       "colorrules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"Point", "/@", 
           RowBox[{"Tuples", "[", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
               RowBox[{"Reverse", "[", 
                RowBox[{"Dimensions", "[", "space", "]"}], "]"}]}], "}"}], 
             "]"}], "]"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ArrayPlot3D", "[", 
        RowBox[{
         RowBox[{"space", "/.", 
          RowBox[{"(", 
           RowBox[{"empty", "~", "Join", "~", "map"}], ")"}]}], ",", 
         RowBox[{"ColorRules", "->", "mappedcolorrules"}]}], "]"}], ",", 
       "opts"}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.823128391518244*^9, 3.823128482674891*^9}, {
   3.823128765658414*^9, 3.8231288942711477`*^9}, {3.8231290605678062`*^9, 
   3.8231290637210903`*^9}, {3.823129569793457*^9, 3.823129636643098*^9}, {
   3.8231302991136103`*^9, 3.8231303040517282`*^9}, {3.823130377135309*^9, 
   3.823130382499188*^9}, {3.823130484398272*^9, 3.8231306016633368`*^9}, {
   3.823130647525917*^9, 3.823130655129342*^9}, {3.823130984833259*^9, 
   3.823131064131222*^9}, {3.823131169342651*^9, 3.823131171389268*^9}, {
   3.823131768104731*^9, 3.823131771972237*^9}, {3.823132292875865*^9, 
   3.8231323011341476`*^9}, {3.8231323331071863`*^9, 3.823132364958527*^9}, 
   3.8232260664274282`*^9, {3.826499190466887*^9, 3.826499215106249*^9}, {
   3.8264994886717987`*^9, 3.8264995901728487`*^9}, {3.826500071525817*^9, 
   3.826500095834996*^9}, {3.8265001434699163`*^9, 3.826500160704048*^9}, {
   3.826500210600709*^9, 3.8265003324227467`*^9}, {3.826500388101871*^9, 
   3.826500416506468*^9}, {3.826500501690151*^9, 3.826500507461443*^9}, 
   3.826500543047386*^9, {3.829332560601653*^9, 3.829332561416628*^9}, {
   3.829334663561602*^9, 3.829334714493935*^9}, {3.8293349329734707`*^9, 
   3.829334939581395*^9}, 3.829336799572583*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"3fc17b9e-6881-4e1c-b83a-0f1f9249fbe5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"init3D", "=", 
   RowBox[{"ArrayPad", "[", 
    RowBox[{
     RowBox[{"ArrayPad", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"{", "F", "}"}], "}"}], "}"}], ",", "20", ",", "W"}], "]"}], 
     ",", "1", ",", "G"}], "]"}]}], ";", 
  RowBox[{"space3D", "=", "init3D"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coloring3D", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"F", "\[Rule]", "Cyan"}], ",", 
      RowBox[{"G", "\[Rule]", "Empty"}], ",", 
      RowBox[{"P", "\[Rule]", "Gray"}], ",", " ", 
      RowBox[{"W", "\[Rule]", "Empty"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "there", " ", "is", " ", "a", " ", "boundary", " ", "wall", " ", "of", 
     " ", "G"}], ",", " ", 
    RowBox[{"but", " ", 
     RowBox[{"let", "'"}], "s", " ", "not", " ", "show", " ", "it"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fspace3D", "=", 
   RowBox[{"Convert2FastSpace", "[", 
    RowBox[{"init3D", ",", "fastDLAcrn"}], "]"}]}], ";", " ", 
  RowBox[{"ftime3D", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fcoloring3D", "=", 
   RowBox[{"Convert2FastColoring", "[", 
    RowBox[{"coloring3D", ",", "fastDLAcrn"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.829332101610833*^9, 3.82933210189144*^9}, {
   3.829332167947441*^9, 3.829332170329995*^9}, {3.829332225416141*^9, 
   3.829332247730349*^9}, {3.829332289255241*^9, 3.829332303393895*^9}, {
   3.829332405110834*^9, 3.829332430055441*^9}, {3.829332477098358*^9, 
   3.829332521871564*^9}, {3.829332597674273*^9, 3.829332607085257*^9}, {
   3.829332671034099*^9, 3.829332735269403*^9}, 3.829332822784195*^9, {
   3.8293349452865667`*^9, 3.82933494594584*^9}, {3.8294308340063553`*^9, 
   3.829430874610867*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"5585cc10-fe8d-4e77-b447-c2440b214c72"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ShowSurface3D", "[", 
   RowBox[{"fspace3D", ",", "fcoloring3D", ",", 
    RowBox[{"PlotLabel", "\[Rule]", "ftime3D"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.827699446918768*^9, {3.829332622584806*^9, 3.8293326440895643`*^9}, 
   3.829332677726213*^9},
 CellLabel->
  "In[199]:=",ExpressionUUID->"68acdfcb-204b-4ecc-b110-76b0258a0bf5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fspace3D", "=", 
        RowBox[{"RunFastSurfaceCRN", "[", 
         RowBox[{"fastDLAcrn", ",", "fspace3D", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"ftime3D", "+=", "dt"}]}], ",", "1000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.829334976265684*^9, 3.829334978377679*^9}, {
  3.829335623972726*^9, 3.829335625904748*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"6e881414-0ea8-458c-b2df-e4787da2a859"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowSurface3D", "[", 
   RowBox[{"fspace3D", ",", 
    RowBox[{"Convert2FastColoring", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F", "\[Rule]", "Cyan"}], ",", 
        RowBox[{"G", "\[Rule]", "Empty"}], ",", 
        RowBox[{"P", "\[Rule]", "Empty"}], ",", " ", 
        RowBox[{"W", "\[Rule]", "Empty"}]}], "}"}], ",", "fastDLAcrn"}], 
     "]"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "ftime3D"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"show", " ", "only", " ", "the", " ", "frozen", " ", "stuff"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.829335610317235*^9, 3.829335619067177*^9}, {
  3.829335970279793*^9, 3.8293360081214037`*^9}, {3.829336043830188*^9, 
  3.829336111144815*^9}, {3.829430970023448*^9, 3.829430984087879*^9}, {
  3.829431374752166*^9, 3.829431417622098*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"6ad26e0a-c640-45da-ba6a-847d2063f1a1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunFastSurfaceCRN", "[", 
    RowBox[{"fastDLAcrn", ",", "fspace3D", ",", "10"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8294272082385406`*^9, 3.8294272201495256`*^9}},
 CellLabel->
  "In[177]:=",ExpressionUUID->"751e5f28-137c-4452-91c2-f51279dcd384"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"60.719902`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.829427292337596*^9},
 CellLabel->
  "Out[177]=",ExpressionUUID->"f99b527d-3d9e-4096-9ccc-61eeaa9bb9be"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["New code for the even faster surface CRN simulator", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.8293093013511972`*^9, 
  3.82930930344156*^9}, {3.82933681854252*^9, 3.8293368210888033`*^9}, {
  3.8293474947833233`*^9, 
  3.829347495623551*^9}},ExpressionUUID->"b253a218-76bf-458a-a7be-\
e82a67cc321a"],

Cell["\<\
Both simulators above take the basic strategy of choosing a site or pair of \
sites, and executing a reaction with probability appropriate to its rate \
constant -- that means if there are some fast reactions and some slow \
reactions, sites where slow reactions could occur will be tried bunches of \
times before being executed (because the trial rate is related to the fastest \
reaction rate).  Also, if some sites in the space can be active, but other \
sites are inactive, the simulator will nonetheless spend its time equally \
testing and retesting the inactive area.  This new simulator takes an \
entirely different strategy: keep a data structure up-to-date that gives the \
total propensity of possible reactions at each site and each pair of \
neighbors, all organized into a binary tree such that the next reaction can \
be chosen probabilistically by quickly traversing the tree.  From the user\
\[CloseCurlyQuote]s perspective, though, it looks pretty darn similar to the \
previous fast simulator, just faster.   The main thing to watch out for is \
that this new simulator uses a species vs species lookup table, which takes \
memory quadratic in the number of species (whereas only linear costs appear \
in the previous two simulators) and thus will be problematic for systems with \
many thousands of species.

Principles, in more detail:
1.  No rejection.  We won\[CloseCurlyQuote]t look at sites unless there is \
something to do there.
2.  Log-time site/pair selection.  By tracking the total propensity for \
localized reactions and storing in a binary tree with hierarchical sums, we \
select a site in log(d n m) time.
\tlet 2^K > 7 d n m.  we allocate an array of length 2^(K+1).
\tunimolecular reactions at (i,j,k) have ID 2^K + (i-1)*n*m + (j-1)*m + \
(k-1).
\tbimolecular reactions involving (i,j,k) and neighbor #b have ID 2^K + \
(i-1)*n*m + (j-1)*m + (k-1) + b*d*n*m.
\trate[1] is the grant total propensity, and rate[id] := \
rate[2*id]+rate[2*id+1] for id < 2^K.
3.  Fast reaction selection.  Comes at the cost of burning memory (1000 \
species costs 8 MB, grows as S^2, for S species and R reactions).
\tunimolecular and bimolecular reactions are kept in arrays as before, but \
now they are sorted by reactants, and additionally we have uniindex[s] and \
biindex[s1,s2] that point into the reaction arrays or are 0.
\t\tsince the reaction arrays are sorted, if there are multiple reactions \
possible for given reactants, they are all together and can quickly be scanned.
4.  Fast data structure maintenance. After each changed site, the site and \
its 6 neighbors need to have their rates recomputed and propagated up the \
tree. 
\tto compute the local rate when an ID gets updated, we use uniindex[s] and \
biindex[s1,s2] to quickly tallly all possible reactions.
\tto maintain consistency of the hierarchical rates, whenever an ID gets \
updated, we iterate:  id=(id>>1), update rate[id], until id==1.
\t\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwdzkFIk3EAhvGxQ1rqkmk5w0aK1tTvkCvRQsSlGIl6GEaHxExtohtNxEBl
0IgtzcowlTYd7uDUMUK3iSii6ytBwTVrjjnQKerECQ51WjtIuv7vDg+/65NY
JRW+YDIYDB4J6g3hR95mn4AWBPywmCoNwJ/JjSFZGsM5u8UnyFudZsYQr6pm
UqCmQ5QKW5e/iuFQ4pkEVio8N7OJVz7aUmHa5Kwzl1jb6XHBHKu/V0rUOW59
gTSzXOFo8wnUxyXtUJ4mu+sk9t25lAljXy4XQ7bRWAo33nbNuYjpbv08TOC0
zmwRGz4kz8L7MQXfIaUJOuADtd0NmynZPgzuX/8D2WZeAGoHqFMofLV4YZv4
7+FwBDy+1hYPyxvXu6G8SWSAA3vGUdgQFI/BQsvuBCxQhn+DU68vcjzEpYqF
G3D6N4sPa25nZ0EZ7698lxg3X98DPWpOH4wsUoxDWZH1EIpoZ8hD1spjL9Hy
a+85PBDN1ULuj0gJ9Fb73kD2ibUD6szvP0HTM9tn2MmdUMGyYXvIKfGWFg5q
13Qwyp737pyojBsJKRnZVF1uJ//8un4YTQtNcOfe03HIi6AmYZKbvwAzMqU2
WFaVuwTzn3Ad0OKqXIWnZ/QOVIVt++GmMkEfTWwyPzLB/zBPZPE=
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"72a8b4f1-39d1-4bc0-b4fc-a7ca83a7944d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PreprocessFasterSurfaceCRN", "[", 
    RowBox[{"crn_", ",", "space_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"scrn", "=", 
        RowBox[{"Sort", "[", "crn", "]"}]}], ",", "species", ",", 
       "species2index", ",", "index2species", ",", "\[IndentingNewLine]", 
       "unirules", ",", "birules", ",", "bireactions", ",", "birates", ",", 
       "biindex", ",", "unireactions", ",", "unirates", ",", "uniindex"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"species", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"SpeciesInRxnsys", "[", "scrn", "]"}], ",", 
         RowBox[{"Complement", "[", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", "space", "]"}], "]"}], ",", 
           RowBox[{"SpeciesInRxnsys", "[", "scrn", "]"}]}], "]"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"species2index", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{"species", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "species", "]"}], "]"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"index2species", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Rule", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "species", "]"}], "]"}], ",", "species"}], 
          "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"birules", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"scrn", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{"a_", "+", "b_"}], ",", 
               RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{"2", "a_"}], ",", 
               RowBox[{"c_", "+", "d_"}], ",", "k_"}], "]"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"c", ",", "d", ",", "k"}], "}"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{"a_", "+", "b_"}], ",", 
               RowBox[{"2", "c_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "b"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"c", ",", "c", ",", "k"}], "}"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{
               RowBox[{"2", "a_"}], ",", 
               RowBox[{"2", "c_"}], ",", "k_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", ",", "a"}], "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"c", ",", "c", ",", "k"}], "}"}]}], ")"}]}]}], 
           "}"}]}], ",", "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"bireactions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}], "/.", "species2index"}], 
           ",", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}], "/.", 
            "species2index"}]}], "}"}], "&"}], "/@", "birules"}]}], ";", 
      RowBox[{"birates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}], "/@", "birules"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"biindex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "species", "]"}], ",", 
         RowBox[{"Length", "[", "species", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"biindex", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"bireactions", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"bireactions", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], "]"}], "=", 
         "i"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "bireactions", "]"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"unirules", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"scrn", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{"_Times", ",", "___"}], "]"}], "\[Rule]", "None"}], ",", 
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{"_Plus", ",", "___"}], "]"}], "\[Rule]", "None"}], ",", 
            
            RowBox[{
             RowBox[{"rxn", "[", 
              RowBox[{"a_", ",", "b_", ",", "k_"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "a", "}"}], "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"b", ",", "k"}], "}"}]}], ")"}]}]}], "}"}]}], ",", 
         "_Rule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"unireactions", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"First", "[", "#", "]"}], "]"}], "/.", "species2index"}],
            ",", 
           RowBox[{
            RowBox[{"First", "[", 
             RowBox[{"Last", "[", "#", "]"}], "]"}], "/.", 
            "species2index"}]}], "}"}], "&"}], "/@", "unirules"}]}], ";", 
      RowBox[{"unirates", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"Last", "[", "#", "]"}], "]"}], "&"}], "/@", "unirules"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"uniindex", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"Length", "[", "species", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"uniindex", "[", 
          RowBox[{"[", 
           RowBox[{"unireactions", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], "=", "i"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "unireactions", "]"}], ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"FasterSurfaceCRN", "[", 
       RowBox[{
        RowBox[{"unireactions", "~", "Join", "~", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ",", "unirates", ",", 
        "uniindex", ",", 
        RowBox[{"bireactions", "~", "Join", "~", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], "}"}]}], ",", 
        "birates", ",", "biindex", ",", "index2species", ",", 
        "species2index"}], "]"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Convert2FasterSpace", "[", 
   RowBox[{"space_", ",", "fastercrn_"}], "]"}], ":=", 
  RowBox[{"space", "/.", 
   RowBox[{"fastercrn", "[", 
    RowBox[{"[", 
     RowBox[{"-", "1"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RevertFaster2Space", "[", 
   RowBox[{"fspace_", ",", "fastercrn_"}], "]"}], ":=", 
  RowBox[{"fspace", "/.", 
   RowBox[{"fastercrn", "[", 
    RowBox[{"[", 
     RowBox[{"-", "2"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Convert2FasterColoring", "[", 
    RowBox[{"coloring_", ",", "fastercrn_"}], "]"}], ":=", 
   RowBox[{"coloring", "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Rule", "[", 
       RowBox[{"s_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"Rule", "[", 
       RowBox[{
        RowBox[{"Convert2FastSpace", "[", 
         RowBox[{"s", ",", "fastercrn"}], "]"}], ",", "c"}], "]"}]}], 
     ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"ignore", " ", "the", " ", "time", " ", "stamp"}], ",", " ", 
    RowBox[{"event", " ", "count"}], ",", " ", 
    RowBox[{"and", " ", "halted", " ", "indicator", " ", 
     RowBox[{"(", 
      RowBox[{"ArrayReshape", " ", "truncates", " ", "extra", " ", "info"}], 
      ")"}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RunFasterSurfaceCRN", "[", 
    RowBox[{"fastercrn_", ",", "fspace_", ",", "dt_"}], "]"}], ":=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{"EngineFasterSurfaceCRN", "@@", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "fspace", "}"}], ",", 
        RowBox[{"Drop", "[", 
         RowBox[{
          RowBox[{"List", "@@", "fastercrn"}], ",", 
          RowBox[{"-", "2"}]}], "]"}], ",", 
        RowBox[{"{", "dt", "}"}]}], "]"}]}], ",", 
     RowBox[{"Dimensions", "[", "fspace", "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"report", " ", "the", " ", "time", " ", "stamp"}], ",", " ", 
    RowBox[{"event", " ", "count"}], ",", " ", 
    RowBox[{"and", " ", "halted", " ", "indicator"}], ",", " ", 
    RowBox[{
    "along", " ", "with", " ", "the", " ", "final", " ", "space", " ", 
     "configuration"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InfoRunFasterSurfaceCRN", "[", 
   RowBox[{"fastercrn_", ",", "fspace_", ",", "dt_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "info", ",", "tfinal", ",", " ", "eventcount", ",", "haltedq", ",", 
      "digs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"info", "=", 
      RowBox[{"EngineFasterSurfaceCRN", "@@", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "fspace", "}"}], ",", 
         RowBox[{"Drop", "[", 
          RowBox[{
           RowBox[{"List", "@@", "fastercrn"}], ",", 
           RowBox[{"-", "2"}]}], "]"}], ",", 
         RowBox[{"{", "dt", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"haltedq", "=", 
      RowBox[{"info", "[", 
       RowBox[{"[", 
        RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eventcount", "=", 
      RowBox[{"info", "[", 
       RowBox[{"[", 
        RowBox[{"-", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"digs", "=", 
      RowBox[{"info", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "22"}], ",", 
          RowBox[{"-", "3"}]}], "}"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tfinal", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{"digs", " ", "*", " ", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"(", 
              RowBox[{"-", "i"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "digs", "]"}], "-", "1"}]}], "}"}]}], 
           "]"}]}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tfinal", ",", "eventcount", ",", "haltedq"}], "}"}], ",", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"info", ",", 
         RowBox[{"Dimensions", "[", "fspace", "]"}]}], "]"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8274513485122147`*^9, 3.827451395952838*^9}, {
   3.827451700344174*^9, 3.827452054169599*^9}, {3.827452097987815*^9, 
   3.8274522896352386`*^9}, {3.8274523424724283`*^9, 3.827452483439533*^9}, {
   3.827452999912855*^9, 3.827453061682334*^9}, 3.827453336321184*^9, {
   3.82745408866516*^9, 3.827454106812829*^9}, {3.8274541467466993`*^9, 
   3.827454244423703*^9}, {3.827454574720418*^9, 3.827454581446801*^9}, {
   3.829313650554076*^9, 3.829313671529771*^9}, {3.8293137103569403`*^9, 
   3.829313757496499*^9}, {3.8293137922592773`*^9, 3.829313806960951*^9}, {
   3.829350847844095*^9, 3.829350848238134*^9}, {3.8293509286415586`*^9, 
   3.829350929088077*^9}, {3.829350974376589*^9, 3.829351057321336*^9}, {
   3.829351288878388*^9, 3.82935130093359*^9}, {3.829351340446766*^9, 
   3.829351357156369*^9}, {3.8293513933611917`*^9, 3.829351409407571*^9}, {
   3.829351450309284*^9, 3.8293515474887466`*^9}, {3.829351592938422*^9, 
   3.829351651693935*^9}, {3.829351957945962*^9, 3.8293519652950897`*^9}, {
   3.829352057256365*^9, 3.829352165363657*^9}, {3.829352469396199*^9, 
   3.829352471766683*^9}, {3.829353569459014*^9, 3.82935359151077*^9}, {
   3.829398022649732*^9, 3.829398035821377*^9}, {3.8294322236616087`*^9, 
   3.829432230219495*^9}, {3.829520043199326*^9, 3.829520044790064*^9}, {
   3.82952009520619*^9, 3.829520095935566*^9}, {3.829765276002825*^9, 
   3.82976538209475*^9}, {3.8297657454898252`*^9, 3.8297658361590347`*^9}, {
   3.829765868968651*^9, 3.829765915988202*^9}, {3.82976597496924*^9, 
   3.829766125249482*^9}, {3.829769893688188*^9, 3.8297699664140863`*^9}, {
   3.8297700430055304`*^9, 3.8297700471936693`*^9}, {3.83332863825578*^9, 
   3.833328658666793*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"60cb164e-170a-4036-b447-068c85182ed8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"EngineNeighbors", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"+", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"+", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"+", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"EngineNeighborNeighbor", "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "6", ",", "5"}], "}"}]}],
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "if", " ", "the", " ", "code", " ", "below", " ", "looks", " ", 
       "unnecessarily", " ", "repetitive"}], "..."}], " ", "yes"}], ",", " ", 
    
    RowBox[{
     RowBox[{
      RowBox[{"it", " ", "is"}], "..."}], " ", "I", " ", 
     RowBox[{"don", "'"}], "t", " ", "know", " ", "how", " ", "to", " ", 
     "get", " ", "subfunctions", " ", "to", " ", "play", " ", "nicely", " ", 
     "with", " ", 
     RowBox[{"Mathematica", "'"}], "s", " ", "compiler"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"remove", " ", "the", " ", "debugging", " ", "test"}], "-", 
    RowBox[{"print", " ", "statements", " ", "after", " ", 
     RowBox[{"it", "'"}], "s", " ", "been", " ", "tried", " ", "out", " ", 
     "on", " ", "enough", " ", "examples"}]}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"EngineFasterSurfaceCRN", "=", " ", 
  RowBox[{"Compile", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"space", ",", "_Integer", ",", "3"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"unireactions", ",", "_Integer", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"unirates", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"uniindex", ",", "_Integer", ",", "1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"bireactions", ",", "_Integer", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"birates", ",", "_Real", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"biindex", ",", "_Integer", ",", "2"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"tmax", ",", "_Real"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", "space", "]"}]}], ",", 
        RowBox[{"n", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", "space", "]"}], "]"}]}], ",", 
        RowBox[{"m", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"First", "[", 
           RowBox[{"First", "[", "space", "]"}], "]"}], "]"}]}], ",", "d1", 
        ",", "d2", ",", "n1", ",", "n2", ",", "m1", ",", "m2", ",", 
        RowBox[{"S", "=", "space"}], ",", "R", ",", "id", ",", "idd", ",", 
        "K", ",", "\[IndentingNewLine]", "nb", ",", "nbnb", ",", "i", ",", 
        "j", ",", "k", ",", "i2", ",", "j2", ",", "k2", ",", "di", ",", "dj", 
        ",", "dk", ",", "r", ",", 
        RowBox[{"s1", "=", "1"}], ",", 
        RowBox[{"s2", "=", "1"}], ",", "snb", ",", "new1", ",", "new2", ",", 
        "ksum", ",", "newp", ",", 
        RowBox[{"t", "=", "0.0"}], ",", "dt", ",", 
        RowBox[{"events", "=", "0"}], ",", "haltedq", ",", "digit", ",", 
        "digits", ",", "residue"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"K", "=", 
        RowBox[{"Ceiling", "[", 
         RowBox[{"Log", "[", 
          RowBox[{"2", ",", 
           RowBox[{"1", "+", 
            RowBox[{"7", " ", "d", " ", "n", " ", "m"}]}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"R", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0.0", ",", 
          RowBox[{"{", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"K", "+", "1"}], ")"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "1"}], ":", " ", 
         RowBox[{
         "build", " ", "the", " ", "rate", " ", "tree", " ", "R", " ", "as", 
          " ", "quickly", " ", "as", " ", 
          RowBox[{"possible", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "because", " ", "Compile", " ", "only", " ", "lets", " ", "us", " ", 
          "output", " ", "one", " ", "array"}], ",", " ", 
         RowBox[{
         "Mathematica", " ", "makes", " ", "it", " ", "awkward", " ", "for", 
          " ", "us", " ", "to", " ", "return", " ", "the", " ", "updated", 
          " ", "rate", " ", 
          RowBox[{"tree", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "if", " ", "this", " ", "requires", " ", "just", " ", "2", " ", 
          "times", " ", "the", " ", "number", " ", "of", " ", "sites", " ", 
          "updates"}], ",", " ", 
         RowBox[{
         "it", " ", "will", " ", "still", " ", "be", " ", "faster", " ", 
          "than", " ", "a", " ", "simulation", " ", "that", " ", "touches", 
          " ", "every", " ", 
          RowBox[{"site", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"r", "=", 
           RowBox[{"uniindex", "[", 
            RowBox[{"[", 
             RowBox[{"S", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "]"}], 
            "]"}]}], ";", 
          RowBox[{"id", "=", 
           RowBox[{
            RowBox[{"2", "^", "K"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
            RowBox[{"(", 
             RowBox[{"k", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"r", ">", "0"}], "&&", 
             RowBox[{
              RowBox[{"unireactions", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "1"}], "]"}], "]"}], "\[Equal]", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", "id", "]"}], "]"}], "+=", 
              RowBox[{"unirates", "[", 
               RowBox[{"[", "r", "]"}], "]"}]}], ";", 
             RowBox[{"r", "++"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "d"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "m"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
           RowBox[{"EngineNeighbors", "[", 
            RowBox[{"[", "nb", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"d1", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"1", "-", "di"}]}], "]"}]}], ";", 
          RowBox[{"d2", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"d", ",", 
             RowBox[{"d", "-", "di"}]}], "]"}]}], ";", 
          RowBox[{"n1", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"1", "-", "dj"}]}], "]"}]}], ";", 
          RowBox[{"n2", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"n", ",", 
             RowBox[{"n", "-", "dj"}]}], "]"}]}], ";", 
          RowBox[{"m1", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"1", "-", "dk"}]}], "]"}]}], ";", 
          RowBox[{"m2", "=", 
           RowBox[{"Min", "[", 
            RowBox[{"m", ",", 
             RowBox[{"m", "-", "dk"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"r", "=", 
              RowBox[{"biindex", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"S", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], "]"}], 
               "]"}]}], ";", 
             RowBox[{"id", "=", 
              RowBox[{
               RowBox[{"2", "^", "K"}], "+", 
               RowBox[{"nb", "*", "d", "*", "n", "*", "m"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
               RowBox[{"(", 
                RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"r", ">", "0"}], "&&", 
                RowBox[{
                 RowBox[{"bireactions", "[", 
                  RowBox[{"[", 
                   RowBox[{"r", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], ",", 
                   RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], "}"}]}]}], 
               ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "+=", 
                 RowBox[{"birates", "[", 
                  RowBox[{"[", "r", "]"}], "]"}]}], ";", 
                RowBox[{"r", "++"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"{", 
             RowBox[{"i", ",", "d1", ",", "d2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "n1", ",", "n2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", "m1", ",", "m2"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "id", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{"2", "id"}], "]"}], "]"}], "+", 
           RowBox[{"R", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"id", ",", 
           RowBox[{
            RowBox[{"2", "^", "K"}], "-", "1"}], ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"step", " ", "2"}], ":", " ", 
         RowBox[{"run", " ", "the", " ", 
          RowBox[{"simulation", "!"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"t", "<", "tmax"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{"R", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ">", "0"}]}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"(*", " ", "when", " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"dt", "=", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"RandomReal", "[", "]"}], "]"}]}], "/", 
            RowBox[{"R", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"t", "+", "dt"}], "<", "tmax"}], ",", 
            RowBox[{
             RowBox[{"t", "+=", "dt"}], ";", 
             RowBox[{"events", "++"}]}], ",", 
            RowBox[{
             RowBox[{"t", "=", "tmax"}], ";", " ", 
             RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"don", "'"}], "t", " ", "execute", " ", "any", " ", 
            "event", " ", "past", " ", "tmax"}], " ", "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "what", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"id", "=", "1"}], ";", 
          RowBox[{"While", "[", 
           RowBox[{
            RowBox[{"id", "<", 
             RowBox[{"2", "^", "K"}]}], ",", 
            RowBox[{"id", "=", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"RandomReal", "[", "]"}], "*", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}]}], "<", 
                RowBox[{"R", "[", 
                 RowBox[{"[", 
                  RowBox[{"2", "id"}], "]"}], "]"}]}], ",", 
               RowBox[{"2", "id"}], ",", 
               RowBox[{
                RowBox[{"2", "id"}], "+", "1"}]}], "]"}]}]}], "]"}], ";", " ", 
          RowBox[{"idd", "=", "id"}], ";", "\[IndentingNewLine]", 
          RowBox[{"idd", "-=", 
           RowBox[{"2", "^", "K"}]}], ";", 
          RowBox[{"nb", "=", 
           RowBox[{"Quotient", "[", 
            RowBox[{"idd", ",", 
             RowBox[{"d", " ", "n", " ", "m"}]}], "]"}]}], ";", 
          RowBox[{"idd", "-=", 
           RowBox[{"nb", " ", "d", " ", "n", " ", "m"}]}], ";", " ", 
          RowBox[{"i", "=", 
           RowBox[{
            RowBox[{"Quotient", "[", 
             RowBox[{"idd", ",", 
              RowBox[{"n", " ", "m"}]}], "]"}], "+", "1"}]}], ";", 
          RowBox[{"idd", "-=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}]}], ";", " ", 
          RowBox[{"j", "=", 
           RowBox[{
            RowBox[{"Quotient", "[", 
             RowBox[{"idd", ",", "m"}], "]"}], "+", "1"}]}], ";", 
          RowBox[{"idd", "-=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"j", "-", "1"}], ")"}], "m"}]}], ";", 
          RowBox[{"k", "=", 
           RowBox[{"idd", "+", "1"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{
                RowBox[{"1", "\[LessEqual]", "i", "\[LessEqual]", "d"}], "&&", 
                RowBox[{"1", "\[LessEqual]", "j", "\[LessEqual]", "n"}], "&&", 
                RowBox[{"1", "\[LessEqual]", "k", "\[LessEqual]", "m"}]}], 
               "]"}], ",", 
              RowBox[{"Print", "[", "\"\<bad loc!\>\"", "]"}]}], "]"}], ";"}],
            "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"0", "\[LessEqual]", "nb", "\[LessEqual]", "6"}], 
               "]"}], ",", 
              RowBox[{"Print", "[", "\"\<bad neighbor!\>\"", "]"}]}], "]"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"location", " ", 
            RowBox[{"found", ".", "  ", "now"}], " ", "choose", " ", "the", 
            " ", "reaction", " ", "and", " ", "execute", " ", "the", " ", 
            "change", " ", "and", " ", "update", " ", "the", " ", "rate", " ", 
            RowBox[{"tree", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nb", "\[Equal]", "0"}], ",", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"-", " ", "unimolecular"}]}]}]}]}], " ", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"move", " ", "--"}], "--"}], "--"}], "--"}]}], 
              "-"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"s1", "=", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ";", " ", 
             RowBox[{"r", "=", 
              RowBox[{"uniindex", "[", 
               RowBox[{"[", "s1", "]"}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"r", "\[Equal]", "0"}], ",", 
                 RowBox[{"Print", "[", "\"\<unibad!\>\"", "]"}]}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"newp", "=", 
              RowBox[{
               RowBox[{"RandomReal", "[", "]"}], "*", 
               RowBox[{"R", "[", 
                RowBox[{"[", "id", "]"}], "]"}]}]}], ";", 
             RowBox[{"ksum", "=", 
              RowBox[{"unirates", "[", 
               RowBox[{"[", "r", "]"}], "]"}]}], ";", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"newp", ">", "ksum"}], "&&", 
                RowBox[{
                 RowBox[{"unireactions", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                 "\[Equal]", "s1"}]}], ",", 
               RowBox[{
                RowBox[{"ksum", "+=", 
                 RowBox[{"unirates", "[", 
                  RowBox[{"[", 
                   RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"new1", "=", 
              RowBox[{"unireactions", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", "2"}], "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
              "new1"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"update", " ", "rates", " ", "for", " ", "self"}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"r", "=", 
              RowBox[{"uniindex", "[", 
               RowBox[{"[", "new1", "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", "id", "]"}], "]"}], "=", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                RowBox[{"unirates", "[", 
                 RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"unireactions", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"r", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                "\[Equal]", "new1"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "+=", 
                 RowBox[{"unirates", "[", 
                  RowBox[{"[", 
                   RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"id", ">", "1"}], ",", 
               RowBox[{
                RowBox[{"id", "=", 
                 RowBox[{"Quotient", "[", 
                  RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "=", 
                 RowBox[{
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
              "]"}], ";", " ", 
             RowBox[{"(*", " ", 
              RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", " ", 
              RowBox[{"(*", " ", 
               RowBox[{
                RowBox[{
                "update", " ", "rates", " ", "for", " ", "bimolecular", " ", 
                 "neighbors"}], ",", " ", 
                RowBox[{"in", " ", "both", " ", "orientations"}]}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                 RowBox[{"EngineNeighbors", "[", 
                  RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                   RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                   RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"snb", "=", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"new1", ",", "snb"}], "]"}], "]"}]}], ";", 
                   RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}], ";", " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                   "\[IndentingNewLine]", 
                   RowBox[{"nbnb", "=", 
                    RowBox[{"EngineNeighborNeighbor", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"snb", ",", "new1"}], "]"}], "]"}]}], ";", 
                   RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nbnb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "di", "-", "1"}], ")"}], "*", "n", "*", 
                    "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "+", "dj", "-", "1"}], ")"}], "*", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new1"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}]}]}], " ", 
                 RowBox[{"(*", " ", 
                  RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                 "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"else", " ", "--"}], "--"}], "--"}], "--"}], " ", 
                "bimolecular", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"move", " ", "--"}], "--"}], "--"}], "--"}]}], "-",
                " ", 
               RowBox[{"so", " ", "nb"}]}], ">", 
              RowBox[{"0", " ", "and", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"i", "+", "di"}], ",", 
                 RowBox[{"j", "+", "dj"}], ",", 
                 RowBox[{"k", "+", "dk"}]}], ")"}], " ", "guaranteed", " ", 
               "to", " ", "be", " ", "within", " ", "range"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
              RowBox[{"EngineNeighbors", "[", 
               RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i2", ",", "j2", ",", "k2"}], "}"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"i", "+", "di"}], ",", 
                RowBox[{"j", "+", "dj"}], ",", 
                RowBox[{"k", "+", "dk"}]}], "}"}]}], ";", " ", 
             RowBox[{"s1", "=", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ";", 
             RowBox[{"s2", "=", 
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "j2", ",", "k2"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"r", "=", 
              RowBox[{"biindex", "[", 
               RowBox[{"[", 
                RowBox[{"s1", ",", "s2"}], "]"}], "]"}]}], ";", " ", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"r", "\[Equal]", "0"}], ",", 
                 RowBox[{"Print", "[", "\"\<bibad!\>\"", "]"}]}], "]"}], 
               ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"newp", "=", 
              RowBox[{
               RowBox[{"RandomReal", "[", "]"}], "*", 
               RowBox[{"R", "[", 
                RowBox[{"[", "id", "]"}], "]"}]}]}], ";", 
             RowBox[{"ksum", "=", 
              RowBox[{"birates", "[", 
               RowBox[{"[", "r", "]"}], "]"}]}], ";", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"newp", ">", "ksum"}], "&&", 
                RowBox[{
                 RowBox[{"bireactions", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                 "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"s1", ",", "s2"}], "}"}]}]}], ",", 
               RowBox[{
                RowBox[{"ksum", "+=", 
                 RowBox[{"birates", "[", 
                  RowBox[{"[", 
                   RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"new1", ",", "new2"}], "}"}], "=", 
              RowBox[{"bireactions", "[", 
               RowBox[{"[", 
                RowBox[{"r", ",", 
                 RowBox[{"{", 
                  RowBox[{"3", ",", "4"}], "}"}]}], "]"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], "=", 
              "new1"}], ";", 
             RowBox[{
              RowBox[{"S", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"i", "+", "di"}], ",", 
                 RowBox[{"j", "+", "dj"}], ",", 
                 RowBox[{"k", "+", "dk"}]}], "]"}], "]"}], "=", "new2"}], ";",
              "\[IndentingNewLine]", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "update", " ", "self", " ", "rates", " ", "for", " ", "each", 
               " ", 
               RowBox[{"(", "possibly", ")"}], " ", "changed", " ", "site"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s1", "\[NotEqual]", "new1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"r", "=", 
                 RowBox[{"uniindex", "[", 
                  RowBox[{"[", "new1", "]"}], "]"}]}], ";", 
                RowBox[{"id", "=", 
                 RowBox[{
                  RowBox[{"2", "^", "K"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
                  RowBox[{"(", 
                   RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                   RowBox[{"unirates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"unireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                   "\[Equal]", "new1"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"unirates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                   RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{"id", ">", "1"}], ",", 
                  RowBox[{
                   RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                 "]"}]}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s2", "\[NotEqual]", "new2"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"r", "=", 
                 RowBox[{"uniindex", "[", 
                  RowBox[{"[", "new2", "]"}], "]"}]}], ";", 
                RowBox[{"id", "=", 
                 RowBox[{
                  RowBox[{"2", "^", "K"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"i2", "-", "1"}], ")"}], "*", "n", "*", "m"}], 
                  "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"j2", "-", "1"}], ")"}], "*", "m"}], "+", 
                  RowBox[{"(", 
                   RowBox[{"k2", "-", "1"}], ")"}]}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", "id", "]"}], "]"}], "=", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                   RowBox[{"unirates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"unireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], "]"}], "]"}], 
                   "\[Equal]", "new2"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"unirates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                   RowBox[{"r", "++"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"While", "[", 
                 RowBox[{
                  RowBox[{"id", ">", "1"}], ",", 
                  RowBox[{
                   RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                   RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                 "]"}]}]}], " ", 
              RowBox[{"(*", " ", 
               RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "update", " ", "rates", " ", "for", " ", "bimolecular", " ", 
               "neighbors", " ", "of", " ", "each", " ", 
               RowBox[{"(", "possibly", ")"}], " ", "changed", " ", "site"}], 
              " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s1", "\[NotEqual]", "new1"}], ",", 
               RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                   RowBox[{"EngineNeighbors", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"new1", ",", "snb"}], "]"}], "]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], "*", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}], ";", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{"EngineNeighborNeighbor", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"snb", ",", "new1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nbnb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "di", "-", "1"}], ")"}], "*", "n", "*", 
                    "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "+", "dj", "-", "1"}], ")"}], "*", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new1"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}]}]}], " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                   "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], "]"}],
              ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"s2", "\[NotEqual]", "new2"}], ",", 
               RowBox[{"Do", "[", " ", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                   RowBox[{"EngineNeighbors", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i2", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j2", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k2", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"i2", "+", "di"}], ",", 
                    RowBox[{"j2", "+", "dj"}], ",", 
                    RowBox[{"k2", "+", "dk"}]}], "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"new2", ",", "snb"}], "]"}], "]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "-", "1"}], ")"}], "*", "n", "*", "m"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "-", "1"}], ")"}], "*", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "-", "1"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new2", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}], ";", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{"EngineNeighborNeighbor", "[", 
                    RowBox[{"[", "nb", "]"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "[", 
                    RowBox[{"[", 
                    RowBox[{"snb", ",", "new2"}], "]"}], "]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    RowBox[{"2", "^", "K"}], "+", 
                    RowBox[{"nbnb", "*", "d", "*", "n", "*", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "+", "di", "-", "1"}], ")"}], "*", "n", "*",
                     "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "+", "dj", "-", "1"}], ")"}], "*", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", "r", "]"}], "]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}], 
                    "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new2"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "+=", 
                    RowBox[{"birates", "[", 
                    RowBox[{"[", 
                    RowBox[{"r", "+", "1"}], "]"}], "]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", "id", "]"}], "]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", "id"}], "]"}], "]"}], "+", 
                    RowBox[{"R", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"2", "id"}], "+", "1"}], "]"}], "]"}]}]}]}]}], 
                    "]"}]}]}], " ", 
                   RowBox[{"(*", " ", 
                    RowBox[{"update", " ", "the", " ", "tree"}], " ", "*)"}], 
                   "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], "]"}],
              ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"haltedq", "=", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"R", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", "0.0"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"residue", "=", "t"}], ";", 
       RowBox[{"digits", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"digit", "=", 
            RowBox[{"Floor", "[", "residue", "]"}]}], ";", 
           RowBox[{"residue", "=", 
            RowBox[{
             RowBox[{"10", "residue"}], "-", 
             RowBox[{"10", " ", "digit"}]}]}], ";", " ", "digit"}], ",", 
          RowBox[{"{", "20", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Flatten", "[", "S", "]"}], "~", "Join", "~", "digits", "~", 
        "Join", "~", 
        RowBox[{"{", 
         RowBox[{"events", ",", "haltedq"}], "}"}]}]}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"CompilationOptions", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<InlineExternalDefinitions\>\"", " ", "->", " ", "True"}], 
       ",", 
       RowBox[{"\"\<InlineCompiledFunctions\>\"", "->", "False"}]}], "}"}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"CompilationTarget", "->", "\"\<C\>\""}], ",", 
    RowBox[{"Parallelization", "->", "True"}], ",", 
    RowBox[{"RuntimeOptions", "->", "\"\<Speed\>\""}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.781651274360599*^9, 3.7816514892033*^9}, {
   3.781652096422318*^9, 3.78165218455435*^9}, {3.781652229362276*^9, 
   3.781652268909336*^9}, {3.781652314506386*^9, 3.781652373223322*^9}, {
   3.78165242238306*^9, 3.78165261948767*^9}, {3.781654087654706*^9, 
   3.781654123965427*^9}, {3.7816541963116627`*^9, 3.781654211103456*^9}, 
   3.781655688215148*^9, {3.821488443569254*^9, 3.821488578375073*^9}, {
   3.821488805867117*^9, 3.8214888143777857`*^9}, {3.821488848084844*^9, 
   3.8214888679954233`*^9}, {3.821489134769868*^9, 3.821489149295885*^9}, {
   3.821489691151334*^9, 3.82148981467875*^9}, {3.821489851077654*^9, 
   3.821489910530439*^9}, {3.821489942489389*^9, 3.821489963583885*^9}, {
   3.821490100290226*^9, 3.821490117237113*^9}, {3.8214903353966312`*^9, 
   3.821490393056683*^9}, {3.821490468899506*^9, 3.821490721497278*^9}, {
   3.821490778067947*^9, 3.821490837427792*^9}, {3.8214911590355053`*^9, 
   3.821491161946781*^9}, {3.821491357788289*^9, 3.821491366357773*^9}, {
   3.8214914279736433`*^9, 3.821491492246211*^9}, {3.821492187521584*^9, 
   3.821492380396805*^9}, {3.82149276261454*^9, 3.821492798042297*^9}, {
   3.821493397740169*^9, 3.821493562202622*^9}, {3.821493639905229*^9, 
   3.821493640361871*^9}, {3.821494773695602*^9, 3.821495009630947*^9}, {
   3.821667626415061*^9, 3.821667711419366*^9}, {3.821667743027349*^9, 
   3.82166776790061*^9}, 3.8226083777829447`*^9, {3.822608410543561*^9, 
   3.822608478371851*^9}, {3.8226090090507174`*^9, 3.8226091581076593`*^9}, {
   3.822609376091175*^9, 3.822609381961532*^9}, {3.826490117841283*^9, 
   3.826490127965609*^9}, {3.826490296804644*^9, 3.8264903190663023`*^9}, {
   3.8264904472396*^9, 3.8264904499324207`*^9}, {3.8264904889045143`*^9, 
   3.826490694257897*^9}, {3.8264907906283083`*^9, 3.826490790988693*^9}, {
   3.826491034152959*^9, 3.8264910867757473`*^9}, {3.826494658889443*^9, 
   3.826494701454627*^9}, {3.8264952080065117`*^9, 3.8264952441429377`*^9}, {
   3.826495391718115*^9, 3.826495426008934*^9}, {3.82649545916541*^9, 
   3.826495461823557*^9}, {3.826495514842798*^9, 3.826495629911133*^9}, {
   3.826495707526843*^9, 3.826495729409141*^9}, {3.82649578602295*^9, 
   3.826495987146162*^9}, {3.826496945583682*^9, 3.8264969915024157`*^9}, {
   3.826497036091778*^9, 3.826497104159731*^9}, {3.82649715387149*^9, 
   3.8264971828931093`*^9}, {3.826497240700202*^9, 3.826497409414976*^9}, {
   3.82649758367306*^9, 3.8264976459917927`*^9}, {3.8264976934790897`*^9, 
   3.826497730453253*^9}, {3.826497939923622*^9, 3.826497994593171*^9}, {
   3.826498046440185*^9, 3.8264980986670713`*^9}, {3.826499604645473*^9, 
   3.826499610112589*^9}, {3.82650076491949*^9, 3.826500786463396*^9}, {
   3.826500847488289*^9, 3.826500882816243*^9}, {3.8265009208231287`*^9, 
   3.8265009211713657`*^9}, {3.826500988858039*^9, 3.826501027155529*^9}, {
   3.8265014710833473`*^9, 3.826501522045053*^9}, 3.826501997846107*^9, {
   3.826502032680872*^9, 3.826502072085429*^9}, {3.826502140526155*^9, 
   3.8265021581655893`*^9}, {3.8274351123592978`*^9, 
   3.8274351245598297`*^9}, {3.8274351921608047`*^9, 
   3.8274352095176077`*^9}, {3.827435268635062*^9, 3.8274353071722193`*^9}, {
   3.8274353768251534`*^9, 3.82743552009692*^9}, {3.827435562863843*^9, 
   3.827435576653614*^9}, {3.827435657406066*^9, 3.8274356874027367`*^9}, {
   3.827435763080701*^9, 3.827435778299739*^9}, {3.8274358385137777`*^9, 
   3.827435849242551*^9}, {3.827435879546389*^9, 3.827435889122077*^9}, {
   3.827439059515089*^9, 3.827439125085788*^9}, {3.827439171200235*^9, 
   3.827439473804582*^9}, {3.827440544484023*^9, 3.8274405908105707`*^9}, {
   3.8274438300291443`*^9, 3.8274439854668007`*^9}, {3.827444105281102*^9, 
   3.827444187118676*^9}, {3.827444241544485*^9, 3.827444251013945*^9}, {
   3.827444939623866*^9, 3.8274449654403687`*^9}, {3.827445409476548*^9, 
   3.827445599832376*^9}, {3.827445634723226*^9, 3.827445677554667*^9}, {
   3.827445839398787*^9, 3.827445861840085*^9}, 3.827445916855886*^9, {
   3.827446199026907*^9, 3.827446361000649*^9}, {3.8274466270153913`*^9, 
   3.8274466387037907`*^9}, {3.82744671007747*^9, 3.827446726783412*^9}, {
   3.8274478312160273`*^9, 3.827447839514165*^9}, {3.827447880858128*^9, 
   3.827447932332026*^9}, {3.827448587556196*^9, 3.827448658356574*^9}, {
   3.827448776923015*^9, 3.8274487878106127`*^9}, {3.8274494332828903`*^9, 
   3.827449496988875*^9}, {3.827449530123499*^9, 3.8274497262404213`*^9}, {
   3.827449771997669*^9, 3.827449777029212*^9}, {3.827449810417149*^9, 
   3.827449926368108*^9}, {3.827449959856124*^9, 3.827450025047139*^9}, {
   3.827450081003139*^9, 3.827450165529408*^9}, {3.8274502352702436`*^9, 
   3.827450288304428*^9}, {3.8274503346044893`*^9, 3.827450372710339*^9}, {
   3.8274552179018517`*^9, 3.827455279500752*^9}, {3.8274553240930977`*^9, 
   3.8274553412921267`*^9}, {3.827455461362588*^9, 3.82745554006597*^9}, {
   3.8274556490265837`*^9, 3.827455673473378*^9}, {3.827455861689157*^9, 
   3.827455872362143*^9}, {3.827456171424363*^9, 3.827456194301757*^9}, {
   3.827456403945945*^9, 3.827456439089635*^9}, {3.827456518198135*^9, 
   3.827456525475007*^9}, {3.8274565790153217`*^9, 3.8274566115069447`*^9}, {
   3.827456657463909*^9, 3.827456667558611*^9}, {3.82745670109046*^9, 
   3.827456715283847*^9}, {3.8276860801451797`*^9, 3.827686083297187*^9}, {
   3.827686440700819*^9, 3.8276866821423197`*^9}, {3.827687138276053*^9, 
   3.827687138636119*^9}, {3.827687182269754*^9, 3.827687187815103*^9}, {
   3.827687234472637*^9, 3.827687237224285*^9}, {3.827687322163837*^9, 
   3.827687378460202*^9}, {3.827687419741844*^9, 3.827687419841092*^9}, {
   3.827687477485483*^9, 3.827687515184065*^9}, {3.827688910570066*^9, 
   3.82768892258862*^9}, {3.827689455641632*^9, 3.827689468926861*^9}, 
   3.8276895076673317`*^9, {3.82769145706855*^9, 3.827691478569367*^9}, {
   3.827691679856038*^9, 3.8276917064620333`*^9}, {3.827691834857884*^9, 
   3.82769183948332*^9}, {3.8276919973695517`*^9, 3.827692059800847*^9}, 
   3.8276922126574802`*^9, {3.8276922727183523`*^9, 3.827692301838957*^9}, {
   3.827692345238646*^9, 3.8276923491117153`*^9}, {3.8276929383258057`*^9, 
   3.827693043530583*^9}, {3.8276931511196632`*^9, 3.827693173171525*^9}, {
   3.827693213660039*^9, 3.82769326159099*^9}, {3.827693583747015*^9, 
   3.8276936878414097`*^9}, {3.8276937568317213`*^9, 
   3.8276937679334507`*^9}, {3.8276945232525473`*^9, 3.827694579565968*^9}, {
   3.827694649406556*^9, 3.827694649837871*^9}, {3.8276947219253674`*^9, 
   3.827694768944418*^9}, {3.827694864995953*^9, 3.827694865492052*^9}, {
   3.8276949255058413`*^9, 3.8276949981318808`*^9}, {3.829311071079625*^9, 
   3.8293110870472107`*^9}, {3.829311674079611*^9, 3.8293116837638187`*^9}, {
   3.829311717698142*^9, 3.829311757581853*^9}, {3.829311788546165*^9, 
   3.829311811571733*^9}, {3.82931212172125*^9, 3.8293121240325193`*^9}, 
   3.829313173107744*^9, {3.8293132378299503`*^9, 3.8293132389853477`*^9}, {
   3.829313367819182*^9, 3.829313375224931*^9}, {3.8293134412381496`*^9, 
   3.8293135261663523`*^9}, {3.829313565362571*^9, 3.8293135681235723`*^9}, {
   3.82931540052383*^9, 3.82931540428677*^9}, {3.829315441729999*^9, 
   3.829315447344001*^9}, {3.82935083575909*^9, 3.829350836117942*^9}, {
   3.829352513838688*^9, 3.829352563161935*^9}, {3.829353599867165*^9, 
   3.829353678365094*^9}, {3.829353721453038*^9, 3.829353742259715*^9}, {
   3.829353788873304*^9, 3.829353810990847*^9}, {3.82935386627274*^9, 
   3.8293538993119698`*^9}, {3.829353934607794*^9, 3.829354122396658*^9}, {
   3.8293542149052143`*^9, 3.8293544508047953`*^9}, {3.8293548624694977`*^9, 
   3.8293549283683443`*^9}, {3.8293549597936707`*^9, 3.829355306890025*^9}, {
   3.8293564239693117`*^9, 3.8293564286338997`*^9}, {3.829356590716354*^9, 
   3.8293566973751173`*^9}, {3.8293569554394007`*^9, 3.829356955592334*^9}, {
   3.829356993754346*^9, 3.829357141112039*^9}, {3.829357206206911*^9, 
   3.8293572454739447`*^9}, {3.829357284512332*^9, 3.829357449190792*^9}, {
   3.829357479774501*^9, 3.829357499486163*^9}, {3.829396385300983*^9, 
   3.829396387538836*^9}, {3.829396421527855*^9, 3.8293964456380663`*^9}, {
   3.829396511420451*^9, 3.829396545091914*^9}, {3.82939694897434*^9, 
   3.82939695487729*^9}, {3.82939702578876*^9, 3.8293971841711407`*^9}, {
   3.829397215545189*^9, 3.829397245885077*^9}, {3.829397379992309*^9, 
   3.82939738842198*^9}, {3.829397426883976*^9, 3.829397472208158*^9}, {
   3.8293975135811996`*^9, 3.829397540329706*^9}, {3.829397630469928*^9, 
   3.829397683549979*^9}, {3.829398303467143*^9, 3.8293983765914173`*^9}, {
   3.829398456138383*^9, 3.829398494356905*^9}, {3.829399548875527*^9, 
   3.829399559257853*^9}, {3.8293996015913258`*^9, 3.829399640293932*^9}, {
   3.829400475900655*^9, 3.829400566573152*^9}, {3.829400659910534*^9, 
   3.8294007078151217`*^9}, {3.8294007380666533`*^9, 3.829400774840069*^9}, {
   3.829401235887641*^9, 3.829401334205523*^9}, {3.829401578505167*^9, 
   3.829401694039124*^9}, {3.829401757471079*^9, 3.829401889893997*^9}, {
   3.829401987435071*^9, 3.829402007092865*^9}, {3.829402691027473*^9, 
   3.829402699165428*^9}, {3.829413927760243*^9, 3.829413977051437*^9}, {
   3.829414026593277*^9, 3.829414107585991*^9}, {3.8294151588835773`*^9, 
   3.829415300267589*^9}, {3.829415343766718*^9, 3.8294153906807423`*^9}, {
   3.829415652260687*^9, 3.829415664184716*^9}, {3.829415695494206*^9, 
   3.8294158716350183`*^9}, {3.8294159073410683`*^9, 3.82941590822316*^9}, {
   3.829416266683345*^9, 3.829416451704829*^9}, 3.829417159719322*^9, {
   3.829417425062392*^9, 3.829417425388935*^9}, {3.8294182313414993`*^9, 
   3.8294182720524483`*^9}, {3.829419040710771*^9, 3.8294190730194798`*^9}, {
   3.829419597617413*^9, 3.829419683040909*^9}, {3.8294197193992567`*^9, 
   3.8294197503994713`*^9}, {3.829420305315015*^9, 3.829420408931347*^9}, {
   3.829420509918208*^9, 3.8294206107441063`*^9}, {3.829420666901655*^9, 
   3.829420813370242*^9}, {3.829420957101894*^9, 3.829421004059791*^9}, 
   3.8294210354269342`*^9, {3.8294214045467653`*^9, 3.829421424039044*^9}, {
   3.829421536466301*^9, 3.829421556242803*^9}, {3.8294216245874853`*^9, 
   3.829421627705082*^9}, {3.829421668141285*^9, 3.8294216697019997`*^9}, 
   3.8294265008730803`*^9, {3.8294322580856047`*^9, 3.829432310638414*^9}, {
   3.829432348126721*^9, 3.8294323686174517`*^9}, {3.829764560803157*^9, 
   3.829764568452071*^9}, {3.82976460512537*^9, 3.829764685216671*^9}, {
   3.8297647698751297`*^9, 3.829764778985075*^9}, {3.8297649730814133`*^9, 
   3.829765023526205*^9}, {3.829765110610145*^9, 3.829765221168387*^9}, {
   3.829770156248089*^9, 3.8297702852081823`*^9}, {3.832636544093556*^9, 
   3.8326365472728157`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"dffc76af-d98e-4596-b53b-f25c507d2b3c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["CompiledFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
                 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                
                "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
             AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  StyleBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", "_Real"}], 
                    "}"}], ContentPadding -> False, FrameMargins -> 0, 
                    StripOnInput -> True, BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                   False], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
                 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                
                "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
             AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["8", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "3"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"_Integer", ",", "2"}], "}"}], ",", "_Real"}], 
                    "}"}], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    
                    RowBox[{
                    "space", ",", "unireactions", ",", "unirates", ",", 
                    "uniindex", ",", "bireactions", ",", "birates", ",", 
                    "biindex", ",", "tmax"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"d", "=", 
                    RowBox[{"Length", "[", "space", "]"}]}], ",", 
                    RowBox[{"n", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "[", "space", "]"}], "]"}]}], ",", 
                    RowBox[{"m", "=", 
                    RowBox[{"Length", "[", 
                    RowBox[{"First", "[", 
                    RowBox[{"First", "[", "space", "]"}], "]"}], "]"}]}], ",",
                     "d1", ",", "d2", ",", "n1", ",", "n2", ",", "m1", ",", 
                    "m2", ",", 
                    RowBox[{"S", "=", "space"}], ",", "R", ",", "id", ",", 
                    "idd", ",", "K", ",", "nb", ",", "nbnb", ",", "i", ",", 
                    "j", ",", "k", ",", "i2", ",", "j2", ",", "k2", ",", "di",
                     ",", "dj", ",", "dk", ",", "r", ",", 
                    RowBox[{"s1", "=", "1"}], ",", 
                    RowBox[{"s2", "=", "1"}], ",", "snb", ",", "new1", ",", 
                    "new2", ",", "ksum", ",", "newp", ",", 
                    RowBox[{"t", "=", "0.`"}], ",", "dt", ",", 
                    RowBox[{"events", "=", "0"}], ",", "haltedq", ",", 
                    "digit", ",", "digits", ",", "residue"}], "}"}], ",", 
                    RowBox[{
                    RowBox[{"K", "=", 
                    RowBox[{"Ceiling", "[", 
                    RowBox[{"Log", "[", 
                    RowBox[{"2", ",", 
                    RowBox[{"1", "+", 
                    RowBox[{"7", " ", "d", " ", "n", " ", "m"}]}]}], "]"}], 
                    "]"}]}], ";", 
                    RowBox[{"R", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{"0.`", ",", 
                    RowBox[{"{", 
                    SuperscriptBox["2", 
                    RowBox[{"K", "+", "1"}]], "}"}]}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", ">", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "1"}], "\[RightDoubleBracket]"}], 
                    "\[Equal]", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "d"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "n"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "m"}], "}"}]}], "]"}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"d1", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "-", "di"}]}], "]"}]}], ";", 
                    RowBox[{"d2", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"d", ",", 
                    RowBox[{"d", "-", "di"}]}], "]"}]}], ";", 
                    RowBox[{"n1", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "-", "dj"}]}], "]"}]}], ";", 
                    RowBox[{"n2", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"n", ",", 
                    RowBox[{"n", "-", "dj"}]}], "]"}]}], ";", 
                    RowBox[{"m1", "=", 
                    RowBox[{"Max", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"1", "-", "dk"}]}], "]"}]}], ";", 
                    RowBox[{"m2", "=", 
                    RowBox[{"Min", "[", 
                    RowBox[{"m", ",", 
                    RowBox[{"m", "-", "dk"}]}], "]"}]}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", ">", "0"}], "&&", 
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "d1", ",", "d2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "n1", ",", "n2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "m1", ",", "m2"}], "}"}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"id", ",", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "-", "1"}], ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"t", "<", "tmax"}], "&&", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ">", "0"}]}], ",", 
                    RowBox[{
                    RowBox[{"dt", "=", 
                    RowBox[{"-", 
                    FractionBox[
                    RowBox[{"Log", "[", 
                    RowBox[{"RandomReal", "[", "]"}], "]"}], 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]]}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"t", "+", "dt"}], "<", "tmax"}], ",", 
                    RowBox[{
                    RowBox[{"t", "+=", "dt"}], ";", 
                    RowBox[{"events", "++"}]}], ",", 
                    RowBox[{
                    RowBox[{"t", "=", "tmax"}], ";", 
                    RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
                    RowBox[{"id", "=", "1"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", "<", 
                    SuperscriptBox["2", "K"]}], ",", 
                    RowBox[{"id", "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], " ", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}]}], "<", 
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}]}], 
                    ",", 
                    RowBox[{"2", " ", "id"}], ",", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}]}], "]"}]}]}], "]"}], 
                    ";", 
                    RowBox[{"idd", "=", "id"}], ";", 
                    RowBox[{"idd", "-=", 
                    SuperscriptBox["2", "K"]}], ";", 
                    RowBox[{"nb", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"idd", ",", 
                    RowBox[{"d", " ", "n", " ", "m"}]}], "]"}]}], ";", 
                    RowBox[{"idd", "-=", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}]}], ";", 
                    RowBox[{"i", "=", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{"idd", ",", 
                    RowBox[{"n", " ", "m"}]}], "]"}], "+", "1"}]}], ";", 
                    RowBox[{"idd", "-=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}]}], 
                    ";", 
                    RowBox[{"j", "=", 
                    RowBox[{
                    RowBox[{"Quotient", "[", 
                    RowBox[{"idd", ",", "m"}], "]"}], "+", "1"}]}], ";", 
                    RowBox[{"idd", "-=", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}]}], ";", 
                    RowBox[{"k", "=", 
                    RowBox[{"idd", "+", "1"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"nb", "\[Equal]", "0"}], ",", 
                    RowBox[{
                    RowBox[{"s1", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", "s1", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"newp", "=", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], " ", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}]}]}], ";", 
                    RowBox[{"ksum", "=", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newp", ">", "ksum"}], "&&", 
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", "s1"}]}], ",", 
                    RowBox[{
                    RowBox[{"ksum", "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"new1", "=", 
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "=", "new1"}], ";", 
                    RowBox[{"r", "=", 
                    
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", "new1", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", "new1"}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"new1", ",", "snb"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "6", ",", 
                    "5"}], "}"}], "\[LeftDoubleBracket]", "nb", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"snb", ",", "new1"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nbnb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "di", "-", "1"}], ")"}], " ", "n", " ", 
                    "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "+", "dj", "-", "1"}], ")"}], " ", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new1"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i2", ",", "j2", ",", "k2"}], "}"}], "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "}"}]}], ";", 
                    RowBox[{"s1", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"s2", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i2", ",", "j2", ",", "k2"}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"s1", ",", "s2"}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"newp", "=", 
                    RowBox[{
                    RowBox[{"RandomReal", "[", "]"}], " ", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}]}]}], ";", 
                    RowBox[{"ksum", "=", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"newp", ">", "ksum"}], "&&", 
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"s1", ",", "s2"}], "}"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"ksum", "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "new2"}], "}"}], "=", 
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{"r", ",", 
                    RowBox[{"{", 
                    RowBox[{"3", ",", "4"}], "}"}]}], 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j", ",", "k"}], 
                    "\[RightDoubleBracket]"}], "=", "new1"}], ";", 
                    RowBox[{
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}], 
                    "=", "new2"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s1", "\[NotEqual]", "new1"}], ",", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", "new1", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", "new1"}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}], ";", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s2", "\[NotEqual]", "new2"}], ",", 
                    RowBox[{
                    RowBox[{"r", "=", 
                    
                    RowBox[{"uniindex", "\[LeftDoubleBracket]", "new2", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "-", "1"}], ")"}], " ", "n", " ", "m"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"unirates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"unireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", "1"}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", "new2"}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"unirates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}], ";", 
                    
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s1", "\[NotEqual]", "new1"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i", "+", "di"}], ",", 
                    RowBox[{"j", "+", "dj"}], ",", 
                    RowBox[{"k", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"new1", ",", "snb"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new1", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "6", ",", 
                    "5"}], "}"}], "\[LeftDoubleBracket]", "nb", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"snb", ",", "new1"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nbnb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "+", "di", "-", "1"}], ")"}], " ", "n", " ", 
                    "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "+", "dj", "-", "1"}], ")"}], " ", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new1"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
                    "]"}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"s2", "\[NotEqual]", "new2"}], ",", 
                    RowBox[{"Do", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"di", ",", "dj", ",", "dk"}], "}"}], "=", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], 
                    "\[LeftDoubleBracket]", "nb", "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"i2", "+", "di"}], "\[LessEqual]", "d"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"j2", "+", "dj"}], "\[LessEqual]", "n"}], "&&", 
                    RowBox[{"1", "\[LessEqual]", 
                    RowBox[{"k2", "+", "dk"}], "\[LessEqual]", "m"}]}], ",", 
                    RowBox[{
                    RowBox[{"snb", "=", 
                    RowBox[{"S", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"i2", "+", "di"}], ",", 
                    RowBox[{"j2", "+", "dj"}], ",", 
                    RowBox[{"k2", "+", "dk"}]}], "\[RightDoubleBracket]"}]}], 
                    ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"new2", ",", "snb"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "-", "1"}], ")"}], " ", "n", " ", "m"}], 
                    "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "-", "1"}], ")"}], " ", "m"}], "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"new2", ",", "snb"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}], ";", 
                    RowBox[{"nbnb", "=", 
                    RowBox[{
                    RowBox[{"{", 
                    
                    RowBox[{"2", ",", "1", ",", "4", ",", "3", ",", "6", ",", 
                    "5"}], "}"}], "\[LeftDoubleBracket]", "nb", 
                    "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "=", 
                    RowBox[{"biindex", "\[LeftDoubleBracket]", 
                    RowBox[{"snb", ",", "new2"}], "\[RightDoubleBracket]"}]}],
                     ";", 
                    RowBox[{"id", "=", 
                    RowBox[{
                    SuperscriptBox["2", "K"], "+", 
                    RowBox[{"nbnb", " ", "d", " ", "n", " ", "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i2", "+", "di", "-", "1"}], ")"}], " ", "n", " ",
                     "m"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j2", "+", "dj", "-", "1"}], ")"}], " ", "m"}], 
                    "+", 
                    RowBox[{"(", 
                    RowBox[{"k2", "+", "dk", "-", "1"}], ")"}]}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "\[Equal]", "0"}], ",", "0", ",", 
                    
                    RowBox[{"birates", "\[LeftDoubleBracket]", "r", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"bireactions", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"r", "+", "1"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}]}], 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"{", 
                    RowBox[{"snb", ",", "new2"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "+=", 
                    RowBox[{"birates", "\[LeftDoubleBracket]", 
                    RowBox[{"r", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"r", "++"}]}]}], "]"}], ";", 
                    RowBox[{"While", "[", 
                    RowBox[{
                    RowBox[{"id", ">", "1"}], ",", 
                    RowBox[{
                    RowBox[{"id", "=", 
                    RowBox[{"Quotient", "[", 
                    RowBox[{"id", ",", "2"}], "]"}]}], ";", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "id", 
                    "\[RightDoubleBracket]"}], "=", 
                    RowBox[{
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{"2", " ", "id"}], "\[RightDoubleBracket]"}], "+", 
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"2", " ", "id"}], "+", "1"}], 
                    "\[RightDoubleBracket]"}]}]}]}]}], "]"}]}]}], "]"}]}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{"nb", ",", "1", ",", "6"}], "}"}]}], "]"}]}], 
                    "]"}], ";"}]}], "]"}], ";"}]}], "]"}], ";", 
                    RowBox[{"haltedq", "=", 
                    RowBox[{"Boole", "[", 
                    RowBox[{
                    
                    RowBox[{"R", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "0.`"}], "]"}]}], 
                    ";", 
                    RowBox[{"residue", "=", "t"}], ";", 
                    RowBox[{"digits", "=", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"digit", "=", 
                    RowBox[{"Floor", "[", "residue", "]"}]}], ";", 
                    RowBox[{"residue", "=", 
                    RowBox[{
                    RowBox[{"10", " ", "residue"}], "-", 
                    RowBox[{"10", " ", "digit"}]}]}], ";", "digit"}], ",", 
                    RowBox[{"{", "20", "}"}]}], "]"}]}], ";", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Flatten", "[", "S", "]"}], ",", "digits"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"events", ",", "haltedq"}], "}"}]}], "]"}]}]}], 
                    "]"}], ImageSize -> {{1, 500}, Automatic}, 
                   BaselinePosition -> Baseline, ContentPadding -> False, 
                   FrameMargins -> 0, StripOnInput -> True], 
                  "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  CompiledFunction[{11, 13., 7768}, {{
     Blank[Integer], 3}, {
     Blank[Integer], 2}, {
     Blank[Real], 1}, {
     Blank[Integer], 1}, {
     Blank[Integer], 2}, {
     Blank[Real], 1}, {
     Blank[Integer], 2}, 
    Blank[Real]}, {{2, 3, 0}, {2, 2, 1}, {3, 1, 2}, {2, 1, 3}, {2, 2, 4}, {3, 
   1, 5}, {2, 2, 6}, {3, 0, 0}, {2, 1, 
   17}}, {{False, {1, 0, 2}}, {0, {2, 0, 4}}, {1., {3, 0, 5}}, {
    10, {2, 0, 43}}, {6, {2, 0, 20}}, {5, {2, 0, 38}}, {
    2, {2, 0, 5}}, {-1, {2, 0, 16}}, {{1, 2}, {2, 1, 11}}, {
    7, {2, 0, 6}}, {{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 
     0, -1}, {0, 0, 1}}, {2, 2, 9}}, {1, {2, 0, 1}}, {
    3, {2, 0, 21}}, {{3, 4}, {2, 1, 14}}, {
    0., {3, 0, 1}}, {{2, 1, 4, 3, 6, 5}, {2, 1, 13}}, {20, {2, 0, 42}}}, {8, 
   47, 12, 0, 
   18}, {{33, 0, 37}, {38, 0, 0, 1, 2, 10}, {33, 10, 33}, {38, 0, 0, 1, 2, 
    10}, {38, 10, 0, 1, 1, 7}, {33, 7, 32}, {
    42, "CopyTensor", 2, 3, 0, 2, 3, 7}, {6, 1, 27}, {6, 1, 36}, {7, 1, 2}, {
    6, 4, 15}, {15, 6, 37, 33, 32, 17}, {12, 1, 17, 13}, {10, 5, 4}, {10, 13, 
    3}, {41, 264, 3, 0, 4, 3, 0, 3, 3, 0, 9}, {40, 51, 3, 0, 9, 2, 0, 13}, {
    12, 13, 1, 17}, {41, 263, 2, 0, 5, 2, 0, 17, 2, 0, 25}, {6, 4, 29}, {35, 
    25, 3, 10}, {6, 4, 17}, {3, 2}, {36, 29, 1, 3, 10}, {4, 17, 25, -1}, {6, 
    37, 7}, {6, 4, 31}, {3, 35}, {6, 33, 29}, {6, 4, 17}, {3, 31}, {6, 32, 
    25}, {6, 4, 28}, {3, 27}, {38, 7, 0, 31, 0, 17, 0, 28, 0, 26}, {38, 3, 0, 
    26, 0, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 26}, {12, 31, 16, 30}, {15,
     30, 33, 32, 30}, {12, 17, 16, 10}, {15, 10, 32, 10}, {12, 28, 16, 8}, {
    12, 26, 30, 10, 8, 26}, {25, 4, 12, 1}, {2, 1, 6}, {38, 1, 0, 12, 0, 1, 0,
     30}, {38, 7, 0, 31, 0, 17, 0, 28, 0, 10}, {24, 30, 10, 0}, {5, 0, 5}, {3,
     2}, {5, 2, 5}, {2, 5, 9}, {38, 10, 0, 26, 0, 9}, {38, 2, 0, 12, 0, 4}, {
    13, 9, 4, 9}, {39, 10, 0, 26, 0, 9}, {6, 12, 30}, {12, 30, 1, 10}, {6, 10,
     12}, {3, -16}, {4, 28, 25, -26}, {4, 17, 29, -30}, {4, 31, 7, -34}, {6, 
    20, 7}, {6, 4, 31}, {3, 82}, {38, 9, 0, 31, 1, 8}, {33, 8, 29}, {24, 29, 
    21, 5}, {32, 5, 5}, {2, 5, 3}, {49}, {3, 1}, {37, 8, 1, 2, 29}, {37, 8, 5,
     2, 17}, {37, 8, 21, 2, 25}, {18, 29, 28}, {12, 1, 28, 30}, {
    42, "MaxI", 2, 0, 1, 2, 0, 30, 2, 0, 28}, {18, 29, 30}, {12, 37, 30, 
    10}, {42, "MinI", 2, 0, 37, 2, 0, 10, 2, 0, 30}, {18, 17, 10}, {12, 1, 10,
     8}, {42, "MaxI", 2, 0, 1, 2, 0, 8, 2, 0, 10}, {18, 17, 8}, {12, 33, 8, 
    24}, {42, "MinI", 2, 0, 33, 2, 0, 24, 2, 0, 8}, {18, 25, 24}, {12, 1, 24, 
    14}, {42, "MaxI", 2, 0, 1, 2, 0, 14, 2, 0, 24}, {18, 25, 14}, {12, 32, 14,
     23}, {42, "MinI", 2, 0, 32, 2, 0, 23, 2, 0, 14}, {
    42, "IteratorCountI", 2, 0, 28, 2, 0, 30, 2, 0, 23}, {6, 16, 22}, {3, 
    50}, {12, 28, 22, 11}, {
    42, "IteratorCountI", 2, 0, 10, 2, 0, 8, 2, 0, 9}, {6, 16, 19}, {3, 45}, {
    12, 10, 19, 18}, {42, "IteratorCountI", 2, 0, 24, 2, 0, 14, 2, 0, 3}, {6, 
    16, 2}, {3, 40}, {12, 24, 2, 0}, {38, 7, 0, 11, 0, 18, 0, 0, 0, 35}, {12, 
    11, 29, 40}, {12, 18, 17, 39}, {12, 0, 25, 34}, {38, 7, 0, 40, 0, 39, 0, 
    34, 0, 41}, {38, 6, 0, 35, 0, 41, 0, 40}, {6, 40, 12}, {41, 263, 2, 0, 5, 
    2, 0, 13, 2, 0, 40}, {15, 31, 37, 33, 32, 35}, {12, 11, 16, 41}, {15, 41, 
    33, 32, 41}, {12, 18, 16, 39}, {15, 39, 32, 39}, {12, 0, 16, 34}, {12, 40,
     35, 41, 39, 34, 40}, {6, 40, 26}, {25, 4, 12, 5}, {2, 5, 11}, {38, 4, 0, 
    12, 1, 11, 1, 8}, {38, 7, 0, 11, 0, 18, 0, 0, 0, 40}, {12, 11, 29, 35}, {
    12, 18, 17, 41}, {12, 0, 25, 39}, {38, 7, 0, 35, 0, 41, 0, 39, 0, 34}, {
    34, 1, 2, 40, 34, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 0}, {5, 
    0, 1}, {3, 2}, {5, 2, 1}, {2, 1, 9}, {38, 10, 0, 26, 0, 9}, {38, 5, 0, 12,
     0, 4}, {13, 9, 4, 9}, {39, 10, 0, 26, 0, 9}, {6, 12, 40}, {12, 40, 1, 
    34}, {6, 34, 12}, {3, -21}, {4, 2, 3, -39}, {4, 19, 9, -44}, {4, 22, 
    23, -49}, {4, 31, 7, -81}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 31}, {12, 
    31, 16, 31}, {6, 16, 23}, {
    42, "IteratorCountI", 2, 0, 31, 2, 0, 1, 2, 0, 23, 2, 0, 22}, {6, 16, 
    11}, {3, 10}, {15, 11, 23, 9}, {12, 31, 9, 19}, {15, 5, 19, 9}, {38, 10, 
    0, 9, 0, 9}, {15, 5, 19, 9}, {12, 9, 1, 9}, {38, 10, 0, 9, 0, 4}, {13, 9, 
    4, 9}, {39, 10, 0, 19, 0, 9}, {4, 11, 22, -9}, {27, 3, 1, 2, 0, 1}, {2, 1,
     6}, {38, 10, 0, 1, 0, 9}, {10, 4, 4}, {27, 7, 1, 9, 4, 5}, {5, 5, 0}, {3,
     2}, {5, 2, 0}, {2, 0, 687}, {
    42, "RandomReal", 3, 0, 1, 3, 0, 5, 3, 0, 9}, {40, 34, 3, 0, 9, 3, 0, 
    4}, {19, 4, 9}, {38, 10, 0, 1, 0, 4}, {40, 60, 3, 0, 4, 3, 0, 3}, {16, 9, 
    3, 9}, {13, 2, 9, 3}, {27, 3, 1, 3, 0, 1}, {2, 1, 7}, {13, 2, 9, 3}, {7, 
    3, 2}, {6, 15, 7}, {12, 7, 1, 31}, {6, 31, 15}, {3, 3}, {7, 0, 2}, {3, 
    670}, {6, 1, 26}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 7}, {25, 26, 7, 1}, {
    2, 1, 16}, {42, "RandomReal", 3, 0, 1, 3, 0, 5, 3, 0, 3}, {38, 10, 0, 26, 
    0, 4}, {16, 3, 4, 3}, {15, 5, 26, 7}, {38, 10, 0, 7, 0, 4}, {27, 3, 1, 3, 
    4, 5}, {2, 5, 4}, {15, 5, 26, 7}, {6, 7, 23}, {3, 4}, {15, 5, 26, 31}, {
    12, 31, 1, 31}, {6, 31, 23}, {6, 23, 26}, {3, -17}, {6, 26, 23}, {41, 263,
     2, 0, 5, 2, 0, 13, 2, 0, 7}, {41, 258, 2, 0, 23, 2, 0, 7, 2, 0, 31}, {6, 
    31, 23}, {15, 37, 33, 32, 31}, {41, 262, 2, 0, 23, 2, 0, 31, 2, 0, 7}, {
    15, 7, 37, 33, 32, 31}, {41, 258, 2, 0, 23, 2, 0, 31, 2, 0, 22}, {6, 22, 
    23}, {15, 33, 32, 22}, {41, 262, 2, 0, 23, 2, 0, 22, 2, 0, 31}, {12, 31, 
    1, 31}, {12, 31, 16, 22}, {15, 22, 33, 32, 22}, {41, 258, 2, 0, 23, 2, 0, 
    22, 2, 0, 11}, {6, 11, 23}, {41, 262, 2, 0, 23, 2, 0, 32, 2, 0, 11}, {12, 
    11, 1, 11}, {12, 11, 16, 22}, {15, 22, 32, 22}, {41, 258, 2, 0, 23, 2, 0, 
    22, 2, 0, 19}, {6, 19, 23}, {12, 23, 1, 19}, {24, 7, 4, 1}, {2, 1, 192}, {
    38, 7, 0, 31, 0, 11, 0, 19, 0, 22}, {6, 22, 27}, {38, 3, 0, 27, 0, 22}, {
    6, 22, 12}, {42, "RandomReal", 3, 0, 1, 3, 0, 5, 3, 0, 3}, {38, 10, 0, 26,
     0, 4}, {16, 3, 4, 3}, {38, 2, 0, 12, 0, 4}, {27, 7, 1, 3, 4, 5}, {2, 5, 
    6}, {12, 12, 1, 22}, {38, 1, 0, 22, 0, 1, 0, 9}, {24, 9, 27, 3}, {5, 3, 
    6}, {3, 2}, {5, 2, 6}, {2, 6, 9}, {12, 12, 1, 9}, {38, 2, 0, 9, 0, 8}, {
    13, 4, 8, 6}, {7, 6, 4}, {6, 12, 9}, {12, 9, 1, 22}, {6, 22, 12}, {
    3, -16}, {38, 1, 0, 12, 0, 5, 0, 9}, {39, 7, 0, 31, 0, 11, 0, 19, 0, 9}, {
    38, 3, 0, 9, 0, 22}, {6, 22, 12}, {24, 12, 4, 6}, {2, 6, 4}, {10, 4, 7}, {
    7, 7, 8}, {3, 3}, {38, 2, 0, 12, 0, 6}, {7, 6, 8}, {39, 10, 0, 26, 0, 
    8}, {12, 12, 1, 22}, {38, 1, 0, 22, 0, 1, 0, 18}, {24, 18, 9, 6}, {2, 6, 
    10}, {38, 10, 0, 26, 0, 6}, {12, 12, 1, 18}, {38, 2, 0, 18, 0, 7}, {13, 6,
     7, 6}, {39, 10, 0, 26, 0, 6}, {6, 12, 18}, {12, 18, 1, 22}, {6, 22, 
    12}, {3, -12}, {25, 1, 26, 6}, {2, 6, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2,
     0, 18}, {6, 18, 26}, {15, 5, 26, 18}, {38, 10, 0, 18, 0, 6}, {15, 5, 26, 
    18}, {12, 18, 1, 18}, {38, 10, 0, 18, 0, 7}, {13, 6, 7, 6}, {39, 10, 0, 
    26, 0, 6}, {3, -11}, {6, 20, 18}, {6, 4, 22}, {3, 125}, {38, 9, 0, 22, 1, 
    8}, {33, 8, 3}, {24, 3, 21, 6}, {32, 6, 6}, {2, 6, 3}, {49}, {3, 1}, {37, 
    8, 1, 2, 3}, {6, 3, 29}, {37, 8, 5, 2, 3}, {6, 3, 17}, {37, 8, 21, 2, 
    3}, {6, 3, 25}, {12, 31, 29, 3}, {26, 1, 3, 37, 6}, {2, 6, 11}, {12, 11, 
    17, 3}, {26, 1, 3, 33, 5}, {2, 5, 5}, {12, 19, 25, 3}, {26, 1, 3, 32, 
    3}, {5, 3, 4}, {3, 2}, {5, 2, 4}, {5, 4, 5}, {3, 2}, {5, 2, 5}, {2, 5, 
    97}, {12, 31, 29, 3}, {12, 11, 17, 2}, {12, 19, 25, 0}, {38, 7, 0, 3, 0, 
    2, 0, 0, 0, 40}, {38, 6, 0, 9, 0, 40, 0, 3}, {6, 3, 12}, {41, 263, 2, 0, 
    5, 2, 0, 13, 2, 0, 3}, {15, 22, 37, 33, 32, 2}, {12, 31, 16, 0}, {15, 0, 
    33, 32, 0}, {12, 11, 16, 34}, {15, 34, 32, 34}, {12, 19, 16, 35}, {12, 3, 
    2, 0, 34, 35, 3}, {6, 3, 26}, {24, 12, 4, 6}, {2, 6, 4}, {10, 4, 10}, {7, 
    10, 7}, {3, 3}, {38, 5, 0, 12, 0, 6}, {7, 6, 7}, {39, 10, 0, 26, 0, 7}, {
    12, 12, 1, 3}, {38, 4, 0, 3, 1, 11, 1, 8}, {34, 1, 2, 9, 40, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 4}, {2, 
    4, 10}, {38, 10, 0, 26, 0, 6}, {12, 12, 1, 3}, {38, 5, 0, 3, 0, 10}, {13, 
    6, 10, 6}, {39, 10, 0, 26, 0, 6}, {6, 12, 3}, {12, 3, 1, 2}, {6, 2, 12}, {
    3, -13}, {25, 1, 26, 4}, {2, 4, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2, 0, 
    3}, {6, 3, 26}, {15, 5, 26, 3}, {38, 10, 0, 3, 0, 6}, {15, 5, 26, 3}, {12,
     3, 1, 3}, {38, 10, 0, 3, 0, 10}, {13, 6, 10, 6}, {39, 10, 0, 26, 0, 6}, {
    3, -11}, {38, 13, 0, 22, 0, 3}, {38, 6, 0, 40, 0, 9, 0, 2}, {6, 2, 12}, {
    41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 2}, {15, 3, 37, 33, 32, 0}, {12, 31, 29,
     16, 34}, {15, 34, 33, 32, 34}, {12, 11, 17, 16, 35}, {15, 35, 32, 35}, {
    12, 19, 25, 16, 41}, {12, 2, 0, 34, 35, 41, 2}, {6, 2, 26}, {24, 12, 4, 
    4}, {2, 4, 4}, {10, 4, 11}, {7, 11, 10}, {3, 3}, {38, 5, 0, 12, 0, 6}, {7,
     6, 10}, {39, 10, 0, 26, 0, 10}, {12, 12, 1, 2}, {38, 4, 0, 2, 1, 11, 1, 
    8}, {34, 1, 2, 40, 9, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 6}, {2, 
    6, 10}, {38, 10, 0, 26, 0, 6}, {12, 12, 1, 2}, {38, 5, 0, 2, 0, 11}, {13, 
    6, 11, 6}, {39, 10, 0, 26, 0, 6}, {6, 12, 2}, {12, 2, 1, 0}, {6, 0, 12}, {
    3, -13}, {25, 1, 26, 6}, {2, 6, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2, 0, 
    2}, {6, 2, 26}, {15, 5, 26, 2}, {38, 10, 0, 2, 0, 6}, {15, 5, 26, 2}, {12,
     2, 1, 2}, {38, 10, 0, 2, 0, 11}, {13, 6, 11, 6}, {39, 10, 0, 26, 0, 6}, {
    3, -11}, {3, 1}, {4, 22, 18, -124}, {3, 434}, {38, 9, 0, 7, 1, 8}, {33, 8,
     18}, {24, 18, 21, 5}, {32, 5, 5}, {2, 5, 3}, {49}, {3, 1}, {37, 8, 1, 2, 
    18}, {6, 18, 29}, {37, 8, 5, 2, 18}, {6, 18, 17}, {37, 8, 21, 2, 18}, {6, 
    18, 25}, {12, 31, 29, 18}, {12, 11, 17, 22}, {12, 19, 25, 2}, {34, 1, 3, 
    18, 22, 2, 2, 8}, {33, 8, 18}, {24, 18, 21, 5}, {32, 5, 5}, {2, 5, 3}, {
    49}, {3, 1}, {37, 8, 1, 2, 18}, {37, 8, 5, 2, 22}, {37, 8, 21, 2, 2}, {38,
     7, 0, 31, 0, 11, 0, 19, 0, 0}, {6, 0, 27}, {38, 7, 0, 18, 0, 22, 0, 2, 0,
     0}, {6, 0, 36}, {38, 6, 0, 27, 0, 36, 0, 0}, {6, 0, 12}, {
    42, "RandomReal", 3, 0, 1, 3, 0, 5, 3, 0, 8}, {38, 10, 0, 26, 0, 7}, {16, 
    8, 7, 8}, {7, 8, 3}, {38, 5, 0, 12, 0, 8}, {7, 8, 4}, {27, 7, 1, 3, 4, 
    5}, {2, 5, 7}, {12, 12, 1, 0}, {38, 4, 0, 0, 1, 11, 1, 8}, {34, 1, 2, 27, 
    36, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 4}, {5, 
    4, 6}, {3, 2}, {5, 2, 6}, {2, 6, 9}, {12, 12, 1, 0}, {38, 5, 0, 0, 0, 
    8}, {13, 4, 8, 7}, {7, 7, 4}, {6, 12, 0}, {12, 0, 1, 34}, {6, 34, 12}, {
    3, -17}, {38, 4, 0, 12, 1, 14, 1, 8}, {33, 8, 0}, {24, 0, 5, 6}, {32, 6, 
    6}, {2, 6, 3}, {49}, {3, 1}, {37, 8, 1, 2, 0}, {6, 0, 9}, {37, 8, 5, 2, 
    0}, {39, 7, 0, 31, 0, 11, 0, 19, 0, 9}, {12, 31, 29, 34}, {12, 11, 17, 
    35}, {12, 19, 25, 41}, {39, 7, 0, 34, 0, 35, 0, 41, 0, 0}, {24, 27, 9, 
    6}, {32, 6, 6}, {2, 6, 45}, {38, 3, 0, 9, 0, 34}, {6, 34, 12}, {41, 263, 
    2, 0, 5, 2, 0, 13, 2, 0, 34}, {12, 31, 16, 35}, {15, 35, 33, 32, 35}, {12,
     11, 16, 41}, {15, 41, 32, 41}, {12, 19, 16, 39}, {12, 34, 35, 41, 39, 
    34}, {6, 34, 26}, {24, 12, 4, 5}, {2, 5, 4}, {10, 4, 10}, {7, 10, 8}, {3, 
    3}, {38, 2, 0, 12, 0, 7}, {7, 7, 8}, {39, 10, 0, 26, 0, 8}, {12, 12, 1, 
    34}, {38, 1, 0, 34, 0, 1, 0, 35}, {24, 35, 9, 5}, {2, 5, 10}, {38, 10, 0, 
    26, 0, 7}, {12, 12, 1, 35}, {38, 2, 0, 35, 0, 10}, {13, 7, 10, 7}, {39, 
    10, 0, 26, 0, 7}, {6, 12, 35}, {12, 35, 1, 34}, {6, 34, 12}, {3, -12}, {
    25, 1, 26, 5}, {2, 5, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2, 0, 35}, {6, 35,
     26}, {15, 5, 26, 35}, {38, 10, 0, 35, 0, 7}, {15, 5, 26, 35}, {12, 35, 1,
     35}, {38, 10, 0, 35, 0, 10}, {13, 7, 10, 7}, {39, 10, 0, 26, 0, 7}, {
    3, -11}, {3, 1}, {24, 36, 0, 6}, {32, 6, 6}, {2, 6, 45}, {38, 3, 0, 0, 0, 
    35}, {6, 35, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 35}, {12, 18, 16, 
    34}, {15, 34, 33, 32, 34}, {12, 22, 16, 41}, {15, 41, 32, 41}, {12, 2, 16,
     39}, {12, 35, 34, 41, 39, 35}, {6, 35, 26}, {24, 12, 4, 5}, {2, 5, 4}, {
    10, 4, 10}, {7, 10, 7}, {3, 3}, {38, 2, 0, 12, 0, 8}, {7, 8, 7}, {39, 10, 
    0, 26, 0, 7}, {12, 12, 1, 35}, {38, 1, 0, 35, 0, 1, 0, 34}, {24, 34, 0, 
    5}, {2, 5, 10}, {38, 10, 0, 26, 0, 8}, {12, 12, 1, 34}, {38, 2, 0, 34, 0, 
    10}, {13, 8, 10, 8}, {39, 10, 0, 26, 0, 8}, {6, 12, 34}, {12, 34, 1, 
    35}, {6, 35, 12}, {3, -12}, {25, 1, 26, 5}, {2, 5, 11}, {41, 262, 2, 0, 
    26, 2, 0, 5, 2, 0, 34}, {6, 34, 26}, {15, 5, 26, 34}, {38, 10, 0, 34, 0, 
    8}, {15, 5, 26, 34}, {12, 34, 1, 34}, {38, 10, 0, 34, 0, 10}, {13, 8, 10, 
    8}, {39, 10, 0, 26, 0, 8}, {3, -11}, {3, 1}, {24, 27, 9, 6}, {32, 6, 6}, {
    2, 6, 132}, {6, 20, 34}, {6, 4, 35}, {3, 127}, {38, 9, 0, 35, 1, 8}, {33, 
    8, 41}, {24, 41, 21, 5}, {32, 5, 5}, {2, 5, 3}, {49}, {3, 1}, {37, 8, 1, 
    2, 41}, {6, 41, 29}, {37, 8, 5, 2, 41}, {6, 41, 17}, {37, 8, 21, 2, 41}, {
    6, 41, 25}, {12, 31, 29, 41}, {26, 1, 41, 37, 5}, {2, 5, 11}, {12, 11, 17,
     41}, {26, 1, 41, 33, 4}, {2, 4, 5}, {12, 19, 25, 41}, {26, 1, 41, 32, 
    3}, {5, 3, 7}, {3, 2}, {5, 2, 7}, {5, 7, 4}, {3, 2}, {5, 2, 4}, {2, 4, 
    99}, {12, 31, 29, 41}, {12, 11, 17, 39}, {12, 19, 25, 44}, {38, 7, 0, 41, 
    0, 39, 0, 44, 0, 45}, {6, 45, 40}, {38, 6, 0, 9, 0, 40, 0, 45}, {6, 45, 
    12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 45}, {15, 35, 37, 33, 32, 41}, {
    12, 31, 16, 39}, {15, 39, 33, 32, 39}, {12, 11, 16, 44}, {15, 44, 32, 
    44}, {12, 19, 16, 46}, {12, 45, 41, 39, 44, 46, 45}, {6, 45, 26}, {24, 12,
     4, 5}, {2, 5, 4}, {10, 4, 10}, {7, 10, 8}, {3, 3}, {38, 5, 0, 12, 0, 
    7}, {7, 7, 8}, {39, 10, 0, 26, 0, 8}, {12, 12, 1, 45}, {38, 4, 0, 45, 1, 
    11, 1, 8}, {34, 1, 2, 9, 40, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 7}, {2, 
    7, 10}, {38, 10, 0, 26, 0, 7}, {12, 12, 1, 45}, {38, 5, 0, 45, 0, 10}, {
    13, 7, 10, 7}, {39, 10, 0, 26, 0, 7}, {6, 12, 45}, {12, 45, 1, 41}, {6, 
    41, 12}, {3, -13}, {25, 1, 26, 7}, {2, 7, 11}, {41, 262, 2, 0, 26, 2, 0, 
    5, 2, 0, 45}, {6, 45, 26}, {15, 5, 26, 45}, {38, 10, 0, 45, 0, 7}, {15, 5,
     26, 45}, {12, 45, 1, 45}, {38, 10, 0, 45, 0, 10}, {13, 7, 10, 7}, {39, 
    10, 0, 26, 0, 7}, {3, -11}, {38, 13, 0, 35, 0, 45}, {6, 45, 3}, {38, 6, 0,
     40, 0, 9, 0, 45}, {6, 45, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 45}, {
    15, 3, 37, 33, 32, 41}, {12, 31, 29, 16, 39}, {15, 39, 33, 32, 39}, {12, 
    11, 17, 16, 44}, {15, 44, 32, 44}, {12, 19, 25, 16, 46}, {12, 45, 41, 39, 
    44, 46, 45}, {6, 45, 26}, {24, 12, 4, 7}, {2, 7, 4}, {10, 4, 6}, {7, 6, 
    10}, {3, 3}, {38, 5, 0, 12, 0, 7}, {7, 7, 10}, {39, 10, 0, 26, 0, 10}, {
    12, 12, 1, 45}, {38, 4, 0, 45, 1, 11, 1, 8}, {34, 1, 2, 40, 9, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 5}, {2, 
    5, 10}, {38, 10, 0, 26, 0, 7}, {12, 12, 1, 45}, {38, 5, 0, 45, 0, 6}, {13,
     7, 6, 7}, {39, 10, 0, 26, 0, 7}, {6, 12, 45}, {12, 45, 1, 41}, {6, 41, 
    12}, {3, -13}, {25, 1, 26, 5}, {2, 5, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2,
     0, 45}, {6, 45, 26}, {15, 5, 26, 45}, {38, 10, 0, 45, 0, 7}, {15, 5, 26, 
    45}, {12, 45, 1, 45}, {38, 10, 0, 45, 0, 6}, {13, 7, 6, 7}, {39, 10, 0, 
    26, 0, 7}, {3, -11}, {3, 1}, {4, 35, 34, -126}, {3, 1}, {24, 36, 0, 6}, {
    32, 6, 6}, {2, 6, 132}, {6, 20, 34}, {6, 4, 35}, {3, 127}, {38, 9, 0, 35, 
    1, 8}, {33, 8, 45}, {24, 45, 21, 4}, {32, 4, 4}, {2, 4, 3}, {49}, {3, 
    1}, {37, 8, 1, 2, 45}, {6, 45, 29}, {37, 8, 5, 2, 45}, {6, 45, 17}, {37, 
    8, 21, 2, 45}, {6, 45, 25}, {12, 18, 29, 45}, {26, 1, 45, 37, 4}, {2, 4, 
    11}, {12, 22, 17, 45}, {26, 1, 45, 33, 5}, {2, 5, 5}, {12, 2, 25, 45}, {
    26, 1, 45, 32, 7}, {5, 7, 3}, {3, 2}, {5, 2, 3}, {5, 3, 5}, {3, 2}, {5, 2,
     5}, {2, 5, 99}, {12, 18, 29, 45}, {12, 22, 17, 41}, {12, 2, 25, 39}, {38,
     7, 0, 45, 0, 41, 0, 39, 0, 44}, {6, 44, 40}, {38, 6, 0, 0, 0, 40, 0, 
    44}, {6, 44, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 44}, {15, 35, 37, 33,
     32, 45}, {12, 18, 16, 41}, {15, 41, 33, 32, 41}, {12, 22, 16, 39}, {15, 
    39, 32, 39}, {12, 2, 16, 46}, {12, 44, 45, 41, 39, 46, 44}, {6, 44, 26}, {
    24, 12, 4, 4}, {2, 4, 4}, {10, 4, 7}, {7, 7, 10}, {3, 3}, {38, 5, 0, 12, 
    0, 8}, {7, 8, 10}, {39, 10, 0, 26, 0, 10}, {12, 12, 1, 44}, {38, 4, 0, 44,
     1, 11, 1, 8}, {34, 1, 2, 0, 40, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 3}, {2, 
    3, 10}, {38, 10, 0, 26, 0, 8}, {12, 12, 1, 44}, {38, 5, 0, 44, 0, 7}, {13,
     8, 7, 8}, {39, 10, 0, 26, 0, 8}, {6, 12, 44}, {12, 44, 1, 45}, {6, 45, 
    12}, {3, -13}, {25, 1, 26, 3}, {2, 3, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2,
     0, 44}, {6, 44, 26}, {15, 5, 26, 44}, {38, 10, 0, 44, 0, 8}, {15, 5, 26, 
    44}, {12, 44, 1, 44}, {38, 10, 0, 44, 0, 7}, {13, 8, 7, 8}, {39, 10, 0, 
    26, 0, 8}, {3, -11}, {38, 13, 0, 35, 0, 44}, {6, 44, 3}, {38, 6, 0, 40, 0,
     0, 0, 44}, {6, 44, 12}, {41, 263, 2, 0, 5, 2, 0, 13, 2, 0, 44}, {15, 3, 
    37, 33, 32, 45}, {12, 18, 29, 16, 41}, {15, 41, 33, 32, 41}, {12, 22, 17, 
    16, 39}, {15, 39, 32, 39}, {12, 2, 25, 16, 46}, {12, 44, 45, 41, 39, 46, 
    44}, {6, 44, 26}, {24, 12, 4, 3}, {2, 3, 4}, {10, 4, 6}, {7, 6, 7}, {3, 
    3}, {38, 5, 0, 12, 0, 8}, {7, 8, 7}, {39, 10, 0, 26, 0, 7}, {12, 12, 1, 
    44}, {38, 4, 0, 44, 1, 11, 1, 8}, {34, 1, 2, 40, 0, 2, 15}, {
    42, "CompareTensor", 2, 0, 38, 3, 0, 1, 2, 1, 8, 2, 1, 15, 1, 0, 4}, {2, 
    4, 10}, {38, 10, 0, 26, 0, 8}, {12, 12, 1, 44}, {38, 5, 0, 44, 0, 6}, {13,
     8, 6, 8}, {39, 10, 0, 26, 0, 8}, {6, 12, 44}, {12, 44, 1, 45}, {6, 45, 
    12}, {3, -13}, {25, 1, 26, 4}, {2, 4, 11}, {41, 262, 2, 0, 26, 2, 0, 5, 2,
     0, 44}, {6, 44, 26}, {15, 5, 26, 44}, {38, 10, 0, 44, 0, 8}, {15, 5, 26, 
    44}, {12, 44, 1, 44}, {38, 10, 0, 44, 0, 6}, {13, 8, 6, 8}, {39, 10, 0, 
    26, 0, 8}, {3, -11}, {3, 1}, {4, 35, 34, -126}, {3, 1}, {3, -694}, {38, 
    10, 0, 1, 0, 10}, {27, 5, 1, 10, 1, 0}, {9, 0, 34}, {7, 2, 10}, {6, 42, 
    35}, {6, 4, 45}, {35, 35, 2, 8}, {6, 4, 44}, {3, 10}, {40, 50, 3, 0, 10, 
    2, 0, 39}, {10, 43, 7}, {16, 7, 10, 7}, {15, 43, 39, 41}, {18, 41, 46}, {
    10, 46, 8}, {13, 7, 8, 7}, {7, 7, 10}, {36, 45, 39, 2, 8}, {4, 44, 
    35, -9}, {42, "Flatten", 2, 3, 7, 2, 0, 5, 2, 1, 15}, {
    42, "Join", 2, 1, 15, 2, 1, 8, 2, 1, 12}, {34, 1, 2, 15, 34, 2, 15}, {
    42, "Join", 2, 1, 12, 2, 1, 15, 2, 1, 17}, {1}}, 
   Function[{$CellContext`space, $CellContext`unireactions, \
$CellContext`unirates, $CellContext`uniindex, $CellContext`bireactions, \
$CellContext`birates, $CellContext`biindex, $CellContext`tmax}, 
    Module[{$CellContext`d = Length[$CellContext`space], $CellContext`n = 
      Length[
        First[$CellContext`space]], $CellContext`m = Length[
        First[
         First[$CellContext`space]]], $CellContext`d1, $CellContext`d2, \
$CellContext`n1, $CellContext`n2, $CellContext`m1, $CellContext`m2, \
$CellContext`S = $CellContext`space, $CellContext`R, $CellContext`id, \
$CellContext`idd, 
      K, $CellContext`nb, $CellContext`nbnb, $CellContext`i, $CellContext`j, \
$CellContext`k, $CellContext`i2, $CellContext`j2, $CellContext`k2, \
$CellContext`di, $CellContext`dj, $CellContext`dk, $CellContext`r, \
$CellContext`s1 = 1, $CellContext`s2 = 
      1, $CellContext`snb, $CellContext`new1, $CellContext`new2, \
$CellContext`ksum, $CellContext`newp, $CellContext`t = 
      0., $CellContext`dt, $CellContext`events = 
      0, $CellContext`haltedq, $CellContext`digit, $CellContext`digits, \
$CellContext`residue}, K = Ceiling[
        Log[
        2, 1 + 7 $CellContext`d $CellContext`n $CellContext`m]]; \
$CellContext`R = Table[0., {2^(K + 1)}]; 
     Do[$CellContext`r = Part[$CellContext`uniindex, 
          
          Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]]; $CellContext`id = 
        2^K + ($CellContext`i - 
           1) $CellContext`n $CellContext`m + ($CellContext`j - 
           1) $CellContext`m + ($CellContext`k - 1); While[
         And[$CellContext`r > 0, 
          Part[$CellContext`unireactions, $CellContext`r, 1] == 
          Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]], AddTo[
           Part[$CellContext`R, $CellContext`id], 
           Part[$CellContext`unirates, $CellContext`r]]; 
         Increment[$CellContext`r]], {$CellContext`i, $CellContext`d}, \
{$CellContext`j, $CellContext`n}, {$CellContext`k, $CellContext`m}]; 
     Do[{$CellContext`di, $CellContext`dj, $CellContext`dk} = 
        Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {0, 0,
           1}}, $CellContext`nb]; $CellContext`d1 = 
        Max[1, 1 - $CellContext`di]; $CellContext`d2 = 
        Min[$CellContext`d, $CellContext`d - $CellContext`di]; \
$CellContext`n1 = Max[1, 1 - $CellContext`dj]; $CellContext`n2 = 
        Min[$CellContext`n, $CellContext`n - $CellContext`dj]; \
$CellContext`m1 = Max[1, 1 - $CellContext`dk]; $CellContext`m2 = 
        Min[$CellContext`m, $CellContext`m - $CellContext`dk]; 
       Do[$CellContext`r = Part[$CellContext`biindex, 
            
            Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k], 
            
            Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]]; \
$CellContext`id = 
          2^K + $CellContext`nb $CellContext`d $CellContext`n $CellContext`m + \
($CellContext`i - 1) $CellContext`n $CellContext`m + ($CellContext`j - 
             1) $CellContext`m + ($CellContext`k - 1); While[
           
           And[$CellContext`r > 0, 
            Part[$CellContext`bireactions, $CellContext`r, {1, 2}] == {
              
              Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k], 
              
              Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]}], AddTo[
             Part[$CellContext`R, $CellContext`id], 
             Part[$CellContext`birates, $CellContext`r]]; 
           Increment[$CellContext`r]], {$CellContext`i, $CellContext`d1, \
$CellContext`d2}, {$CellContext`j, $CellContext`n1, $CellContext`n2}, \
{$CellContext`k, $CellContext`m1, $CellContext`m2}], {$CellContext`nb, 1, 6}]; 
     Do[Part[$CellContext`R, $CellContext`id] = 
       Part[$CellContext`R, 2 $CellContext`id] + 
        Part[$CellContext`R, 2 $CellContext`id + 1], {$CellContext`id, 2^K - 
        1, 1, -1}]; While[
       And[$CellContext`t < $CellContext`tmax, Part[$CellContext`R, 1] > 
        0], $CellContext`dt = (-Log[
            RandomReal[]])/Part[$CellContext`R, 1]; 
       If[$CellContext`t + $CellContext`dt < $CellContext`tmax, 
         AddTo[$CellContext`t, $CellContext`dt]; 
         Increment[$CellContext`events], $CellContext`t = $CellContext`tmax; 
         Break[]]; $CellContext`id = 1; 
       While[$CellContext`id < 2^K, $CellContext`id = 
         If[RandomReal[] Part[$CellContext`R, $CellContext`id] < 
           Part[$CellContext`R, 2 $CellContext`id], 2 $CellContext`id, 
           2 $CellContext`id + 1]]; $CellContext`idd = $CellContext`id; 
       SubtractFrom[$CellContext`idd, 2^K]; $CellContext`nb = 
        Quotient[$CellContext`idd, $CellContext`d $CellContext`n \
$CellContext`m]; 
       SubtractFrom[$CellContext`idd, $CellContext`nb $CellContext`d \
$CellContext`n $CellContext`m]; $CellContext`i = 
        Quotient[$CellContext`idd, $CellContext`n $CellContext`m] + 1; 
       SubtractFrom[$CellContext`idd, ($CellContext`i - 
          1) $CellContext`n $CellContext`m]; $CellContext`j = 
        Quotient[$CellContext`idd, $CellContext`m] + 1; 
       SubtractFrom[$CellContext`idd, ($CellContext`j - 
          1) $CellContext`m]; $CellContext`k = $CellContext`idd + 1; 
       If[$CellContext`nb == 
         0, $CellContext`s1 = 
          Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]; $CellContext`r = 
          Part[$CellContext`uniindex, $CellContext`s1]; $CellContext`newp = 
          RandomReal[] 
           Part[$CellContext`R, $CellContext`id]; $CellContext`ksum = 
          Part[$CellContext`unirates, $CellContext`r]; While[
           
           And[$CellContext`newp > $CellContext`ksum, 
            Part[$CellContext`unireactions, $CellContext`r + 1, 
              1] == $CellContext`s1], AddTo[$CellContext`ksum, 
             Part[$CellContext`unirates, $CellContext`r + 1]]; 
           Increment[$CellContext`r]]; $CellContext`new1 = 
          Part[$CellContext`unireactions, $CellContext`r, 2]; 
         Part[$CellContext`S, $CellContext`i, $CellContext`j, $CellContext`k] = \
$CellContext`new1; $CellContext`r = 
          Part[$CellContext`uniindex, $CellContext`new1]; 
         Part[$CellContext`R, $CellContext`id] = If[$CellContext`r == 0, 0, 
            Part[$CellContext`unirates, $CellContext`r]]; 
         While[Part[$CellContext`unireactions, $CellContext`r + 1, 
             1] == $CellContext`new1, AddTo[
             Part[$CellContext`R, $CellContext`id], 
             Part[$CellContext`unirates, $CellContext`r + 1]]; 
           Increment[$CellContext`r]]; 
         While[$CellContext`id > 
           1, $CellContext`id = Quotient[$CellContext`id, 2]; 
           Part[$CellContext`R, $CellContext`id] = 
            Part[$CellContext`R, 2 $CellContext`id] + 
             Part[$CellContext`R, 2 $CellContext`id + 1]]; 
         Do[{$CellContext`di, $CellContext`dj, $CellContext`dk} = 
            Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {
              0, 0, 1}}, $CellContext`nb]; If[
             And[
             1 <= $CellContext`i + $CellContext`di <= $CellContext`d, 
              1 <= $CellContext`j + $CellContext`dj <= $CellContext`n, 
              1 <= $CellContext`k + $CellContext`dk <= $CellContext`m], \
$CellContext`snb = 
              Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]; \
$CellContext`r = 
              Part[$CellContext`biindex, $CellContext`new1, $CellContext`snb]; \
$CellContext`id = 
              2^K + $CellContext`nb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i - 
                 1) $CellContext`n $CellContext`m + ($CellContext`j - 
                 1) $CellContext`m + ($CellContext`k - 1); 
             Part[$CellContext`R, $CellContext`id] = 
              If[$CellContext`r == 0, 0, 
                Part[$CellContext`birates, $CellContext`r]]; 
             While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                 2}] == {$CellContext`new1, $CellContext`snb}, AddTo[
                 Part[$CellContext`R, $CellContext`id], 
                 Part[$CellContext`birates, $CellContext`r + 1]]; 
               Increment[$CellContext`r]]; 
             While[$CellContext`id > 
               1, $CellContext`id = Quotient[$CellContext`id, 2]; 
               Part[$CellContext`R, $CellContext`id] = 
                Part[$CellContext`R, 2 $CellContext`id] + 
                 Part[$CellContext`R, 2 $CellContext`id + 
                   1]]; $CellContext`nbnb = 
              Part[{2, 1, 4, 3, 6, 5}, $CellContext`nb]; $CellContext`r = 
              Part[$CellContext`biindex, $CellContext`snb, $CellContext`new1]; \
$CellContext`id = 
              2^K + $CellContext`nbnb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i + $CellContext`di - 
                 1) $CellContext`n $CellContext`m + ($CellContext`j + \
$CellContext`dj - 1) $CellContext`m + ($CellContext`k + $CellContext`dk - 1); 
             Part[$CellContext`R, $CellContext`id] = 
              If[$CellContext`r == 0, 0, 
                Part[$CellContext`birates, $CellContext`r]]; 
             While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                 2}] == {$CellContext`snb, $CellContext`new1}, AddTo[
                 Part[$CellContext`R, $CellContext`id], 
                 Part[$CellContext`birates, $CellContext`r + 1]]; 
               Increment[$CellContext`r]]; 
             While[$CellContext`id > 
               1, $CellContext`id = Quotient[$CellContext`id, 2]; 
               Part[$CellContext`R, $CellContext`id] = 
                Part[$CellContext`R, 2 $CellContext`id] + 
                 Part[$CellContext`R, 2 $CellContext`id + 
                   1]]], {$CellContext`nb, 1, 
            6}], {$CellContext`di, $CellContext`dj, $CellContext`dk} = 
          Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {0, 
            0, 1}}, $CellContext`nb]; {$CellContext`i2, $CellContext`j2, \
$CellContext`k2} = {$CellContext`i + $CellContext`di, $CellContext`j + \
$CellContext`dj, $CellContext`k + $CellContext`dk}; $CellContext`s1 = 
          Part[$CellContext`S, $CellContext`i, $CellContext`j, \
$CellContext`k]; $CellContext`s2 = 
          Part[$CellContext`S, $CellContext`i2, $CellContext`j2, \
$CellContext`k2]; $CellContext`r = 
          Part[$CellContext`biindex, $CellContext`s1, $CellContext`s2]; \
$CellContext`newp = 
          RandomReal[] 
           Part[$CellContext`R, $CellContext`id]; $CellContext`ksum = 
          Part[$CellContext`birates, $CellContext`r]; While[
           
           And[$CellContext`newp > $CellContext`ksum, 
            Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
              2}] == {$CellContext`s1, $CellContext`s2}], 
           AddTo[$CellContext`ksum, 
             Part[$CellContext`birates, $CellContext`r + 1]]; 
           Increment[$CellContext`r]]; {$CellContext`new1, $CellContext`new2} = 
          Part[$CellContext`bireactions, $CellContext`r, {3, 4}]; 
         Part[$CellContext`S, $CellContext`i, $CellContext`j, $CellContext`k] = \
$CellContext`new1; 
         Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk] = \
$CellContext`new2; 
         If[$CellContext`s1 != $CellContext`new1, $CellContext`r = 
            Part[$CellContext`uniindex, $CellContext`new1]; $CellContext`id = 
            2^K + ($CellContext`i - 
               1) $CellContext`n $CellContext`m + ($CellContext`j - 
               1) $CellContext`m + ($CellContext`k - 1); 
           Part[$CellContext`R, $CellContext`id] = 
            If[$CellContext`r == 0, 0, 
              Part[$CellContext`unirates, $CellContext`r]]; 
           While[Part[$CellContext`unireactions, $CellContext`r + 1, 
               1] == $CellContext`new1, AddTo[
               Part[$CellContext`R, $CellContext`id], 
               Part[$CellContext`unirates, $CellContext`r + 1]]; 
             Increment[$CellContext`r]]; 
           While[$CellContext`id > 
             1, $CellContext`id = Quotient[$CellContext`id, 2]; 
             Part[$CellContext`R, $CellContext`id] = 
              Part[$CellContext`R, 2 $CellContext`id] + 
               Part[$CellContext`R, 2 $CellContext`id + 1]]]; 
         If[$CellContext`s2 != $CellContext`new2, $CellContext`r = 
            Part[$CellContext`uniindex, $CellContext`new2]; $CellContext`id = 
            2^K + ($CellContext`i2 - 
               1) $CellContext`n $CellContext`m + ($CellContext`j2 - 
               1) $CellContext`m + ($CellContext`k2 - 1); 
           Part[$CellContext`R, $CellContext`id] = 
            If[$CellContext`r == 0, 0, 
              Part[$CellContext`unirates, $CellContext`r]]; 
           While[Part[$CellContext`unireactions, $CellContext`r + 1, 
               1] == $CellContext`new2, AddTo[
               Part[$CellContext`R, $CellContext`id], 
               Part[$CellContext`unirates, $CellContext`r + 1]]; 
             Increment[$CellContext`r]]; 
           While[$CellContext`id > 
             1, $CellContext`id = Quotient[$CellContext`id, 2]; 
             Part[$CellContext`R, $CellContext`id] = 
              Part[$CellContext`R, 2 $CellContext`id] + 
               Part[$CellContext`R, 2 $CellContext`id + 1]]]; 
         If[$CellContext`s1 != $CellContext`new1, 
           
           Do[{$CellContext`di, $CellContext`dj, $CellContext`dk} = 
             Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {
               0, 0, 1}}, $CellContext`nb]; If[
              And[
              1 <= $CellContext`i + $CellContext`di <= $CellContext`d, 
               1 <= $CellContext`j + $CellContext`dj <= $CellContext`n, 
               1 <= $CellContext`k + $CellContext`dk <= $CellContext`m], \
$CellContext`snb = 
               Part[$CellContext`S, $CellContext`i + $CellContext`di, \
$CellContext`j + $CellContext`dj, $CellContext`k + $CellContext`dk]; \
$CellContext`r = 
               Part[$CellContext`biindex, $CellContext`new1, \
$CellContext`snb]; $CellContext`id = 
               2^K + $CellContext`nb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i - 
                  1) $CellContext`n $CellContext`m + ($CellContext`j - 
                  1) $CellContext`m + ($CellContext`k - 1); 
              Part[$CellContext`R, $CellContext`id] = 
               If[$CellContext`r == 0, 0, 
                 Part[$CellContext`birates, $CellContext`r]]; 
              While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                  2}] == {$CellContext`new1, $CellContext`snb}, AddTo[
                  Part[$CellContext`R, $CellContext`id], 
                  Part[$CellContext`birates, $CellContext`r + 1]]; 
                Increment[$CellContext`r]]; 
              While[$CellContext`id > 
                1, $CellContext`id = Quotient[$CellContext`id, 2]; 
                Part[$CellContext`R, $CellContext`id] = 
                 Part[$CellContext`R, 2 $CellContext`id] + 
                  Part[$CellContext`R, 2 $CellContext`id + 
                    1]]; $CellContext`nbnb = 
               Part[{2, 1, 4, 3, 6, 5}, $CellContext`nb]; $CellContext`r = 
               Part[$CellContext`biindex, $CellContext`snb, \
$CellContext`new1]; $CellContext`id = 
               2^K + $CellContext`nbnb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i + $CellContext`di - 
                  1) $CellContext`n $CellContext`m + ($CellContext`j + \
$CellContext`dj - 1) $CellContext`m + ($CellContext`k + $CellContext`dk - 1); 
              Part[$CellContext`R, $CellContext`id] = 
               If[$CellContext`r == 0, 0, 
                 Part[$CellContext`birates, $CellContext`r]]; 
              While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                  2}] == {$CellContext`snb, $CellContext`new1}, AddTo[
                  Part[$CellContext`R, $CellContext`id], 
                  Part[$CellContext`birates, $CellContext`r + 1]]; 
                Increment[$CellContext`r]]; 
              While[$CellContext`id > 
                1, $CellContext`id = Quotient[$CellContext`id, 2]; 
                Part[$CellContext`R, $CellContext`id] = 
                 Part[$CellContext`R, 2 $CellContext`id] + 
                  Part[$CellContext`R, 2 $CellContext`id + 
                    1]]], {$CellContext`nb, 1, 6}]]; 
         If[$CellContext`s2 != $CellContext`new2, 
           
           Do[{$CellContext`di, $CellContext`dj, $CellContext`dk} = 
             Part[{{-1, 0, 0}, {1, 0, 0}, {0, -1, 0}, {0, 1, 0}, {0, 0, -1}, {
               0, 0, 1}}, $CellContext`nb]; If[
              And[
              1 <= $CellContext`i2 + $CellContext`di <= $CellContext`d, 
               1 <= $CellContext`j2 + $CellContext`dj <= $CellContext`n, 
               1 <= $CellContext`k2 + $CellContext`dk <= $CellContext`m], \
$CellContext`snb = 
               Part[$CellContext`S, $CellContext`i2 + $CellContext`di, \
$CellContext`j2 + $CellContext`dj, $CellContext`k2 + $CellContext`dk]; \
$CellContext`r = 
               Part[$CellContext`biindex, $CellContext`new2, \
$CellContext`snb]; $CellContext`id = 
               2^K + $CellContext`nb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i2 - 
                  1) $CellContext`n $CellContext`m + ($CellContext`j2 - 
                  1) $CellContext`m + ($CellContext`k2 - 1); 
              Part[$CellContext`R, $CellContext`id] = 
               If[$CellContext`r == 0, 0, 
                 Part[$CellContext`birates, $CellContext`r]]; 
              While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                  2}] == {$CellContext`new2, $CellContext`snb}, AddTo[
                  Part[$CellContext`R, $CellContext`id], 
                  Part[$CellContext`birates, $CellContext`r + 1]]; 
                Increment[$CellContext`r]]; 
              While[$CellContext`id > 
                1, $CellContext`id = Quotient[$CellContext`id, 2]; 
                Part[$CellContext`R, $CellContext`id] = 
                 Part[$CellContext`R, 2 $CellContext`id] + 
                  Part[$CellContext`R, 2 $CellContext`id + 
                    1]]; $CellContext`nbnb = 
               Part[{2, 1, 4, 3, 6, 5}, $CellContext`nb]; $CellContext`r = 
               Part[$CellContext`biindex, $CellContext`snb, \
$CellContext`new2]; $CellContext`id = 
               2^K + $CellContext`nbnb $CellContext`d $CellContext`n \
$CellContext`m + ($CellContext`i2 + $CellContext`di - 
                  1) $CellContext`n $CellContext`m + ($CellContext`j2 + \
$CellContext`dj - 1) $CellContext`m + ($CellContext`k2 + $CellContext`dk - 1); 
              Part[$CellContext`R, $CellContext`id] = 
               If[$CellContext`r == 0, 0, 
                 Part[$CellContext`birates, $CellContext`r]]; 
              While[Part[$CellContext`bireactions, $CellContext`r + 1, {1, 
                  2}] == {$CellContext`snb, $CellContext`new2}, AddTo[
                  Part[$CellContext`R, $CellContext`id], 
                  Part[$CellContext`birates, $CellContext`r + 1]]; 
                Increment[$CellContext`r]]; 
              While[$CellContext`id > 
                1, $CellContext`id = Quotient[$CellContext`id, 2]; 
                Part[$CellContext`R, $CellContext`id] = 
                 Part[$CellContext`R, 2 $CellContext`id] + 
                  Part[$CellContext`R, 2 $CellContext`id + 
                    1]]], {$CellContext`nb, 1, 6}]]; Null]; 
       Null]; $CellContext`haltedq = 
      Boole[Part[$CellContext`R, 1] == 
        0.]; $CellContext`residue = $CellContext`t; $CellContext`digits = 
      Table[$CellContext`digit = 
         Floor[$CellContext`residue]; $CellContext`residue = 
         10 $CellContext`residue - 
          10 $CellContext`digit; $CellContext`digit, {20}]; Join[
       Join[
        Flatten[$CellContext`S], $CellContext`digits], {$CellContext`events, \
$CellContext`haltedq}]]], Evaluate, 
   LibraryFunction[
   "/Users/winfree/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/EriksMBlame2018-26744/compiledFunction4.dylib", 
    "compiledFunction4", {{Integer, 3, "Constant"}, {
     Integer, 2, "Constant"}, {Real, 1, "Constant"}, {
     Integer, 1, "Constant"}, {Integer, 2, "Constant"}, {
     Real, 1, "Constant"}, {Integer, 2, "Constant"}, {Real, 0, "Constant"}}, {
    Integer, 1}]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.829421645375489*^9, 3.829421672512281*^9}, 
   3.829426503734668*^9, 3.829503658877701*^9, 3.829697833158053*^9, 
   3.829765145103839*^9, 3.829765222924259*^9, 3.829770294930331*^9, 
   3.8319994627723923`*^9, {3.8326365685463533`*^9, 3.832636570646728*^9}, 
   3.833327834592724*^9, 3.846111419676952*^9, 3.8461162394690228`*^9, 
   3.8568035807804203`*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"0dbd6662-4297-42d0-ad55-505e271db24e"]
}, Open  ]],

Cell["Test on diffusion-limited aggregation.", "Text",
 CellChangeTimes->CompressedData["
1:eJwd0ttLmnEAh3HxIlpTL2xNixkLsmXzIlqjGCN6hxS01kW0u+iwg8KMCtmg
xQtzw7La1rlNRfIi10IqzSFJdLAiB1nbzLlgldCEFHKz07yILft934uHzz/w
ZDxoqnzMZrFYYhIcsyQehFoilIuKHcJyaUUMrmWqGHlGyxn/eYQq/jnDTiZe
1s2KobFLLoGtG+NK+CHjfwOs0wSzCokpb9clMGd6zl9EVHQHN+Ftz+FQE9Hs
u/YeutjVGp82QumP7nVAdQ6d7ycabiTdhJcaN8oh32argIH2vuVN4vXtMTe8
Imyd3SU2v8mcg7eSZYtQaoz74B29dxu2SOl9GN8XnUC+PTsGTcPSU1j5bDXh
F/Ff6ehFeJSmTYXVqp0BqH4qt8DhsG0SNseVVlgyv+eAsrbEBeh8cUEYJH6p
+XwVznzj5cFHuYUFkM7+q94jCtxPBmFQLzRATpnmE6TLPFEod/kZo7wf90PE
+a/hevhHvqyA6UucBhh6GHkF+ceeLmi2v+6BU7Xr/bA73aGDVaNeRqdy1wRH
TFtmyPUWd54R2wQfGRNWvLncDvIBNVEAneN338EsEc8A63+PTPQR6e9WxjTt
cY+d+JIK9MJzilxO8g==
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"46721fdf-2066-4b1b-b874-22b017fbed8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fasterDLAcrn", "=", 
   RowBox[{"PreprocessFasterSurfaceCRN", "[", 
    RowBox[{"DLAcrn", ",", 
     RowBox[{"{", "init2D", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2space", "=", 
   RowBox[{"Convert2FasterSpace", "[", 
    RowBox[{
     RowBox[{"{", "init2D", "}"}], ",", "fasterDLAcrn"}], "]"}]}], ";", " ", 
  RowBox[{"f2time", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2coloring", "=", 
   RowBox[{"Convert2FasterColoring", "[", 
    RowBox[{"coloring2D", ",", "fasterDLAcrn"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"First", "[", "f2space", "]"}], ",", 
    RowBox[{"ColorRules", "\[Rule]", "f2coloring"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "f2time"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQPbGAq6ui6Y3jtyMHwfQp/+nTKoG00U73OSB6iXP/
BRDNt/Y7mJ5S9XyqZ8sbxz6h2Bkg2ofr0TwQPWXmtvkgWsbwxjoQzfRAawOI
5k8oUPUC0kbH6tVAdNecvfogekblRVMQ/fbRJEsQHfVDygZEn5n62wtEH/nA
7Q2iLx1+VgOi9y35CKY/GAg3g2ixi8rtIFqlqj7hIJDOu8ySCKJPsD6Zd739
jWNA4JbFIHr6Vd2NIFp8guZWEC12tofrPpAua8vlAdFC3ZNtQPSdDXPBtDlP
huULIL1UuBxMn+DRFeTtALrvMZcYiI5oEuMXANJLjj0H00WOqiIgOqOxB0wD
AJ4oqkk=
  "],
 CellLabel->
  "In[224]:=",ExpressionUUID->"cd1d98ae-64de-446a-874b-c64fbde53e31"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f2space", "=", 
        RowBox[{"RunFasterSurfaceCRN", "[", 
         RowBox[{"fasterDLAcrn", ",", "f2space", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"f2time", "+=", "dt"}]}], ",", "1000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}},
 CellLabel->
  "In[230]:=",ExpressionUUID->"fc51411c-df01-474b-9671-9969493059e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunFasterSurfaceCRN", "[", 
    RowBox[{"fasterDLAcrn", ",", "f2space", ",", "100"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8274568443617573`*^9, 3.8274568968917418`*^9}, {
  3.82931710156116*^9, 3.829317117244265*^9}, {3.829426374661085*^9, 
  3.829426379993998*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"36b27609-23b6-4ff8-9b2b-99ca48b3111d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.392457`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.827456899237506*^9, 3.82752337585714*^9, {3.8276895482096443`*^9, 
   3.827689555423439*^9}, 3.827698448780013*^9, 3.8276989466503687`*^9, 
   3.829317128820662*^9, 3.829426540789028*^9},
 CellLabel->
  "Out[167]=",ExpressionUUID->"f26d34ca-2f86-407b-ad52-c513ba66eff0"]
}, Open  ]],

Cell["\<\
OK, now we\[CloseCurlyQuote]re talking!  Original simulator: 90 seconds; \
compiled fast simulator: 11 seconds; compiled rate-tree simulator: 0.4 \
seconds.  200x faster than original, 20x faster than basic compiled.  Good.\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwd0ttLmnEAh3HxIqqZF9qWjYoCO3sRW6OIiN6IgrIuYruLtVYZpKyIBRUv
TMIO60hbBxXJi1wTsbJGTMTKkgqytplZsFrQhAxyHTcvomm/73vx8PkHnoTX
jRV1bBaLJSRBvSH00tvqo2yU/wqKReV+uCVsZuRqDAFem4/K/2lh84mPlNZE
qOmVpML2HaMUfkr4L4OvFJ6kbOLDge1UmPZ10Z1HrB/07MNcx9VoI1HnSh6H
NnalwtXto1TXZT1QnkZnuonqp+HPYOSbHTHkmUzl8Khr2L5PTD/Ur8MYQbv1
mNjUL1yEOfzCFSjSBF2wQOU8hK0i+gwGz2L/Qt58ih9qJ0S3sKJlM+Q38a54
6gG8ftwdDSubf32E8rcSA5w4Nc3ApqB0FhYtnSzAws7QZWh+FybwEL+93IiH
lh/cJ7A2IzsL0in/5CfEqPWGEehRCdSQU6L4AukSxwWU2NyMF9y9F17i0vfT
angusdfDuFWODHprfB2Qd+Pohbr5viE4V7X9AQ7GLSjh8ykno1l6rIWT2gMd
jHDmvw8QO6M+M4asOTMiesgH1HQWNBtLx2BSLFcNq/9MTg8T6d1ZxnvepkXQ

  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"a646e409-ea17-4d7a-bf0c-0a08b2def45c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f2space3D", "=", 
   RowBox[{"Convert2FasterSpace", "[", 
    RowBox[{"init3D", ",", "fasterDLAcrn"}], "]"}]}], ";", " ", 
  RowBox[{"f2time3D", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2coloring3D", "=", 
   RowBox[{"Convert2FasterColoring", "[", 
    RowBox[{"coloring3D", ",", "fasterDLAcrn"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.829332101610833*^9, 3.82933210189144*^9}, {
   3.829332167947441*^9, 3.829332170329995*^9}, {3.829332225416141*^9, 
   3.829332247730349*^9}, {3.829332289255241*^9, 3.829332303393895*^9}, {
   3.829332405110834*^9, 3.829332430055441*^9}, {3.829332477098358*^9, 
   3.829332521871564*^9}, {3.829332597674273*^9, 3.829332607085257*^9}, {
   3.829332671034099*^9, 3.829332735269403*^9}, 3.829332822784195*^9, {
   3.8293349452865667`*^9, 3.82933494594584*^9}, {3.829426723832189*^9, 
   3.8294267620299597`*^9}, {3.829432513681158*^9, 3.829432536675583*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"ccaebf3a-aa7f-4cb2-9356-6e50ea87e6e5"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ShowSurface3D", "[", 
   RowBox[{"f2space3D", ",", "f2coloring3D", ",", 
    RowBox[{"PlotLabel", "\[Rule]", "f2time3D"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{
  3.827699446918768*^9, {3.829332622584806*^9, 3.8293326440895643`*^9}, 
   3.829332677726213*^9, {3.8294267528323183`*^9, 3.829426757410983*^9}},
 CellLabel->
  "In[233]:=",ExpressionUUID->"7c0b31a4-97e0-4b0e-823e-a79456d1867b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f2space3D", "=", 
        RowBox[{"RunFasterSurfaceCRN", "[", 
         RowBox[{"fasterDLAcrn", ",", "f2space3D", ",", "dt"}], "]"}]}], ";", 
       
       RowBox[{"f2time3D", "+=", "dt"}]}], ",", "1000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.829334976265684*^9, 3.829334978377679*^9}, {
  3.829335623972726*^9, 3.829335625904748*^9}, {3.829426771853178*^9, 
  3.829426780895609*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"9b54154b-ea81-4d44-bb19-2559dccc14c7"],

Cell[BoxData[
 RowBox[{"ShowSurface3D", "[", 
  RowBox[{"f2space3D", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"F", "\[Rule]", "Cyan"}], ",", 
      RowBox[{"G", "\[Rule]", "Empty"}], ",", 
      RowBox[{"P", "\[Rule]", "Empty"}], ",", " ", 
      RowBox[{"W", "\[Rule]", "Empty"}]}], "}"}], "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r_", "[", 
       RowBox[{"s_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"r", "[", 
       RowBox[{
        RowBox[{"Convert2FasterSpace", "[", 
         RowBox[{"s", ",", "fasterDLAcrn"}], "]"}], ",", "c"}], "]"}]}], 
     ")"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "f2time3D"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.829335610317235*^9, 3.829335619067177*^9}, {
  3.829335970279793*^9, 3.8293360081214037`*^9}, {3.829336043830188*^9, 
  3.829336111144815*^9}, {3.829426814194214*^9, 3.829426827819525*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"ac43d70a-8b75-4713-b1bb-82a3abc669f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ShowSurface3D", "[", 
   RowBox[{"f2space3D", ",", 
    RowBox[{"Convert2FasterColoring", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"F", "\[Rule]", "Cyan"}], ",", 
        RowBox[{"G", "\[Rule]", "Empty"}], ",", 
        RowBox[{"P", "\[Rule]", "Empty"}], ",", " ", 
        RowBox[{"W", "\[Rule]", "Empty"}]}], "}"}], ",", "fasterDLAcrn"}], 
     "]"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "f2time3D"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"show", " ", "only", " ", "the", " ", "frozen", " ", "stuff"}], 
   " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.829335610317235*^9, 3.829335619067177*^9}, {
  3.829335970279793*^9, 3.8293360081214037`*^9}, {3.829336043830188*^9, 
  3.829336111144815*^9}, {3.829430970023448*^9, 3.829430984087879*^9}, {
  3.829431374752166*^9, 3.829431417622098*^9}, {3.829432628302145*^9, 
  3.829432636842374*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"d2f9f767-556c-4a6d-9ecf-fc66633bf9d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunFasterSurfaceCRN", "[", 
    RowBox[{"fasterDLAcrn", ",", "f2space3D", ",", "10"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8294272082385406`*^9, 3.8294272201495256`*^9}, {
  3.8294273149903393`*^9, 3.829427332422319*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"95dca389-44de-4a36-a8e6-018175660645"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.041226`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.829427337236253*^9, {3.829433089546898*^9, 3.829433106982169*^9}},
 CellLabel->
  "Out[241]=",ExpressionUUID->"1e3d5404-2ff8-436f-90a7-141f80e5c293"]
}, Open  ]],

Cell["\<\
Original simulator: doesn\[CloseCurlyQuote]t do 3D; compiled fast simulator: \
60 seconds; compiled rate-tree simulator: 3 seconds.  Still about 20x faster \
than basic compiled.\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwd0v8r43EAx/G1H4RjaRwjRPl++0G+ZF2Sj9MpzZT4TefOlykT0in0KUvz
5Xw75/tYluzcWndn5+IkX4ZMmW+zRp0vxcqUdb4vCbv36/PDs8c/8AzOL88q
YrNYrDASVGucL63VNkpH2a+gkC+yw/WQSkaOQvPMrbFRyX9n2J5E74HZUKho
EUfC2p3vEvg1+KkUvpdZwgTEl+0bkTDqz5w5iVjcYdmDiYar3nKiyhTeD3Xs
XJmpyUbJrzOaoTSKjjMTB2Nd46FX2Y4QcrVaETxq/LK8R3x1oNZDf17t7DGx
oi1kDr72TF2EfIXDBFPkxgNYzafPoeM84BZyJyLsUDnMf4BZVWtOJ8THtLEX
8NqvyRfmVh52Q+lHsQYOn2l/wgqHZBy+nT+dhKkNzgtwus6FZyFuvlsNgjPb
nBhYGC1IgHTEnfSU6KMv6YEWOW8QuqXLfkM63XABxToz4wVnN8dKnN86+wD/
iZeLYeCSWym0FtjqIffG0AJVE62f4a+8jS7YETg5ALPHjIzTkmMlHFXuq6C7
MfnTM7HB5xuj04ox2r2ZfED9SIBrmQvdsOuNvhc+CTuHYJsoWwElOfQIvFe3
M/ZNCQo8iP7UaCH8D5tkVC0=
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"12f12d97-9c25-4842-af10-6ec7dbdc9f4d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Additional tests copied from the original surface CRN notebook\
\>", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.8293093013511972`*^9, 
  3.82930930344156*^9}, {3.8293156298397093`*^9, 3.82931563816496*^9}, {
  3.829315738401884*^9, 3.8293157428071747`*^9}, {3.8294333010856047`*^9, 
  3.8294333108370953`*^9}},ExpressionUUID->"a205a44e-223c-4dea-98d1-\
aea867ae2f26"],

Cell["Digital circuits, original simulator", "Text",
 CellChangeTimes->CompressedData["
1:eJwd0ttLk3EAh/GxC7HSIbNyiUqC1Zy7EDUcIeKbUiBzguideEib0CSHGJi8
4Ip53sw0y+mLQ1w6hoe5sEQ8TKUJTqs5ppAHWAMnODTNRoQ6f9/34uHzDzyx
T6rynnI5HI6QBI2m4N/eWh9lpfzHUCqW+eFqXDUrjzFd8F/6qIyf09xw4s2e
mTuQaZXHw7r1EQX8GHteCUvUnrsS4g3tWjwUfZl1pRMr2j2bMM1+3F1FNDjv
fYBWbqHa2eSjdCc5zVAlolNcxN7kq/fh9efrUsg3m2Vwt/Ht0iYxYdtog1GC
uhk3UamJm4UPwrMWoJgJOOFDnWMb1orpAxg4iD6FfIvQD/X94v8w78VK0C/i
2eOha/AksukWLKze6YKqGrkJ9u+bx6AyoBiHj+b2JmFWQ/A8nKq/IvAQvxUt
34bTP3hJsDxRkgpp4V/VHjHC9uwd9OgEvTAkW/0J0tn2Iyi3uliPeBsFXuLc
9/1SeChfqoAxiyGV0Fvmew35f+yt0GBpewMnitc6YXvMZA/MH3KwTincejio
3zLAUEdGywWxIWKYNeirIzG0mXxAjabCldz5LtiZaeuG59KOPqiR5TNQUUAP
wH9GLev7z5KyMGIUNVgOd5lVFUzODHsFRR1uDaxRJmjhJSA3YtM=
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"9b1a4f5c-b229-42c2-969a-a7bb8c70f48f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{
  "o", ",", "a", ",", "b", ",", "c", ",", "a0", ",", "b0", ",", "c0", ",", 
   "a1", ",", "b1", ",", "c1", ",", "FAN", ",", "F11", ",", "F1", ",", "F00", 
   ",", "F0", ",", "NOR", ",", "N0", ",", "N1", ",", "NOR0", ",", "NOR1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circuits", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "directional", " ", "movement", " ", "of", " ", "signal", " ", "along", 
      " ", "abcabcabc", " ", 
      RowBox[{"wire", ":", " ", 
       RowBox[{"6", " ", "reactions"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"a0", "+", "b"}], ",", 
       RowBox[{"a", "+", "b0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"a1", "+", "b"}], ",", 
       RowBox[{"a", "+", "b1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"b0", "+", "c"}], ",", 
       RowBox[{"b", "+", "c0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"b1", "+", "c"}], ",", 
       RowBox[{"b", "+", "c1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"c0", "+", "a"}], ",", 
       RowBox[{"c", "+", "a0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"c1", "+", "a"}], ",", 
       RowBox[{"c", "+", "a1"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "fanout", " ", "gate", " ", "with", " ", "input", " ", "on", " ", 
        "a"}], ",", " ", 
       RowBox[{"output", " ", "on", " ", "b", " ", "and", " ", 
        RowBox[{"c", ":", " ", 
         RowBox[{"6", " ", "reactions"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"a1", "+", "FAN"}], ",", 
       RowBox[{"a", "+", "F11"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"F11", "+", "b"}], ",", 
       RowBox[{"F1", "+", "b1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"F1", "+", "c"}], ",", 
       RowBox[{"FAN", "+", "c1"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"a0", "+", "FAN"}], ",", 
       RowBox[{"a", "+", "F00"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"F00", "+", "b"}], ",", 
       RowBox[{"F0", "+", "b0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"F0", "+", "c"}], ",", 
       RowBox[{"FAN", "+", "c0"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "NOR", " ", "gate", " ", "with", " ", "input", " ", "on", " ", "a", 
        " ", "and", " ", "b"}], ",", " ", 
       RowBox[{"output", " ", "on", " ", 
        RowBox[{"c", ":", " ", 
         RowBox[{"8", " ", "reactions"}]}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"a0", "+", "NOR"}], ",", 
       RowBox[{"a", "+", "N0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"a1", "+", "NOR"}], ",", 
       RowBox[{"a", "+", "N1"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"b0", "+", "N0"}], ",", 
       RowBox[{"b", "+", "NOR1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"b0", "+", "N1"}], ",", 
       RowBox[{"b", "+", "NOR0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"b1", "+", "N0"}], ",", 
       RowBox[{"b", "+", "NOR0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"b1", "+", "N1"}], ",", 
       RowBox[{"b", "+", "NOR0"}], ",", "1"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"NOR0", "+", "c"}], ",", 
       RowBox[{"NOR", "+", "c0"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{
       RowBox[{"NOR1", "+", "c"}], ",", 
       RowBox[{"NOR", "+", "c1"}], ",", "1"}], "]"}]}], "\[IndentingNewLine]",
     "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8217584323952703`*^9, 3.82175894006706*^9}, {
  3.8217599293929043`*^9, 3.821759929504713*^9}, {3.821759989091157*^9, 
  3.821759994585959*^9}, {3.821761158191145*^9, 3.8217611633738203`*^9}, {
  3.82176205966555*^9, 3.821762061649115*^9}, {3.8217629589256496`*^9, 
  3.821762969430173*^9}, {3.821763291371709*^9, 3.821763294060442*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"e412e6b6-e092-4960-b410-6194837f61cb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"layout", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "    ", "o", 
       ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "    ", "o", ",", 
       "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "a", ",", "b", ",", "c", ",", "a1", ",", "b", ",", "c", ",", 
       "a", ",", "o", ",", "b", ",", "c", ",", "a", ",", "    ", "o", ",", 
       "o", ",", "o", ",", "o", ",", "  ", "o", ",", "    ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "c", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "FAN", ",", "c", ",", "a", ",", "o", ",", "b", ",", "o", ",", "a",
        ",", "b", ",", "NOR", ",", "  ", "c", ",", "a", ",", "b", ",", "c", 
       ",", "a", ",", "NOR", ",", " ", "c", ",", "a", ",", "o"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "b", ",", "a", ",", "c", ",", "b", ",", "  ", "a", ",", "c", 
       ",", "b", ",", "o", ",", "o", ",", "o", ",", "c", ",", "    ", "o", 
       ",", "c", ",", "o", ",", "a", ",", "  ", "o", ",", "    ", "o", ",", 
       "o", ",", "o", ",", "o", ",", "b", ",", "o", ",", "b", ",", "o"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "a", ",", "    ", "o", 
       ",", "b", ",", "o", ",", "c", ",", "  ", "b", ",", "    ", "a", ",", 
       "c", ",", "o", ",", "o", ",", "a", ",", "o", ",", "c", ",", "o"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "a", ",", "b", ",", "c", ",", "a1", ",", "b", ",", "c", ",", 
       "a", ",", "o", ",", "o", ",", "o", ",", "NOR", ",", "c", ",", "a", ",",
        "o", ",", "o", ",", "  ", "o", ",", "    ", "o", ",", "b", ",", "o", 
       ",", "o", ",", "c", ",", "b", ",", "a1", ",", "o"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "c", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "FAN", ",", "c", ",", "a", ",", "o", ",", "b", ",", "o", ",", "o",
        ",", "o", ",", "b", ",", "  ", "c", ",", "    ", "a", ",", "FAN", ",",
        "c", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "b", ",", "a", ",", "c", ",", "b", ",", "  ", "a", ",", "c", 
       ",", "b", ",", "o", ",", "b", ",", "c", ",", "a", ",", "    ", "o", 
       ",", "o", ",", "o", ",", "a", ",", "  ", "o", ",", "    ", "o", ",", 
       "o", ",", "a", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "    ", "o", 
       ",", "o", ",", "o", ",", "c", ",", "b0", ",", "    ", "a", ",", "c", 
       ",", "b", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "o", 
       ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "    ", "o", 
       ",", "o", ",", "o", ",", "o", ",", "  ", "o", ",", "    ", "o", ",", 
       "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o", ",", "o"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"circuittime", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8217509267172527`*^9, 3.8217509628517447`*^9}, {
   3.8217510345331087`*^9, 3.8217512847061453`*^9}, {3.821751343337679*^9, 
   3.821751346463264*^9}, {3.821751509046467*^9, 3.8217515094451103`*^9}, {
   3.821751598418005*^9, 3.821751598645246*^9}, {3.8217518701569347`*^9, 
   3.821751870661212*^9}, {3.821759021405603*^9, 3.821759422413495*^9}, {
   3.821759457740449*^9, 3.82175965278966*^9}, {3.821759789433323*^9, 
   3.821759796384386*^9}, {3.821760042774165*^9, 3.821760062173263*^9}, {
   3.821760095549823*^9, 3.821760260078516*^9}, 3.821760381440593*^9, {
   3.821761911459876*^9, 3.8217620356601973`*^9}, {3.8217631385112047`*^9, 
   3.821763170167543*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"c69778a1-1792-40c9-916d-74378ae554d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"circuitcolors", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"o", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
     RowBox[{"a", "\[Rule]", 
      RowBox[{"GrayLevel", "[", ".5", "]"}]}], ",", 
     RowBox[{"b", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0.6", "]"}]}], ",", 
     RowBox[{"c", "\[Rule]", 
      RowBox[{"GrayLevel", "[", "0.7", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"a0", "\[Rule]", "Red"}], ",", 
     RowBox[{"b0", "\[Rule]", "Red"}], ",", 
     RowBox[{"c0", "\[Rule]", "Red"}], ",", 
     RowBox[{"a1", "\[Rule]", "Green"}], ",", 
     RowBox[{"b1", "\[Rule]", "Green"}], ",", 
     RowBox[{"c1", "\[Rule]", "Green"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FAN", "|", "F11", "|", "F1", "|", "F00", "|", "F0"}], 
      "\[Rule]", "Blue"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NOR", "|", "N0", "|", "N1", "|", "NOR0", "|", "NOR1"}], 
      "\[Rule]", "Purple"}], ",", "\[IndentingNewLine]", 
     RowBox[{"EAT", "\[Rule]", "Yellow"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8217596812133417`*^9, 3.8217598542563972`*^9}, {
  3.821759903698346*^9, 3.8217599073345013`*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"00accaf0-72e7-4b7f-911d-76b036b36a2f"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"layout", ",", 
    RowBox[{"ColorRules", "\[Rule]", "circuitcolors"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "circuittime"}]}], "]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.821751287706839*^9, 3.821751491621811*^9}, {
  3.821759665796956*^9, 3.821759688090034*^9}},
 CellLabel->
  "In[147]:=",ExpressionUUID->"a7831029-9751-4478-b4dd-c25de5e3f61c"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"layout", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"circuits", ",", "layout", ",", ".1"}], "]"}]}], ";", 
    RowBox[{"circuittime", "+=", ".1"}]}], ",", "5000"}], "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8215764628383627`*^9, 
   3.821576478629778*^9}, {3.821577223226941*^9, 3.821577223336877*^9}, 
   3.821578141850238*^9, {3.821589566615196*^9, 3.821589585213561*^9}, {
   3.821670682885037*^9, 3.821670696939065*^9}, {3.821670737539455*^9, 
   3.821670737618924*^9}, {3.821671637621358*^9, 3.821671656854603*^9}, {
   3.821751523559148*^9, 3.8217515565243597`*^9}, {3.821760328115385*^9, 
   3.8217603486219893`*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"7f6a3449-078b-4679-9756-9d4d714624c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunSurfaceCRN", "[", 
    RowBox[{"circuits", ",", "layout", ",", "500"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.829433402743524*^9, 3.829433412134912*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"9917d547-91e1-4508-bd66-39b8c38766c3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.440081`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.829433419740761*^9, 3.8297703342380657`*^9},
 CellLabel->
  "Out[149]=",ExpressionUUID->"3c9aa912-8489-4575-a9ea-bd4a046a9cea"]
}, Open  ]],

Cell["\<\
Digital circuits, now with the new simulator, about 200x faster.\
\>", "Text",
 CellChangeTimes->CompressedData["
1:eJwd0utLU3EAh/GxF6KlQ2blDJMEK6eTRA1XRHhSC2RNkPluWHmZ4ERFDEwO
tGKmmVupWc4OLtlca1guyxTxspImOC3nmILZwAZOcOSlWhfU9fueFw+ff+CJ
L64uKONyOBwhCZotoVu+ej9lowLbUCKSBuBsQi0rj7Hs82/6qazlUW4U8UjX
2AnItCiEsGGhXwn74vcq4TW196SYeFgzJ4RJw+PuC8RyrXcJnndsd1YTja5T
T6CNK1e7mvyUbudKM1Ql0RluYnf6gTPwUNWCBPKtVin03G2bWiImr5jtMFbQ
MLZKrGlNGIfnonLeQxETdMGLOucKrBfRGzC4cewn5A8mBqC+R/QPFtyYCflG
3L1sOgh3jjbFQHnt1w6oqlNYYM+69RWsCSoH4KWJtSGY0xg6CUduhQm8xE9F
08fh6DwvDZamijMhnfhLtUaMtlc8gl6doBuG56nfQDrPsQkVNjfrJm+x0Eec
+Lx+HX5XTJXDuA/hldBX4r8D+T8cLdA4eP8BfH11rh1q44a6oMzkZB1Rruqh
Qf/FCCOcWff2iY3Rz1lDPjpTI5rJB9TLTDiTP9kB27PtnXBP8vApbJXKGKgs
pHvhH7OG9fE7cUkkMZYylEIPM6uC6dmRt+Ezz18NPPvirRb+TjltgFu5yX3w
P7d+a74=
  "],
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"db674450-f797-4afe-b3ba-7c1765bcf2b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fastercircuits", "=", 
   RowBox[{"PreprocessFasterSurfaceCRN", "[", 
    RowBox[{"circuits", ",", 
     RowBox[{"{", "layout", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2layout", "=", 
   RowBox[{"Convert2FasterSpace", "[", 
    RowBox[{
     RowBox[{"{", "layout", "}"}], ",", "fastercircuits"}], "]"}]}], ";", " ", 
  RowBox[{"f2ctime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2circuitcoloring", "=", 
   RowBox[{"Convert2FasterColoring", "[", 
    RowBox[{"circuitcolors", ",", "fastercircuits"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"First", "[", "f2layout", "]"}], ",", 
    RowBox[{"ColorRules", "\[Rule]", "f2circuitcoloring"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "f2ctime"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQPbGAq6ui6Y3jtyMHwfQp/+nTKoG00U73OSB6iXP/
BRDNt/Y7mJ5S9XyqZ8sbxz6h2Bkg2ofr0TwQPWXmtvkgWsbwxjoQzfRAawOI
5k8oUPUC0kbH6tVAdNecvfogekblRVMQ/fbRJEsQHfVDygZEn5n62wtEH/nA
7Q2iLx1+VgOi9y35CKY/GAg3g2ixi8rtIFqlqj7hIJDOu8ySCKJPsD6Zd739
jWNA4JbFIHr6Vd2NIFp8guZWEC12tofrPpAua8vlAdFC3ZNtQPSdDXPBtDlP
huULIL1UuBxMn+DRFeTtALrvMZcYiI5oEuMXANJLjj0H00WOqiIgOqOxB0yL
rg7sB9H6DlWzQDQAeuuw9w==
  "],
 CellLabel->
  "In[150]:=",ExpressionUUID->"6a6d0d55-0e32-4e51-b17b-2ef88c25d078"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f2layout", "=", 
        RowBox[{"RunFasterSurfaceCRN", "[", 
         RowBox[{"fastercircuits", ",", "f2layout", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"f2ctime", "+=", "dt"}]}], ",", "5000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}, {3.829433569281344*^9, 3.829433588311586*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"cf0ce3f1-0a3d-4d08-a38b-6dd20a7f161f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"RunFasterSurfaceCRN", "[", 
    RowBox[{"fastercircuits", ",", "f2layout", ",", "500"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8274568443617573`*^9, 3.8274568968917418`*^9}, {
  3.82931710156116*^9, 3.829317117244265*^9}, {3.829426374661085*^9, 
  3.829426379993998*^9}, {3.829433595756118*^9, 3.829433616793064*^9}},
 CellLabel->
  "In[158]:=",ExpressionUUID->"e1cea999-e7f9-4f09-8a3e-603b85fa762d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.036199`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.827456899237506*^9, 3.82752337585714*^9, {3.8276895482096443`*^9, 
   3.827689555423439*^9}, 3.827698448780013*^9, 3.8276989466503687`*^9, 
   3.829317128820662*^9, 3.829426540789028*^9, 3.829433620917951*^9, 
   3.829770359845853*^9},
 CellLabel->
  "Out[158]=",ExpressionUUID->"e044ca41-3ea9-44c4-a534-f8c11fdc6d41"]
}, Open  ]],

Cell["Now let\[CloseCurlyQuote]s try the  asynchronous Greenberg-Hastings \
rules.", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"f37ee624-1898-42ae-8342-ef3812cd9795"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AGH", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"rxn", "[", 
     RowBox[{
      RowBox[{"A", "+", "Q"}], ",", 
      RowBox[{"A", "+", "A"}], ",", "1"}], "]"}], ",", 
    RowBox[{"rxn", "[", 
     RowBox[{"A", ",", "R", ",", "0.6"}], "]"}], ",", 
    RowBox[{"rxn", "[", 
     RowBox[{"R", ",", "Q", ",", "0.03"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.821490876281782*^9, 3.821490917084908*^9}, {
  3.827680868095828*^9, 3.827680933618231*^9}, {3.827681011567872*^9, 
  3.827681024026661*^9}, {3.827681057651225*^9, 3.827681058035466*^9}, {
  3.827681444177833*^9, 3.8276815044902153`*^9}, {3.82768190766726*^9, 
  3.827681931819696*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"430411c4-0d6d-48e2-8e3f-1fd2f6b6f57d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "+", "Q"}], " ", 
    OverscriptBox["\[RightArrow]", 
     RowBox[{" ", "1", " "}]], " ", 
    RowBox[{"2", " ", "A"}]}], " ", ",", 
   RowBox[{"A", " ", 
    OverscriptBox["\[RightArrow]", 
     RowBox[{" ", "0.6`", " "}]], " ", "R"}], " ", ",", 
   RowBox[{"R", " ", 
    OverscriptBox["\[RightArrow]", 
     RowBox[{" ", "0.03`", " "}]], " ", "Q"}]}], " ", "}"}]], "Output",
 CellChangeTimes->{
  3.827672249632428*^9, {3.8276808798120623`*^9, 3.827680916781663*^9}, 
   3.827681024608848*^9, 3.827681058612602*^9, {3.8276814448210783`*^9, 
   3.8276815079281893`*^9}, {3.8276819089085407`*^9, 3.827681932377215*^9}, 
   3.827682731466875*^9, 3.8294338122127*^9, 3.8296979194227333`*^9, 
   3.8461136464458637`*^9, 3.846116256350398*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"697cd44e-7f0e-4dd3-a52a-44c29e7f12b8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"AGHstate", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"750", "/", "2"}]}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[LessEqual]", "m"}], "&&", 
          RowBox[{"j", ">", "m"}]}], ",", "A", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"i", ">", "m"}], "&&", 
            RowBox[{"j", ">", "m"}]}], ",", "R", ",", "Q"}], "]"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"2", "m"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"2", "m"}]}], "}"}]}], "]"}]}], "]"}]}], ";", 
  RowBox[{"AGHtime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.821490925151112*^9, 3.821491004536615*^9}, {
  3.821491039219653*^9, 3.821491040707405*^9}, {3.821491261929166*^9, 
  3.821491264508514*^9}, {3.821493665484874*^9, 3.8214937195544233`*^9}, {
  3.8214939078857803`*^9, 3.821493925408123*^9}, {3.821494026930128*^9, 
  3.821494052380019*^9}, {3.829698067237195*^9, 3.82969806970761*^9}, {
  3.829698820129071*^9, 3.829698820315239*^9}, {3.846114077131372*^9, 
  3.846114082333248*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"dcd957dc-11db-43d0-808c-4dc04f64ddda"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"AGHstate", ",", 
    RowBox[{"ColorRules", "\[Rule]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", "Red"}], ",", 
       RowBox[{"Q", "\[Rule]", 
        RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
       RowBox[{"R", "\[Rule]", "Blue"}]}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "AGHtime"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.821491024929027*^9, 3.821491036723599*^9}, {
  3.8214912667784557`*^9, 3.821491269984231*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"6dbf855b-8156-4efb-99a3-c4341b91741d"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"AGHstate", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"AGH", ",", "AGHstate", ",", "0.1"}], "]"}]}], ";", 
    RowBox[{"AGHtime", "+=", "0.1"}]}], ",", "1000"}], "]"}]], "Input",
 CellChangeTimes->{{3.821487757680973*^9, 3.821487794656365*^9}, {
   3.82148787755868*^9, 3.821487879939159*^9}, {3.821491183687119*^9, 
   3.821491247763153*^9}, {3.821491281772258*^9, 3.821491308135318*^9}, {
   3.82149362953965*^9, 3.82149364750147*^9}, {3.821493705689249*^9, 
   3.821493725660918*^9}, {3.821493838511374*^9, 3.821493841129764*^9}, 
   3.821493881638876*^9, {3.821494161316257*^9, 3.821494163560721*^9}, {
   3.821495021883727*^9, 3.821495033092334*^9}, {3.8216679462299957`*^9, 
   3.821668003359963*^9}, 3.8276827845531607`*^9, 3.827685343053816*^9, {
   3.846527758274629*^9, 3.846527760101314*^9}, {3.846527797319971*^9, 
   3.846527799685843*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"e6508069-628a-48ed-b823-6815c9ffc771"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"RunSurfaceCRN", "[", 
     RowBox[{"AGH", ",", "AGHstate", ",", "10"}], "]"}], ";"}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{3.8461163916368313`*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"3737e9d5-1d47-4e92-9ecc-cf447b81455b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"296.158982`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.846116688199667*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"48b9f2a2-6793-4ae3-bead-03b24eb19f10"]
}, Open  ]],

Cell["\<\
And with the faster simulator: about 17x speed-up here.  Not as much as in \
some cases, presumably because the original simulator was reasonably \
efficient here already.  (For early times, at least; later, as there are \
fewer places needing to be updated, the faster simulator \
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
  3.829433882758545*^9, 3.8294338876459627`*^9}, {3.829434196798414*^9, 
  3.82943420233631*^9}, {3.829434237052841*^9, 3.829434259966317*^9}, {
  3.829434350100005*^9, 3.829434368456011*^9}, {3.846528131949819*^9, 
  3.846528152605722*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"47d980ad-b35f-4445-a29d-1330017ee6ad"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fasterAGH", "=", 
   RowBox[{"PreprocessFasterSurfaceCRN", "[", 
    RowBox[{"AGH", ",", 
     RowBox[{"{", "AGHstate", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2AGHstate", "=", 
   RowBox[{"Convert2FasterSpace", "[", 
    RowBox[{
     RowBox[{"{", "AGHstate", "}"}], ",", "fasterAGH"}], "]"}]}], ";", " ", 
  RowBox[{"f2AGHtime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2AGHcoloring", "=", 
   RowBox[{"Convert2FasterColoring", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", "Red"}], ",", 
       RowBox[{"Q", "\[Rule]", 
        RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
       RowBox[{"R", "\[Rule]", "Blue"}]}], "}"}], ",", "fasterAGH"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"First", "[", "f2AGHstate", "]"}], ",", 
    RowBox[{"ColorRules", "\[Rule]", "f2AGHcoloring"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "f2AGHtime"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQPbGAq6ui6Y3jtyMHwfQp/+nTKoG00U73OSB6iXP/
BRDNt/Y7mJ5S9XyqZ8sbxz6h2Bkg2ofr0TwQPWXmtvkgWsbwxjoQzfRAawOI
5k8oUPUC0kbH6tVAdNecvfogekblRVMQ/fbRJEsQHfVDygZEn5n62wtEH/nA
7Q2iLx1+VgOi9y35CKY/GAg3g2ixi8rtIFqlqj7hIJDOu8ySCKJPsD6Zd739
jWNA4JbFIHr6Vd2NIFp8guZWEC12tofrPpAua8vlAdFC3ZNtQPSdDXPBtDlP
huULIL1UuBxMn+DRFeTtALrvMZcYiI5oEuMXANJLjj0H00WOqiIgOqOxB0yL
rg7sB9H6DlWzQLRQxu9jIHpRm8oFEA0AzyS42Q==
  "],
 CellLabel->"In[62]:=",ExpressionUUID->"918add72-57c0-4216-a23d-8b5b08248a3d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f2AGHstate", "=", 
         RowBox[{"RunFasterSurfaceCRN", "[", 
          RowBox[{"fasterAGH", ",", "f2AGHstate", ",", "dt"}], "]"}]}], ";", 
        RowBox[{"f2AGHtime", "+=", "dt"}]}], ",", "1000"}], "]"}]}], "]"}], 
   ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"too", " ", "slow"}], ";", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "wastes", " ", "times", " ", "building", " ", "data", " ", 
       "structure"}], " ", "&"}], " ", "displaying", " ", "graphics"}]}], " ",
    "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}, {3.829433569281344*^9, 3.829433588311586*^9}, {
   3.829433998900132*^9, 3.829434010380258*^9}, {3.829698434988965*^9, 
   3.8296984359791183`*^9}, {3.8296985643630047`*^9, 3.829698591563984*^9}, 
   3.8296986327288237`*^9, {3.829698856845188*^9, 3.829698857683002*^9}, {
   3.84652789368395*^9, 3.8465279083420553`*^9}, {3.8465287041687193`*^9, 
   3.846528737832212*^9}},ExpressionUUID->"51015a06-ac19-4c00-ae4f-\
702b0c16b1ef"],

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dt", "=", "10"}], "}"}], ",", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"f2AGHstate", "=", 
         RowBox[{"RunFasterSurfaceCRN", "[", 
          RowBox[{"fasterAGH", ",", "f2AGHstate", ",", "dt"}], "]"}]}], ";", 
        RowBox[{"f2AGHtime", "+=", "dt"}]}], ",", "100"}], "]"}]}], "]"}], 
   ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}, {3.829433569281344*^9, 3.829433588311586*^9}, {
   3.829433998900132*^9, 3.829434010380258*^9}, {3.829698434988965*^9, 
   3.8296984359791183`*^9}, {3.8296985643630047`*^9, 3.829698591563984*^9}, 
   3.8296986327288237`*^9, {3.829698856845188*^9, 3.829698857683002*^9}, {
   3.846115446734631*^9, 3.846115465944435*^9}, 3.846117664880769*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"0c388db5-1c2b-4c9d-951c-0b1088cd5d1b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"RunFasterSurfaceCRN", "[", 
    RowBox[{"fasterAGH", ",", "f2AGHstate", ",", "10"}], "]"}], ";"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.846528084079453*^9, 3.846528084893643*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"65ee8646-d1cb-4ffd-8231-4a00a02137d2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2.420622`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.846528089542288*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"7c04078b-fff6-46a2-ab39-e587e6af5461"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{
    RowBox[{"RunFasterSurfaceCRN", "[", 
     RowBox[{"fasterAGH", ",", "f2AGHstate", ",", "1000"}], "]"}], ";"}], 
   "]"}], " "}]], "Input",
 CellChangeTimes->{{3.8274568443617573`*^9, 3.8274568968917418`*^9}, {
   3.82931710156116*^9, 3.829317117244265*^9}, {3.829426374661085*^9, 
   3.829426379993998*^9}, {3.829433595756118*^9, 3.829433616793064*^9}, {
   3.829434161159872*^9, 3.829434167040907*^9}, {3.829698361006974*^9, 
   3.8296983612273483`*^9}, {3.84611435441284*^9, 3.846114426164486*^9}, {
   3.846114466026576*^9, 3.846114483485746*^9}, {3.846115210458973*^9, 
   3.846115223361619*^9}, 3.8461152571903667`*^9, {3.846115312696377*^9, 
   3.846115313518108*^9}, {3.846115757388957*^9, 3.8461158058111134`*^9}, {
   3.8461158489805*^9, 3.846115908248438*^9}, {3.846116366200782*^9, 
   3.846116369555011*^9}, {3.846116436542019*^9, 3.8461165023671207`*^9}, 
   3.846117514722075*^9, 
   3.846528686720649*^9},ExpressionUUID->"531ff731-022e-40ab-95ec-\
bbeeff96f9de"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"127.159389`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.827456899237506*^9, 3.82752337585714*^9, {3.8276895482096443`*^9, 
   3.827689555423439*^9}, 3.827698448780013*^9, 3.8276989466503687`*^9, 
   3.829317128820662*^9, 3.829426540789028*^9, 3.829433620917951*^9, 
   3.8294341768287373`*^9, {3.829698363039877*^9, 3.8296983811021643`*^9}, 
   3.8296988665045633`*^9, {3.8297706903373337`*^9, 3.829770703041059*^9}, 
   3.846115239834695*^9, 3.846115304187138*^9, 3.846117410192285*^9, 
   3.846117440318174*^9, 3.846117640549477*^9, 3.8465286619387817`*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"1158ace9-7294-46d5-9b1c-bd5f05acb556"]
}, Open  ]],

Cell["\<\
Additional notes on asynchronous Greenberg-Hastings: 
\tchanging the A+Q \[RightArrow] A+A rate to 1.5 or 2.0 makes the wavefront \
more stable.
\tincreasing the array size to 300x300 is now feasible... in fact, 750x750 \
(as in Sam Clamon\[CloseCurlyQuote]s on-line simulator) can be handled, just \
barely.
\twith dt=0.1, the faster simulator spends a lot of time building the rate \
tree, and the speed-up is not obvious.  but with dt=10, we get a speed-up of \
100x, which is more satisfying.
\talso interesting: in the dynamic simulations with dt=10 that the first few \
steps (from initial square fields) are slow, while subsequent steps are fast \
-- presumably because of how many sites have moves available.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
  3.829433882758545*^9, 3.8294338876459627`*^9}, {3.829434196798414*^9, 
  3.82943420233631*^9}, {3.829434237052841*^9, 3.829434259966317*^9}, {
  3.829434350100005*^9, 3.829434368456011*^9}, {3.829697952901225*^9, 
  3.829698192910276*^9}, {3.829698344446211*^9, 3.829698401960916*^9}, {
  3.829698452786035*^9, 3.82969855512539*^9}, {3.8296986553740873`*^9, 
  3.8296987336853952`*^9}, {3.8465282906957912`*^9, 3.8465283152023153`*^9}, {
  3.846528604670764*^9, 3.846528617617909*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"bb6ba7a8-a982-44ca-91db-c33fdd018581"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Pause to assess", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.8293093013511972`*^9, 
  3.82930930344156*^9}, {3.8293156298397093`*^9, 3.82931563816496*^9}, {
  3.829315738401884*^9, 3.8293157428071747`*^9}, {3.8294333010856047`*^9, 
  3.8294333108370953`*^9}, {3.829699670988783*^9, 
  3.829699672622196*^9}},ExpressionUUID->"2fdee362-0129-407f-854a-\
5a191a04acc5"],

Cell["\<\
There was a bug when the CRN has parallel reactions with the same reactant.  \
This example tests whether I fixed it.  Yes, it seems to have been fixed.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
   3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
   3.8295041211806803`*^9, 3.829504135823785*^9}, {3.829504941110911*^9, 
   3.829505086991987*^9}, {3.8295057225647593`*^9, 3.82950572895406*^9}, {
   3.829519187734001*^9, 3.829519226711488*^9}, {3.829521410368664*^9, 
   3.8295214719256163`*^9}, 3.829698989160634*^9, 3.829699624646728*^9},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"d3771ecd-1c83-4ae6-af66-c18af25ca974"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"testCRN", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"rxn", "[", 
      RowBox[{"A", ",", "B", ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{"A", ",", "C", ",", "1"}], "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testmap", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"A", ",", "10", ",", "10"}], "]"}]}], ";", 
  RowBox[{"testtime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testcolors", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "\[Rule]", "White"}], ",", 
     RowBox[{"B", "\[Rule]", "Red"}], ",", 
     RowBox[{"C", "\[Rule]", "Blue"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"testmap", ",", 
    RowBox[{"ColorRules", "\[Rule]", "testcolors"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "testtime"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8216785734305277`*^9, 3.821678613439493*^9}, {
   3.821679168452817*^9, 3.821679172265233*^9}, {3.8216793962630167`*^9, 
   3.821679399926448*^9}, {3.821679440928866*^9, 3.821679447438106*^9}, {
   3.821735999846561*^9, 3.821736098413896*^9}, {3.821736198311803*^9, 
   3.821736209550115*^9}, {3.821743688690548*^9, 3.821743688811068*^9}, {
   3.82174374058354*^9, 3.8217438349283733`*^9}, {3.823458704645318*^9, 
   3.823458724149832*^9}, 3.823459057865675*^9, {3.829519559934286*^9, 
   3.8295196468458767`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"ed9d2509-8ba5-402b-b8dc-f8c8c3af0714"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"testmap", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"testCRN", ",", "testmap", ",", "0.01"}], "]"}]}], ";", 
    RowBox[{"solidtime", "+=", "0.01"}]}], ",", "1000"}], "]"}]], "Input",
 CellChangeTimes->{{3.821679416206723*^9, 3.821679423138385*^9}, {
   3.821743682408266*^9, 3.821743684243951*^9}, {3.821743716311751*^9, 
   3.821743716442052*^9}, {3.8217446678744583`*^9, 3.821744667933625*^9}, {
   3.823458764626644*^9, 3.8234588420014153`*^9}, {3.82345908308384*^9, 
   3.823459103755735*^9}, {3.823459785892694*^9, 3.823459809131413*^9}, {
   3.823459852248506*^9, 3.823459852375947*^9}, {3.823460984160722*^9, 
   3.8234609895961647`*^9}, {3.829519664954753*^9, 3.8295196938189363`*^9}, 
   3.829519811892014*^9},
 CellLabel->
  "In[194]:=",ExpressionUUID->"2edb1aad-56ee-4f11-81fd-0677737b713c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ftestCRN", "=", 
   RowBox[{"PreprocessFastSurfaceCRN", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rxn", "[", 
        RowBox[{"A", ",", "B", ",", "1"}], "]"}], ",", 
       RowBox[{"rxn", "[", 
        RowBox[{"A", ",", "C", ",", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"A", ",", "10", ",", "10"}], "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ftestmap", "=", 
   RowBox[{"Convert2FastSpace", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"A", ",", "10", ",", "10"}], "]"}], "}"}], ",", "ftestCRN"}], 
    "]"}]}], ";", 
  RowBox[{"ftesttime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ftestcolors", "=", 
   RowBox[{"Convert2FastColoring", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", "White"}], ",", 
       RowBox[{"B", "\[Rule]", "Red"}], ",", 
       RowBox[{"C", "\[Rule]", "Blue"}]}], "}"}], ",", "ftestCRN"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"First", "[", "ftestmap", "]"}], ",", 
    RowBox[{"ColorRules", "\[Rule]", "ftestcolors"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "ftesttime"}]}], "]"}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzk0ow3EAh/ElLjNv28xLLpgVWZtJmnbYouQlb2VJqVFqFy85YEu0WZtm
bcPGaLZiTliTl5qilrWWqCFxUDTapKm5eGkXv+//8PS5PqVDYz3DaTQarYQE
l8bpxmltQvYdDFBedq6tqogif7MTehotEZi9/0NpU8ftLbqEzMwccMB2etQF
besnblhS8+iFaS9VPpijGK9oJYpCczxodJ4JoEN1Uwc/o8ti2P9bLIFX9lQr
DCYz2+DtRWwGnnu+KJNC1jzk3JQbIFc9pwgQR+/SB2E44831YEjIurqPtuHa
Pf8AFlgrjyHn2kR/Jk7qRxiQubgigU++Tcp6hlL8TtxhTVGGGfy8rAXy90rn
wD4tJyeX6AnFKSdkFWyo1Jgo83e7LVAgVW9ApjIVglt6bgRWLwmfaokaFfsZ
zjR9R6G1UPcBlW7pbANRXnRuhr1S3h4sOxR6oemvww+tMfkp/Ae9OuAo
  "],
 CellLabel->"In[89]:=",ExpressionUUID->"4872e002-255d-4f93-8996-d23b67c36493"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.01"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ftestmap", "=", 
        RowBox[{"RunFastSurfaceCRN", "[", 
         RowBox[{"ftestCRN", ",", "ftestmap", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"ftesttime", "+=", "dt"}]}], ",", "1000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}, {3.829433569281344*^9, 3.829433588311586*^9}, {
   3.829433998900132*^9, 3.829434010380258*^9}, {3.829505900761671*^9, 
   3.829505917044835*^9}, {3.82950595468222*^9, 3.829505955291613*^9}, {
   3.829519492635498*^9, 3.829519514947711*^9}, {3.8295197360012712`*^9, 
   3.8295197409006367`*^9}, {3.829519837646531*^9, 3.829519837784812*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"8ef78952-5006-41f7-bc40-da58a1da666f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f2testCRN", "=", 
   RowBox[{"PreprocessFasterSurfaceCRN", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rxn", "[", 
        RowBox[{"A", ",", "B", ",", "1"}], "]"}], ",", 
       RowBox[{"rxn", "[", 
        RowBox[{"A", ",", "C", ",", "1"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"A", ",", "10", ",", "10"}], "]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2testmap", "=", 
   RowBox[{"Convert2FasterSpace", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"A", ",", "10", ",", "10"}], "]"}], "}"}], ",", "f2testCRN"}], 
    "]"}]}], ";", 
  RowBox[{"f2testtime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2testcolors", "=", 
   RowBox[{"Convert2FasterColoring", "[", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"A", "\[Rule]", "White"}], ",", 
       RowBox[{"B", "\[Rule]", "Red"}], ",", 
       RowBox[{"C", "\[Rule]", "Blue"}]}], "}"}], ",", "f2testCRN"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"First", "[", "f2testmap", "]"}], ",", 
    RowBox[{"ColorRules", "\[Rule]", "f2testcolors"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "f2testtime"}]}], "]"}], "]"}]}], "Input",\

 CellChangeTimes->CompressedData["
1:eJwdzk0ow3EAh/G1uMwY28xLu2BWRBuSph22KNkUUySlUGoXLIextayxNs1i
Y7ORl2JOXtryUorVstYStdHisKIR0hQX1C5+3//h6XN9yobHu0foNBqNT4JO
DcM2NZOW/4RDlFednhUdsf6sbR36WhZjMO/gl9Klf3O3m9PyBfaAF3YwUpvQ
tXq6Bfl1D4eQ/lTth6xBTaWCWB8xCqFt/UIEvbp4I/xMLUlg/1+pFF67MwoY
/spRwtvLVwMM+r4pv8ScWciLV1ihQG8cDBHH7rKGYDT7ZfPempZ3qY53oCdR
G4BFjqoTyLuxMx6JWssoE7Lnl6Uw6d+gbGKqJe/EXc4kZZRZW5A7R/6eGTzY
N8Nj5RN9kTfKCXklF6pNdsrCPdUiFMn0a5CtzkTgtkUQgzVOcbKBaNJxH6Gh
9ScFHcXmD6jekk03E3tLgguwRybch+VH4kOY8GnP4WlAGYT/vrXgMQ==
  "],
 CellLabel->
  "In[115]:=",ExpressionUUID->"d93b3d7e-9057-4b00-b22d-7636cb1bab7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.01"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f2testmap", "=", 
        RowBox[{"RunFasterSurfaceCRN", "[", 
         RowBox[{"f2testCRN", ",", "f2testmap", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"f2testtime", "+=", "dt"}]}], ",", "1000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}, {3.829433569281344*^9, 3.829433588311586*^9}, {
   3.829433998900132*^9, 3.829434010380258*^9}, {3.829505900761671*^9, 
   3.829505917044835*^9}, {3.82950595468222*^9, 3.829505955291613*^9}, {
   3.829519492635498*^9, 3.829519514947711*^9}, {3.8295197360012712`*^9, 
   3.8295197409006367`*^9}, {3.829519863945307*^9, 3.829519868817699*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"8884492a-888c-4f57-a373-9620f859d282"],

Cell[TextData[{
 "One awkwardness of the current I/O design for the simulator is that it \
returns after the first event that occurs with t > tmax.  This is bad for two \
reasons. (1) It is inappropriate for sampling.  To sample states with the \
correct probability, it should return with whatever state was at exactly \
t=tmax, i.e. don\[CloseCurlyQuote]t execute the final chosen action.  To see \
why, consider a CTMC with two states and transition rates 100,000 vs 1.  (2) \
When there are no more reactions that can occur, the simulator simply returns \
-- which is fine, but the user doesn\[CloseCurlyQuote]t know at what time the \
CRN halted.\n\nFor assessment of CRN algorithms, it would be desirable to \
report both the final time (either exactly tmax, or something earlier than \
tmax) and the total number of reaction events, together with the actual final \
state.  Unfortunately, this conflicts with Mathematica\[CloseCurlyQuote]s \
stupid convention that compiled functions must return exactly one rectangular \
N-dimensional numeric array.  An awkward work-around would be needed -- \
doable, but ugly.\n\nI will go ahead and do this, for the Faster simulation \
engine only.  The final state will be returned from the compiled function as \
a flattened integer array, with the extra information (time stamp, event \
count, haltedq) appended at the end.  A wrapper will reshape the array as \
needed.  The old interface will also be provided for backward compatibility \
convenience.  To return the real-valued time stamp within the integer array, \
we (awkwardly! how ridiculous that we must do this!) convert it to a \
sufficiently long sequence of digits.  Since ",
 StyleBox["RealDigits", "Code"],
 " is not compilable, we will work up our own version."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
   3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
   3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
   3.8295041211806803`*^9, 3.829504135823785*^9}, {3.829504941110911*^9, 
   3.829505086991987*^9}, {3.8295057225647593`*^9, 3.82950572895406*^9}, {
   3.829519187734001*^9, 3.829519226711488*^9}, {3.829521410368664*^9, 
   3.8295214719256163`*^9}, 3.829698989160634*^9, 3.829699624646728*^9, {
   3.8296996821317463`*^9, 3.829699964945628*^9}, {3.829700589330467*^9, 
   3.829700635321341*^9}, {3.829701544900729*^9, 3.829701642537818*^9}, {
   3.829763640744507*^9, 3.82976364718482*^9}, {3.8297638212249413`*^9, 
   3.829763829183195*^9}, {3.8297639076684113`*^9, 3.8297640625380774`*^9}, {
   3.829764254116136*^9, 3.82976433516599*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"bfe91e39-2827-4099-b3dd-d39f5f3f7858"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testx", "=", "123273.445143457"}]], "Input",
 CellChangeTimes->{{3.829761939295994*^9, 3.829761946107902*^9}, {
  3.8297643528613567`*^9, 3.8297643533847303`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"1baad454-2b24-4a1b-bcf1-fdd086a47d5f"],

Cell[BoxData["123273.445143457`"], "Output",
 CellChangeTimes->{3.829761946969466*^9, 3.829764356108939*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"83b9e0be-6bc8-43a2-9b34-42f45281fe4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RealDigits", "[", "testx", "]"}]], "Input",
 CellChangeTimes->{{3.829761766094184*^9, 3.82976177386489*^9}, {
  3.829761950056196*^9, 3.829761950997987*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"83090070-4874-436d-b725-d84a50c65c86"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "2", ",", "7", ",", "3", ",", "4", ",", "4",
      ",", "5", ",", "1", ",", "4", ",", "3", ",", "4", ",", "5", ",", "7", 
     ",", "0"}], "}"}], ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.8297617742250137`*^9, 3.82976195154908*^9, 
  3.82976435842064*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"6a9e4165-91af-49ef-b271-8f4c8a6af0b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myrealtodigits", "=", 
  RowBox[{"Compile", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "_Real"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "_Integer"}], "}"}]}], "}"}], ",", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"residue", "=", "x"}], ",", "next"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"next", "=", 
          RowBox[{"Floor", "[", "residue", "]"}]}], ";", 
         RowBox[{"residue", "=", 
          RowBox[{
           RowBox[{"10", "residue"}], "-", 
           RowBox[{"10", " ", "next"}]}]}], ";", " ", "next"}], ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.829761967306057*^9, 3.8297619900072308`*^9}, {
  3.829762342690256*^9, 3.8297623583524923`*^9}, {3.829762404747957*^9, 
  3.829762529885806*^9}, {3.829764371285653*^9, 3.8297644018236113`*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"ff7304f7-55e7-445e-8bc5-b37ede781c4b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox["CompiledFunction",
    "SummaryHead"], "[", 
   DynamicModuleBox[{Typeset`open$$ = False, Typeset`embedState$$ = "Ready"}, 
    
    TemplateBox[{
      PaneSelectorBox[{False -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxOpener"]], 
              ButtonFunction :> (Typeset`open$$ = True), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
                 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                
                "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
             AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  StyleBox[
                   PaneBox[
                    RowBox[{"{", 
                    RowBox[{"_Real", ",", "_Integer"}], "}"}], ContentPadding -> 
                    False, FrameMargins -> 0, StripOnInput -> True, 
                    BaselinePosition -> Baseline, 
                    ImageSize -> {{1, 300}, Automatic}], LineBreakWithin -> 
                   False], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}], True -> GridBox[{{
            PaneBox[
             ButtonBox[
              DynamicBox[
               FEPrivate`FrontEndResource["FEBitmaps", "SummaryBoxCloser"]], 
              ButtonFunction :> (Typeset`open$$ = False), Appearance -> None, 
              BaseStyle -> {}, Evaluator -> Automatic, Method -> 
              "Preemptive"], Alignment -> {Center, Center}, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}]], 
            GraphicsBox[{
              Thickness[0.038461538461538464`], {
               FaceForm[{
                 GrayLevel[0.93], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{1, 4, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}, {
                1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {0, 1, 0}}}, {{{
                25.499999999999996`, 2.5}, {25.499999999999996`, 
                1.3953100000000003`}, {24.604699999999998`, 
                0.49999999999999994`}, {23.5, 0.49999999999999994`}, {2.5, 
                0.49999999999999994`}, {1.3953100000000003`, 
                0.49999999999999994`}, {0.49999999999999994`, 
                1.3953100000000003`}, {0.49999999999999994`, 2.5}, {
                0.49999999999999994`, 23.5}, {0.49999999999999994`, 
                24.604699999999998`}, {1.3953100000000003`, 
                25.499999999999996`}, {2.5, 25.499999999999996`}, {23.5, 
                25.499999999999996`}, {24.604699999999998`, 
                25.499999999999996`}, {25.499999999999996`, 
                24.604699999999998`}, {25.499999999999996`, 23.5}, {
                25.499999999999996`, 2.5}}}]}, {
               FaceForm[{
                 RGBColor[0.5, 0.5, 0.5], 
                 Opacity[1.]}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{20.5426, 
                19.116799999999998`}, {16.3832, 21.876199999999997`}, {
                16.3832, 20.021499999999996`}, {6.930469999999999, 
                20.021499999999996`}, {6.930469999999999, 
                18.212100000000003`}, {16.3832, 18.212100000000003`}, {
                16.3832, 16.357399999999995`}, {20.5426, 
                19.116799999999998`}}}], 
               
               FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}, {0, 1, 0}, {
                0, 1, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{5.30508, 13.8391}, {
                9.46445, 11.079700000000003`}, {9.46445, 
                12.933999999999997`}, {18.917199999999998`, 
                12.933999999999997`}, {18.917199999999998`, 14.7438}, {
                9.46445, 14.7438}, {9.46445, 16.598}, {5.30508, 13.8391}}}], 
               
               FilledCurveBox[{{{1, 4, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {
                0, 1, 0}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 
                3}, {1, 3, 3}, {1, 3, 3}, {1, 3, 3}, {0, 1, 0}, {1, 3, 3}, {1,
                 3, 3}, {1, 3, 3}, {1, 3, 3}}}, CompressedData["
1:eJxTTMoPSmVmYGBgBGJjIGYCYq4u+eR3VWoOxhkv5j+Qk3SA8fu/r5rKOVHM
Yd2vmNyjZ9Qcrt9QXbW9S8RBg59767IidQcPMYPGaHFhB+Nn61SfiGo4xBwp
T7o2V9Dh0Iolfg6/NBxEHv/x1Xgi4FB1XNNqkqQWnP+axUTQjFkbzn+oO2HB
j/3aDg/Xn5T6WiDoYLs3aJpiqI7DrHN+bO6tQg4zfUR7vF7pQOyfIQyRd9d1
WLL0U1kLoyjEPdm6DpoTXfQX7xBzKPjQejLkhDacL5J4+LL2Gm2HtNnSl4Vf
iELM69J2qPZM3tLnJerQX1oozZugDfHPUxGI/4W1HQ5p3TthoyDi4D7lG1v8
Mi2HgqL9zoEHhB1inOxe3BRG8MH62zXhfIbN1Z82CGhC/GMg4nCm3mN/7TYN
iHlCUPdGakDc/1kUEr46GhD/eYnD+d9iBf/kC0vC+TuCrSL+X5Vy2HGR4R5T
uAbEfxYykPBYp+HQqsCuesZAFhL+rJoQ/2rIQdxTpwkJ7yVycPfD+GDzVqLx
xbUd5HYt2JfqBdWfpA2Jj9mykPDpgYaXtaxDy7yzq86vg8qvlIHE5ylY/Eo7
XAt7o787TxfOB5ufqesQ9PbyxxkPZSDhZ6nrMAGU3u7LQtLLEx2HN2253UbX
ofZ76jis/Pay4oynAsT8QG0HKZMv/gW7FCDyTFpwPsz/MD44/Mw1HFjb1uR9
TVVwWKy880/7FHWIexrkIfLX1RzOMDZZVjHIOaDkh3vSDuj5AwCF11Vc
                
                "]]}}, Background -> GrayLevel[0.93], Axes -> False, 
             AspectRatio -> 1, ImageSize -> 
             Dynamic[{
               Automatic, 
                3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                 Magnification])}], Frame -> True, FrameTicks -> None, 
             FrameStyle -> Directive[
               Thickness[Tiny], 
               GrayLevel[0.7]]], 
            GridBox[{{
               RowBox[{
                 TagBox["\"Argument count: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox["2", "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Argument types: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"{", 
                    RowBox[{"_Real", ",", "_Integer"}], "}"}], 
                   ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 0, 
                   StripOnInput -> True], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Variables: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  RowBox[{"{", 
                    RowBox[{"x", ",", "n"}], "}"}], "SummaryItem"]}]}, {
               RowBox[{
                 TagBox["\"Expression: \"", "SummaryItemAnnotation"], 
                 "\[InvisibleSpace]", 
                 TagBox[
                  PaneBox[
                   RowBox[{"Module", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"residue", "=", "x"}], ",", "next"}], "}"}], ",", 
                    
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"next", "=", 
                    RowBox[{"Floor", "[", "residue", "]"}]}], ";", 
                    RowBox[{"residue", "=", 
                    RowBox[{
                    RowBox[{"10", " ", "residue"}], "-", 
                    RowBox[{"10", " ", "next"}]}]}], ";", "next"}], ",", 
                    RowBox[{"{", "n", "}"}]}], "]"}]}], "]"}], 
                   ImageSize -> {{1, 500}, Automatic}, BaselinePosition -> 
                   Baseline, ContentPadding -> False, FrameMargins -> 0, 
                   StripOnInput -> True], "SummaryItem"]}]}}, 
             GridBoxAlignment -> {
              "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
             False, GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{2}}, "Rows" -> {{Automatic}}},
              BaseStyle -> {
              ShowStringCharacters -> False, NumberMarks -> False, 
               PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
          GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
          AutoDelete -> False, 
          GridBoxItemSize -> {
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
          BaselinePosition -> {1, 1}]}, 
       Dynamic[Typeset`open$$], ImageSize -> Automatic]},
     "SummaryPanel"],
    DynamicModuleValues:>{}], "]"}],
  CompiledFunction[{11, 12.2, 5720}, {
    Blank[Real], 
    Blank[Integer]}, {{3, 0, 0}, {2, 0, 0}, {2, 1, 
   1}}, {{0, {2, 0, 8}}, {10, {2, 0, 5}}, {1, {2, 0, 2}}}, {0, 10, 4, 0, 
   2}, {{7, 0, 1}, {6, 0, 6}, {6, 8, 3}, {35, 6, 2, 1}, {6, 8, 7}, {3, 10}, {
    40, 50, 3, 0, 1, 2, 0, 9}, {10, 5, 2}, {16, 2, 1, 2}, {15, 5, 9, 1}, {18, 
    1, 4}, {10, 4, 3}, {13, 2, 3, 2}, {7, 2, 1}, {36, 3, 9, 2, 1}, {4, 7, 
    6, -9}, {1}}, 
   Function[{$CellContext`x, $CellContext`n}, 
    Module[{$CellContext`residue = $CellContext`x, $CellContext`next}, 
     Table[$CellContext`next = 
       Floor[$CellContext`residue]; $CellContext`residue = 
       10 $CellContext`residue - 
        10 $CellContext`next; $CellContext`next, {$CellContext`n}]]], 
   Evaluate, 
   LibraryFunction[
   "/Users/winfree/Library/Mathematica/ApplicationData/CCompilerDriver/\
BuildFolder/EriksMBlame2018-18120/compiledFunction13.dylib", 
    "compiledFunction13", {{Real, 0, "Constant"}, {Integer, 0, "Constant"}}, {
    Integer, 1}]],
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.829762530994639*^9, {3.8297643757059927`*^9, 3.8297644024749813`*^9}},
 CellLabel->"Out[85]=",ExpressionUUID->"fe7bb239-cd32-4a35-b2a2-2f6fb52e3133"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testd", "=", 
  RowBox[{"myrealtodigits", "[", 
   RowBox[{"testx", ",", "14"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.829762534078154*^9, 3.8297625493276787`*^9}, {
  3.8297626076798267`*^9, 3.829762609043315*^9}, {3.829764379387702*^9, 
  3.8297644399531612`*^9}, {3.829765052089116*^9, 3.829765070608438*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"e0aead64-e1dd-4165-948f-ee92dde6af7f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "123273", ",", "4", ",", "4", ",", "5", ",", "1", ",", "4", ",", "3", ",", 
   "4", ",", "5", ",", "6", ",", "9", ",", "8", ",", "9", ",", "8"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.829762538838634*^9, 3.829762549544711*^9}, 
   3.829762609668614*^9, {3.829764384342782*^9, 3.829764440354604*^9}, {
   3.829765052578026*^9, 3.829765070916883*^9}},
 CellLabel->
  "Out[114]=",ExpressionUUID->"cf9b550f-aa82-4a5f-a71b-6bd881b21ad1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"myrealfromdigits", "[", "digs_", "]"}], ":=", 
  RowBox[{"N", "[", 
   RowBox[{"Plus", "@@", 
    RowBox[{"(", 
     RowBox[{"digs", " ", "*", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"10", "^", 
         RowBox[{"(", 
          RowBox[{"-", "i"}], ")"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", 
          RowBox[{
           RowBox[{"Length", "[", "digs", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.829762630245723*^9, 3.829762709979064*^9}, {
  3.829764388728237*^9, 3.829764395024626*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"c62e0909-a444-454c-b5c4-7cdac97b26da"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"myrealfromdigits", "[", "testd", "]"}], "-", 
  RowBox[{"(", "testx", ")"}]}]], "Input",
 CellChangeTimes->{{3.829762693263235*^9, 3.829762751367885*^9}, {
  3.829764419735338*^9, 3.829764430055623*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"f22d27a9-3fe9-4976-8d4c-e4b92b133b17"],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{{3.82976270464994*^9, 3.829762751801413*^9}, {
  3.8297644310305367`*^9, 3.829764445249769*^9}, {3.829765037828196*^9, 
  3.829765072602851*^9}},
 CellLabel->
  "Out[115]=",ExpressionUUID->"02dd4432-4bb5-4c4c-9047-e2233bac7aeb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"myrealfromdigits", "[", "testd", "]"}], "-", 
   RowBox[{"(", "testx", ")"}]}], "\[Equal]", "0.0"}]], "Input",
 CellChangeTimes->{{3.829765042029689*^9, 3.8297650455232143`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"3fdc40c0-20cc-4fe3-8173-b09760bb1585"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.829765043375185*^9, 3.829765074594287*^9}},
 CellLabel->
  "Out[116]=",ExpressionUUID->"af6cad3e-296c-4eec-bac3-fdd7daee0471"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Use the extra information to assess stochastic local search effectiveness\
\>", "Section",
 CellChangeTimes->{{3.8208008885551662`*^9, 3.820800901949781*^9}, {
  3.821763597606181*^9, 3.8217636024725533`*^9}, {3.8293093013511972`*^9, 
  3.82930930344156*^9}, {3.8293156298397093`*^9, 3.82931563816496*^9}, {
  3.829315738401884*^9, 3.8293157428071747`*^9}, {3.8294333010856047`*^9, 
  3.8294333108370953`*^9}, {3.829699670988783*^9, 3.829699672622196*^9}, {
  3.829770779070035*^9, 
  3.829770806554377*^9}},ExpressionUUID->"59a16f2a-47c3-4ccd-9688-\
114202f10545"],

Cell["\<\
Consider the surface CRN map coloring search from homework 6.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
  3.8295041211806803`*^9, 3.829504135823785*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"47480470-d5b8-4f3b-aee4-9c9f55de6161"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "w", ",", "v", ",", "V", ",", "e", ",", "R", ",", "G", ",", "B", ",", 
    "Y"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8217464180712757`*^9, 3.821746418161371*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"5d315708-a695-4c35-85af-7e4185700cfa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapG1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "v", ",", "v", ",", "v", ",", "v", ",", "v", ",", "v", ",", "v", ",", 
       "v", ",", "V", ",", "v", ",", "v", ",", "v", ",", "v", ",", "v", ",", 
       "w"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "v", ",", "w", ",", "w", ",", "w", ",", 
       "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", "w", ",", "v", ",", 
       "w"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", 
       "w"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", 
       "w"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", 
       "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", "v", ",", "v", ",", 
       "v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "e", ",", "w", ",", "v", ",", "V", ",", "v", ",", "e", ",", "e", ",", 
       "v", ",", "V", ",", "v", ",", "e", ",", "e", ",", "v", ",", "V", ",", 
       "v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "e", ",", "w", ",", "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", 
       "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", "v", ",", "v", ",", 
       "v"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", 
       "w"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", 
       "w"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "v", ",", "w", ",", "w", ",", "w", ",", 
       "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", "w", ",", "v", ",", 
       "w"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "v", ",", "v", ",", "v", ",", "v", ",", "v", ",", "v", ",", 
       "v", ",", "V", ",", "v", ",", "v", ",", "v", ",", "v", ",", "v", ",", 
       "w"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8217322544778967`*^9, 3.8217323096311903`*^9}, {
   3.821732375466367*^9, 3.8217323790470333`*^9}, {3.82173573334377*^9, 
   3.8217357562675533`*^9}, {3.8217437770465527`*^9, 3.82174377720208*^9}, 
   3.8217439263843937`*^9, {3.821743974969143*^9, 3.821744186955599*^9}, {
   3.8217442330856543`*^9, 3.821744427886586*^9}, {3.821744469413293*^9, 
   3.82174460276119*^9}, 3.821746974969253*^9},
 CellLabel->
  "In[173]:=",ExpressionUUID->"83d8c6f1-2b1e-483a-9041-296ae43296e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapG2", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "V", ",", "v", ",", "v", ",", "v", ",", "v", ",", "e", ",", 
       "e", ",", "v", ",", "V", ",", "v", ",", "v", ",", "v", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "v", ",", "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", 
       "w", ",", "v", ",", "v", ",", "v", ",", "w", ",", "e", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "v", ",", "v", ",", "v", ",", "e", ",", "w", ",", "V", ",", 
       "w", ",", "e", ",", "v", ",", "w", ",", "w", ",", "e", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "e", ",", "w", ",", "w", ",", "e", ",", "v", ",", "v", ",", 
       "v", ",", "e", ",", "w", ",", "w", ",", "v", ",", "v", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "e", ",", "w", ",", "e", ",", "v", ",", "v", ",", "v", ",", 
       "w", ",", "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "v", ",", "v", ",", "e", ",", "w", ",", "w", ",", "e", ",", 
       "e", ",", "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "v", ",", "v", ",", "v", ",", "e", ",", "w", ",", "w", ",", 
       "v", ",", "V", ",", "w", ",", "e", ",", "w", ",", "V", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "V", ",", "w", ",", "w", ",", "e", ",", "v", ",", "v", ",", 
       "v", ",", "v", ",", "v", ",", "e", ",", "w", ",", "w", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821678254982942*^9, 3.821678330938204*^9}, {
   3.821678414424005*^9, 3.821678569523535*^9}, {3.821678637735927*^9, 
   3.8216786423983583`*^9}, {3.821679161860919*^9, 3.821679240607868*^9}, {
   3.8216792963774633`*^9, 3.821679307350822*^9}, {3.8216794520642633`*^9, 
   3.8216794543276463`*^9}, {3.821735790295434*^9, 3.821735990932583*^9}, {
   3.821736110389112*^9, 3.821736194950152*^9}, {3.821743246007886*^9, 
   3.8217432476867933`*^9}, {3.821743694847932*^9, 3.821743695416432*^9}, 
   3.821744136691204*^9},
 CellLabel->
  "In[174]:=",ExpressionUUID->"33e2b45d-c145-4a22-9c8b-14fe6f6ff2d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapG3", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "w", ",", "w", ",", "w", ",", "e", ",", "e", ",", "v", ",", "v", ",", 
       "v", ",", "v", ",", "v", ",", "V", ",", "v", ",", "v", ",", "v", ",", 
       "v", ",", "v", ",", "e", ",", "e", ",", "w", ",", "w", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", 
       "w", ",", "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "v", ",", "V", ",", "v", ",", "e", ",", "e", ",", "w", ",", 
       "w", ",", "w", ",", "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "e", ",", "e", ",", "v", ",", "V", ",", "v", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "v", ",", "v", ",", "v", ",", "w", ",", "v", ",", "v", ",", 
       "v", ",", "w", ",", "w", ",", "e", ",", "w", ",", "w", ",", "v", ",", 
       "v", ",", "v", ",", "w", ",", "v", ",", "v", ",", "v", ",", "v"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "w", ",", "w", ",", "v", ",", "V", ",", 
       "v", ",", "w", ",", "v", ",", "v", ",", "v", ",", "w", ",", "v", ",", 
       "V", ",", "v", ",", "w", ",", "w", ",", "w", ",", "w", ",", "v"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "w", ",", "e", ",", "v", ",", "v", ",", 
       "v", ",", "w", ",", "v", ",", "V", ",", "v", ",", "w", ",", "v", ",", 
       "v", ",", "v", ",", "e", ",", "w", ",", "w", ",", "w", ",", "v"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "e", ",", "w", ",", "w", ",", "w", ",", "e", ",", "w", ",", "w", ",", 
       "e", ",", "e", ",", "v", ",", "v", ",", "v", ",", "e", ",", "e", ",", 
       "w", ",", "w", ",", "e", ",", "w", ",", "w", ",", "w", ",", "e"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "e", ",", "w", ",", "w", ",", "v", ",", "v", ",", "v", ",", "w", ",", 
       "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "v", ",", "v", ",", "v", ",", "w", ",", "w", ",", "e"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "w", ",", "v", ",", "V", ",", "v", ",", "v", ",", 
       "e", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", 
       "v", ",", "v", ",", "V", ",", "v", ",", "w", ",", "w", ",", "v"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "w", ",", "e", ",", "v", ",", "v", ",", "v", ",", "w", ",", 
       "e", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "e", ",", 
       "w", ",", "v", ",", "v", ",", "v", ",", "e", ",", "w", ",", "v"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "v", ",", "e", ",", "w", ",", "w", ",", "w", ",", "v", ",", 
       "v", ",", "v", ",", "w", ",", "w", ",", "w", ",", "v", ",", "v", ",", 
       "v", ",", "w", ",", "w", ",", "w", ",", "e", ",", "v", ",", "v"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "V", ",", "v", ",", "w", ",", "w", ",", "w", ",", "e", ",", "v", ",", 
       "V", ",", "v", ",", "v", ",", "e", ",", "w", ",", "v", ",", "V", ",", 
       "v", ",", "e", ",", "w", ",", "w", ",", "w", ",", "v", ",", "V"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "v", ",", "v", ",", "e", ",", "w", ",", "w", ",", "e", ",", "w", ",", 
       "v", ",", "v", ",", "w", ",", "e", ",", "v", ",", "v", ",", "v", ",", 
       "w", ",", "e", ",", "w", ",", "w", ",", "e", ",", "v", ",", "v"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "w", ",", "e", ",", "v", ",", "v", ",", "v", ",", "w", ",", 
       "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", "w", ",", 
       "w", ",", "v", ",", "v", ",", "v", ",", "e", ",", "w", ",", "w"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "w", ",", "w", ",", "w", ",", "v", ",", "V", ",", "v", ",", "v", ",", 
       "v", ",", "v", ",", "e", ",", "e", ",", "v", ",", "v", ",", "v", ",", 
       "v", ",", "v", ",", "V", ",", "v", ",", "w", ",", "w", ",", "w"}], 
      "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.821744735470129*^9, 3.821744741653872*^9}, {
   3.821745372151782*^9, 3.821745995368031*^9}, 3.821746398701013*^9},
 CellLabel->
  "In[175]:=",ExpressionUUID->"c0dfa0e0-f863-4341-867c-884013f54733"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"surfacecolormap", "[", "k_", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rxn", "[", 
      RowBox[{"V", ",", 
       RowBox[{"V", "[", "1", "]"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{"v", ",", 
       RowBox[{"v", "[", "1", "]"}], ",", "1"}], "]"}], ",", 
     RowBox[{"rxn", "[", 
      RowBox[{"e", ",", 
       RowBox[{"e", "[", "1", "]"}], ",", "1"}], "]"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "let", " ", "everything", " ", "start", " ", "in", " ", "the", " ", 
        "same", " ", "color"}], ",", " ", 
       RowBox[{"why", " ", 
        RowBox[{"not", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"c1", "=!=", "c2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"rxn", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"V", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"V", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", " ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"V", " ", "and", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{"V", " ", "follows", " ", "v"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"rxn", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"v", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"neighboring", " ", "v", " ", "must", " ", "agree"}], 
              ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rxn", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", "1"}], "]"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
              RowBox[{
              "v", " ", "and", " ", "neighboring", " ", "e", " ", "must", " ",
                "agree"}], ";", " ", 
              RowBox[{"if", " ", "not"}]}], ",", " ", 
             RowBox[{
             "one", " ", "randomly", " ", "follows", " ", "the", " ", 
              "other"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"rxn", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", 
             RowBox[{
              RowBox[{"v", "[", "c2", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "1"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"rxn", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c1", "]"}]}], ",", 
             RowBox[{
              RowBox[{"e", "[", "c1", "]"}], "+", 
              RowBox[{"e", "[", "c2", "]"}]}], ",", "1"}], "]"}]}], " ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "adjacent", " ", "edge", " ", "sites", " ", "must", " ", "be", 
              " ", "different"}], ";", " ", 
             RowBox[{"if", " ", "not"}]}], ",", " ", 
            RowBox[{"one", " ", "randomly", " ", "changes"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "1", ",", "k"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c2", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mapcoloring", "[", "k_", "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"colors", "=", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "/@", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "1", ",", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{"k", "-", "1"}], ")"}]}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Join", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"w", "\[Rule]", "White"}], ",", 
         RowBox[{"v", "\[Rule]", "Gray"}], ",", 
         RowBox[{"V", "\[Rule]", 
          RowBox[{"GrayLevel", "[", "0.9", "]"}]}], ",", 
         RowBox[{"e", "\[Rule]", " ", "Black"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"V", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Darker", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"v", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"colors", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"e", "[", "i", "]"}], "\[Rule]", 
            RowBox[{"Lighter", "[", 
             RowBox[{"colors", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "k"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8227455342787046`*^9, 3.822745601673834*^9}, {
  3.82274563183298*^9, 3.822745949825758*^9}, {3.822746031685027*^9, 
  3.822746137818844*^9}, {3.8234573730966253`*^9, 3.823457428782569*^9}, {
  3.8234574682603397`*^9, 3.823457468509324*^9}, {3.823457553491206*^9, 
  3.823457628450881*^9}, {3.823457733991033*^9, 3.823457819215838*^9}, {
  3.823458146910564*^9, 3.823458254911467*^9}, {3.823458333534028*^9, 
  3.823458351131825*^9}, {3.8234583918536263`*^9, 3.823458583649609*^9}, {
  3.823459046702734*^9, 3.82345904950812*^9}, {3.8234593409220037`*^9, 
  3.82345955414063*^9}, {3.823459600029277*^9, 3.823459606141295*^9}, {
  3.823459655205483*^9, 3.823459666627646*^9}, {3.823460107628531*^9, 
  3.823460108076693*^9}, {3.823460181809284*^9, 3.823460375379985*^9}, {
  3.8234605204249887`*^9, 3.823460523181069*^9}, {3.8234610951539183`*^9, 
  3.823461098778034*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"aaa66a6b-5335-4712-8807-e1af9513c3cc"],

Cell[BoxData[
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{"solidmap", ",", 
    RowBox[{"ColorRules", "\[Rule]", "solidcolors"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "solidtime"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8216785734305277`*^9, 3.821678613439493*^9}, {
   3.821679168452817*^9, 3.821679172265233*^9}, {3.8216793962630167`*^9, 
   3.821679399926448*^9}, {3.821679440928866*^9, 3.821679447438106*^9}, {
   3.821735999846561*^9, 3.821736098413896*^9}, {3.821736198311803*^9, 
   3.821736209550115*^9}, {3.821743688690548*^9, 3.821743688811068*^9}, {
   3.82174374058354*^9, 3.8217438349283733`*^9}, {3.823458704645318*^9, 
   3.823458724149832*^9}, 3.823459057865675*^9},
 CellLabel->
  "In[178]:=",ExpressionUUID->"43236119-01af-4e8b-9772-6e15cefde2e1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solidmap", "=", "mapG1"}], ";", 
  RowBox[{"solidCRN", "=", 
   RowBox[{"surfacecolormap", "[", "4", "]"}]}], ";", 
  RowBox[{"solidcolors", "=", 
   RowBox[{"mapcoloring", "[", "4", "]"}]}], ";", 
  RowBox[{"solidtime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"HaltedSurfaceCRNQ", "[", 
     RowBox[{"solidCRN", ",", "solidmap"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"solidmap", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"solidCRN", ",", "solidmap", ",", "1"}], "]"}]}], ";", 
    RowBox[{"solidtime", "+=", "1"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.821679416206723*^9, 3.821679423138385*^9}, {
  3.821743682408266*^9, 3.821743684243951*^9}, {3.821743716311751*^9, 
  3.821743716442052*^9}, {3.8217446678744583`*^9, 3.821744667933625*^9}, {
  3.823458764626644*^9, 3.8234588420014153`*^9}, {3.82345908308384*^9, 
  3.823459103755735*^9}, {3.823459785892694*^9, 3.823459809131413*^9}, {
  3.823459852248506*^9, 3.823459852375947*^9}, {3.823460984160722*^9, 
  3.8234609895961647`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"f5209997-4dfc-4101-9fab-d523b175b718"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solidmap", "=", "mapG2"}], ";", 
  RowBox[{"solidCRN", "=", 
   RowBox[{"surfacecolormap", "[", "3", "]"}]}], ";", 
  RowBox[{"solidcolors", "=", 
   RowBox[{"mapcoloring", "[", "3", "]"}]}], ";", 
  RowBox[{"solidtime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"HaltedSurfaceCRNQ", "[", 
     RowBox[{"solidCRN", ",", "solidmap"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"solidmap", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"solidCRN", ",", "solidmap", ",", "1"}], "]"}]}], ";", 
    RowBox[{"solidtime", "+=", "1"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.821679416206723*^9, 3.821679423138385*^9}, {
  3.821743682408266*^9, 3.821743684243951*^9}, {3.821743716311751*^9, 
  3.821743716442052*^9}, {3.8217446678744583`*^9, 3.821744667933625*^9}, {
  3.823458764626644*^9, 3.8234588420014153`*^9}, {3.82345908308384*^9, 
  3.823459103755735*^9}, {3.823459785892694*^9, 3.823459809131413*^9}, {
  3.823459852248506*^9, 3.823459852375947*^9}, {3.823460984160722*^9, 
  3.823461010196212*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"12815df3-7586-4209-9bce-cf05f6ac6d4e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"solidmap", "=", "mapG3"}], ";", 
  RowBox[{"solidCRN", "=", 
   RowBox[{"surfacecolormap", "[", "3", "]"}]}], ";", 
  RowBox[{"solidcolors", "=", 
   RowBox[{"mapcoloring", "[", "3", "]"}]}], ";", 
  RowBox[{"solidtime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"While", "[", 
  RowBox[{
   RowBox[{"!", 
    RowBox[{"HaltedSurfaceCRNQ", "[", 
     RowBox[{"solidCRN", ",", "solidmap"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"solidmap", "=", 
     RowBox[{"RunSurfaceCRN", "[", 
      RowBox[{"solidCRN", ",", "solidmap", ",", "1"}], "]"}]}], ";", 
    RowBox[{"solidtime", "+=", "1"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.821679416206723*^9, 3.821679423138385*^9}, {
  3.821743682408266*^9, 3.821743684243951*^9}, {3.821743716311751*^9, 
  3.821743716442052*^9}, {3.8217446678744583`*^9, 3.821744667933625*^9}, {
  3.823458764626644*^9, 3.8234588420014153`*^9}, {3.82345908308384*^9, 
  3.823459103755735*^9}, {3.823459785892694*^9, 3.823459809131413*^9}, {
  3.823459852248506*^9, 3.823459852375947*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"917a7020-575e-4f35-b648-819f687a040c"],

Cell[TextData[{
 "To compare timing, we must assess whether our results are dominated by \
noise or not, so let\[CloseCurlyQuote]s take a look at the variance for how \
long it takes to find a solution.  We use ",
 StyleBox["dt=10", "Code"],
 " to ensure that the halting test consumes only a small fraction of compute \
time, at the cost of resolution.  We use local variables to be sure we don\
\[CloseCurlyQuote]t trigger ",
 StyleBox["Dynamic", "Code"],
 " computations such as drawing the map."
}], "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
  3.8295041211806803`*^9, 3.829504135823785*^9}, {3.829504941110911*^9, 
  3.829505086991987*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"3269ae80-8eb4-4a28-8ea5-608d1880c08c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"map", ",", 
      RowBox[{"CRN", "=", 
       RowBox[{"surfacecolormap", "[", "4", "]"}]}], ",", 
      RowBox[{"colors", "=", 
       RowBox[{"mapcoloring", "[", "4", "]"}]}], ",", "time", ",", 
      RowBox[{"dt", "=", "10"}], ",", 
      RowBox[{"trials", "=", "20"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"times", "=", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"map", "=", "mapG1"}], ";", 
         RowBox[{"time", "=", "0"}], ";", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"HaltedSurfaceCRNQ", "[", 
             RowBox[{"CRN", ",", "map"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"map", "=", 
             RowBox[{"RunSurfaceCRN", "[", 
              RowBox[{"CRN", ",", "map", ",", "dt"}], "]"}]}], ";", 
            RowBox[{"time", "+=", "dt"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", "time"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "trials", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "times", "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1.0", 
         RowBox[{"Mean", "[", "times", "]"}]}], ",", 
        RowBox[{"1.0", 
         RowBox[{
          RowBox[{"StandardDeviation", "[", "times", "]"}], "/", 
          RowBox[{"Sqrt", "[", "trials", "]"}]}]}]}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.821679416206723*^9, 3.821679423138385*^9}, {
  3.821743682408266*^9, 3.821743684243951*^9}, {3.821743716311751*^9, 
  3.821743716442052*^9}, {3.8217446678744583`*^9, 3.821744667933625*^9}, {
  3.823458764626644*^9, 3.8234588420014153`*^9}, {3.82345908308384*^9, 
  3.823459103755735*^9}, {3.823459785892694*^9, 3.823459809131413*^9}, {
  3.823459852248506*^9, 3.823459852375947*^9}, {3.823460984160722*^9, 
  3.8234609895961647`*^9}, {3.8295044807498093`*^9, 3.8295045773298492`*^9}, {
  3.829504609739447*^9, 3.829504627458302*^9}, {3.82950504666503*^9, 
  3.8295050478854218`*^9}, {3.829505108338167*^9, 3.829505109213414*^9}, {
  3.829505147468432*^9, 3.829505156592897*^9}, {3.829505230618726*^9, 
  3.829505254589836*^9}, {3.829505287769094*^9, 3.829505432260335*^9}, {
  3.829505658711297*^9, 3.829505661341591*^9}, {3.8297715886985083`*^9, 
  3.829771588735084*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"ad2501a2-596a-4049-8941-c4c4be38ec6d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "100", ",", "340", ",", "1450", ",", "2030", ",", "2100", ",", "260", ",", 
   "860", ",", "70", ",", "1060", ",", "340", ",", "100", ",", "400", ",", 
   "290", ",", "290", ",", "500", ",", "180", ",", "570", ",", "240", ",", 
   "410", ",", "270"}], "}"}]], "Print",
 CellChangeTimes->{3.829505614571692*^9, 3.829505846864978*^9, 
  3.829771944704526*^9},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"7d537a0a-a5e5-4251-879a-752ef9b0734f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"593.`", ",", "135.93167788500068`"}], "}"}]], "Print",
 CellChangeTimes->{3.829505614571692*^9, 3.829505846864978*^9, 
  3.829771944707225*^9},
 CellLabel->
  "During evaluation of \
In[204]:=",ExpressionUUID->"975ecf69-9a62-43e6-b167-47ccdcd4d05c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"343.43822`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.82950459204716*^9, 3.829504864716736*^9, 
  3.8295052787174797`*^9, 3.829505614596828*^9, 3.82950584688916*^9, 
  3.8297719447153254`*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"72b909ff-a491-4cf7-96c9-ac461acef449"]
}, Open  ]],

Cell["\<\
How does the new simulator do?  About 1000x faster here, but that\
\[CloseCurlyQuote]s a high-variance estimate.  Note that here we also \
demonstrate using the extra simulation information with the final time, event \
counts, and halting status.\
\>", "Text",
 CellChangeTimes->{{3.821485952270832*^9, 3.821485967695526*^9}, {
  3.8214860024429073`*^9, 3.821486003566992*^9}, {3.8214956625604*^9, 
  3.8214957103592033`*^9}, {3.829433795350864*^9, 3.829433807332453*^9}, {
  3.8295041211806803`*^9, 3.829504135823785*^9}, {3.829504941110911*^9, 
  3.829505086991987*^9}, {3.8295057225647593`*^9, 3.82950572895406*^9}, {
  3.829521250505604*^9, 3.829521259246084*^9}, {3.829521347375373*^9, 
  3.82952137355026*^9}, {3.8297719702777023`*^9, 3.829771970788583*^9}, {
  3.829772481777429*^9, 3.8297725031010933`*^9}},
 Background->RGBColor[
  1, 0.9, 0.8],ExpressionUUID->"aced3214-db82-486b-95aa-867ee0c55e96"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solidmap", "=", "mapG1"}], ";", 
  RowBox[{"solidCRN", "=", 
   RowBox[{"surfacecolormap", "[", "4", "]"}]}], ";", 
  RowBox[{"solidcolors", "=", 
   RowBox[{"mapcoloring", "[", "4", "]"}]}], ";", 
  RowBox[{"solidtime", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.821679416206723*^9, 3.821679423138385*^9}, {
  3.821743682408266*^9, 3.821743684243951*^9}, {3.821743716311751*^9, 
  3.821743716442052*^9}, {3.8217446678744583`*^9, 3.821744667933625*^9}, {
  3.823458764626644*^9, 3.8234588420014153`*^9}, {3.82345908308384*^9, 
  3.823459103755735*^9}, {3.823459785892694*^9, 3.823459809131413*^9}, {
  3.823459852248506*^9, 3.823459852375947*^9}, {3.823460984160722*^9, 
  3.8234609895961647`*^9}, {3.829505745376399*^9, 3.82950575331019*^9}, {
  3.829505805429357*^9, 3.829505810380953*^9}},
 CellLabel->
  "In[186]:=",ExpressionUUID->"37db2ed7-0b20-4f5d-8420-fc50bdac8188"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fsolidCRN", "=", 
   RowBox[{"PreprocessFasterSurfaceCRN", "[", 
    RowBox[{
     RowBox[{"surfacecolormap", "[", "4", "]"}], ",", 
     RowBox[{"{", "solidmap", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fsolidmap", "=", 
   RowBox[{"Convert2FasterSpace", "[", 
    RowBox[{
     RowBox[{"{", "solidmap", "}"}], ",", "fsolidCRN"}], "]"}]}], ";", " ", 
  RowBox[{"fsolidmaporig", "=", "fsolidmap"}], ";", 
  RowBox[{"fsolidtime", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fsolidcolors", "=", 
   RowBox[{"Convert2FasterColoring", "[", " ", 
    RowBox[{"solidcolors", ",", "fsolidCRN"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Dynamic", "[", 
  RowBox[{"ArrayPlot", "[", 
   RowBox[{
    RowBox[{"First", "[", "fsolidmap", "]"}], ",", 
    RowBox[{"ColorRules", "\[Rule]", "fsolidcolors"}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "fsolidtime"}]}], "]"}], "]"}]}], "Input",\

 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIQPbGAq6ui6Y3jtyMHwfQp/+nTKoG00U73OSB6iXP/
BRDNt/Y7mJ5S9XyqZ8sbxz6h2Bkg2ofr0TwQPWXmtvkgWsbwxjoQzfRAawOI
5k8oUPUC0kbH6tVAdNecvfogekblRVMQ/fbRJEsQHfVDygZEn5n62wtEH/nA
7Q2iLx1+VgOi9y35CKY/GAg3g2ixi8rtIFqlqj7hIJDOu8ySCKJPsD6Zd739
jWNA4JbFIHr6Vd2NIFp8guZWEC12tofrPpAua8vlAdFC3ZNtQPSdDXPBtDlP
huULIL1UuBxMn+DRFeTtALrvMZcYiI5oEuMXANJLjj0H00WOqiIgOqOxB0yL
rg7sB9H6DlWzQLRQxu9jIHpRm8oFEK0z0eCOMZBurBS5D6JrXL49AtETJFpe
geg9Je8LrYG02K9JRSAaAMn90WQ=
  "],
 CellLabel->
  "In[193]:=",ExpressionUUID->"460d2204-ecf7-4379-92c6-4c92e2adf369"],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dt", "=", "0.1"}], "}"}], ",", 
    RowBox[{"Do", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"fsolidmap", "=", 
        RowBox[{"RunFasterSurfaceCRN", "[", 
         RowBox[{"fsolidCRN", ",", "fsolidmap", ",", "dt"}], "]"}]}], ";", 
       RowBox[{"fsolidtime", "+=", "dt"}]}], ",", "5000"}], "]"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8265007049884033`*^9, 3.826500753483485*^9}, {
   3.826500895512076*^9, 3.8265009063433743`*^9}, {3.82650103662197*^9, 
   3.826501040570825*^9}, {3.826501379797226*^9, 3.8265013852253733`*^9}, {
   3.8265021681789494`*^9, 3.826502208320465*^9}, {3.826503313586913*^9, 
   3.826503329601192*^9}, 3.8265034174200974`*^9, {3.826503683487208*^9, 
   3.8265037133505373`*^9}, {3.826503903214088*^9, 3.82650390465707*^9}, {
   3.8274511400885687`*^9, 3.827451189067627*^9}, {3.827451223072109*^9, 
   3.827451294958457*^9}, {3.827451376946212*^9, 3.827451390146679*^9}, {
   3.827453039976396*^9, 3.827453042212372*^9}, {3.827453135011508*^9, 
   3.82745314819283*^9}, {3.8274550514963408`*^9, 3.82745505784788*^9}, {
   3.827455368646552*^9, 3.827455370446666*^9}, {3.827456726805142*^9, 
   3.827456741338868*^9}, {3.827500309344345*^9, 3.827500309577405*^9}, {
   3.829317056770383*^9, 3.8293170674177732`*^9}, {3.8294263672808313`*^9, 
   3.829426385961532*^9}, {3.829433569281344*^9, 3.829433588311586*^9}, {
   3.829433998900132*^9, 3.829434010380258*^9}, {3.829505900761671*^9, 
   3.829505917044835*^9}, {3.82950595468222*^9, 3.829505955291613*^9}},
 CellLabel->
  "In[192]:=",ExpressionUUID->"c6e64167-b1fa-4456-bc40-8e3ebe3c4e8d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"fsolidmap", "=", 
    RowBox[{"RunFasterSurfaceCRN", "[", 
     RowBox[{"fsolidCRN", ",", "fsolidmaporig", ",", "1000000000"}], "]"}]}], 
   ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.8274568443617573`*^9, 3.8274568968917418`*^9}, {
  3.82931710156116*^9, 3.829317117244265*^9}, {3.829426374661085*^9, 
  3.829426379993998*^9}, {3.829433595756118*^9, 3.829433616793064*^9}, {
  3.829434161159872*^9, 3.829434167040907*^9}, {3.829507681815029*^9, 
  3.829507694242138*^9}, {3.8295202538860197`*^9, 3.829520263918454*^9}, {
  3.8295210833180304`*^9, 3.829521085538373*^9}, {3.829521515648982*^9, 
  3.829521516049943*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"e18bf783-79b2-4a01-a27e-c7b551e7f810"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.030655`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.827456899237506*^9, 3.82752337585714*^9, {3.8276895482096443`*^9, 
   3.827689555423439*^9}, 3.827698448780013*^9, 3.8276989466503687`*^9, 
   3.829317128820662*^9, 3.829426540789028*^9, 3.829433620917951*^9, 
   3.8294341768287373`*^9, 3.829507695708005*^9, 3.829520145620885*^9, {
   3.82952025603594*^9, 3.829520271099983*^9}, {3.8295210864370737`*^9, 
   3.829521101907363*^9}, 3.829521276112686*^9, {3.829521509161202*^9, 
   3.829521526590996*^9}, 3.8297709385365877`*^9},
 CellLabel->
  "Out[197]=",ExpressionUUID->"58fa99ef-dc4e-4227-8bb0-6f2c7efd949d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tfinal", ",", "eventcount", ",", "haltedq"}], "}"}], ",", 
      "fsolidmap"}], "}"}], "=", 
    RowBox[{"InfoRunFasterSurfaceCRN", "[", 
     RowBox[{"fsolidCRN", ",", "fsolidmaporig", ",", "1000000000"}], "]"}]}], 
   ";"}], "]"}]], "Input",
 CellChangeTimes->{{3.8274568443617573`*^9, 3.8274568968917418`*^9}, {
  3.82931710156116*^9, 3.829317117244265*^9}, {3.829426374661085*^9, 
  3.829426379993998*^9}, {3.829433595756118*^9, 3.829433616793064*^9}, {
  3.829434161159872*^9, 3.829434167040907*^9}, {3.829507681815029*^9, 
  3.829507694242138*^9}, {3.8295202538860197`*^9, 3.829520263918454*^9}, {
  3.8295210833180304`*^9, 3.829521085538373*^9}, {3.829521515648982*^9, 
  3.829521516049943*^9}, {3.829770973301093*^9, 3.829770995369684*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"d174099e-a6ea-4a7d-94af-92ba884a896d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.012611`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.8297710007164793`*^9},
 CellLabel->
  "Out[198]=",ExpressionUUID->"eb7d00c0-6b34-4442-9d82-a201d4d12cde"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"tfinal", ",", "eventcount", ",", "haltedq"}], "}"}]], "Input",
 CellChangeTimes->{{3.829771003550433*^9, 3.829771019169874*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"aa403515-6f33-4593-8a9c-a5e61f22d992"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"341.1`", ",", "1673", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.829771005293065*^9, 3.8297710196046658`*^9}},
 CellLabel->
  "Out[200]=",ExpressionUUID->"f9ab8f43-3173-4195-98eb-f3f8a2dbe3a7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"CRN", "=", "fsolidCRN"}], ",", 
      RowBox[{"colors", "=", "fsolidcolors"}], ",", 
      RowBox[{"trials", "=", "20"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"times", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"tfinal", ",", "eventcount", ",", "haltedq"}], "}"}], 
            ",", "fsolidmap"}], "}"}], "=", 
          RowBox[{"InfoRunFasterSurfaceCRN", "[", 
           RowBox[{"fsolidCRN", ",", "fsolidmaporig", ",", "1000000000"}], 
           "]"}]}], ";", "tfinal"}], ",", 
        RowBox[{"{", "trials", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "times", "]"}], ";", 
     RowBox[{"Print", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1.0", 
         RowBox[{"Mean", "[", "times", "]"}]}], ",", 
        RowBox[{"1.0", 
         RowBox[{
          RowBox[{"StandardDeviation", "[", "times", "]"}], "/", 
          RowBox[{"Sqrt", "[", "trials", "]"}]}]}]}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.821679416206723*^9, 3.821679423138385*^9}, {
   3.821743682408266*^9, 3.821743684243951*^9}, {3.821743716311751*^9, 
   3.821743716442052*^9}, {3.8217446678744583`*^9, 3.821744667933625*^9}, {
   3.823458764626644*^9, 3.8234588420014153`*^9}, {3.82345908308384*^9, 
   3.823459103755735*^9}, {3.823459785892694*^9, 3.823459809131413*^9}, {
   3.823459852248506*^9, 3.823459852375947*^9}, {3.823460984160722*^9, 
   3.8234609895961647`*^9}, {3.8295044807498093`*^9, 
   3.8295045773298492`*^9}, {3.829504609739447*^9, 3.829504627458302*^9}, {
   3.82950504666503*^9, 3.8295050478854218`*^9}, {3.829505108338167*^9, 
   3.829505109213414*^9}, {3.829505147468432*^9, 3.829505156592897*^9}, {
   3.829505230618726*^9, 3.829505254589836*^9}, {3.829505287769094*^9, 
   3.829505432260335*^9}, {3.829505658711297*^9, 3.829505661341591*^9}, {
   3.829520193411632*^9, 3.829520229743325*^9}, {3.829521135264435*^9, 
   3.8295212034446373`*^9}, {3.8295213047211514`*^9, 3.829521305032978*^9}, 
   3.8295213364284267`*^9, 3.829521378429782*^9, {3.829521553021326*^9, 
   3.829521553840578*^9}, {3.829771441737054*^9, 3.829771458355307*^9}, {
   3.829771538724999*^9, 3.829771569049387*^9}, {3.829771611367684*^9, 
   3.8297716181402397`*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"058e6224-c468-425a-97a9-63f53d9e80cb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "537.4`", ",", "104.7`", ",", "569.`", ",", "257.6`", ",", "164.2`", ",", 
   "1194.1`", ",", "114.4`", ",", "501.2`", ",", "253.6`", ",", "357.2`", ",",
    "1501.8`", ",", "916.9`", ",", "491.7`", ",", "296.`", ",", "104.1`", ",",
    "285.8`", ",", "151.`", ",", "1594.6`", ",", "80.9`", ",", "97.1`"}], 
  "}"}]], "Print",
 CellChangeTimes->{
  3.829771569954303*^9, 3.8297719566582747`*^9, {3.829772419986607*^9, 
   3.829772450250861*^9}},
 CellLabel->
  "During evaluation of \
In[212]:=",ExpressionUUID->"09bb6b9c-2d8c-41e7-b341-c0e41da9ef90"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"478.66499999999996`", ",", "104.07539758701253`"}], "}"}]], "Print",\

 CellChangeTimes->{
  3.829771569954303*^9, 3.8297719566582747`*^9, {3.829772419986607*^9, 
   3.829772450252005*^9}},
 CellLabel->
  "During evaluation of \
In[212]:=",ExpressionUUID->"dadc0da7-568a-4929-884e-f6ecbd489e28"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.34151`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.829521211766658*^9, {3.8295212791724033`*^9, 3.8295213405061293`*^9}, 
   3.829521379197316*^9, {3.8295215338153267`*^9, 3.8295215658220053`*^9}, {
   3.829771451555111*^9, 3.8297714593503647`*^9}, 3.829771569991198*^9, 
   3.829771956662142*^9, {3.829772419988765*^9, 3.8297724502529793`*^9}},
 CellLabel->
  "Out[212]=",ExpressionUUID->"d7d60aab-75c2-4e12-83e6-e6100de02260"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1517, 861},
WindowMargins->{{Automatic, 0}, {1, Automatic}},
InputAliases->{"intt" -> RowBox[{"\[Integral]", 
     RowBox[{"\[SelectionPlaceholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "dintt" -> 
  RowBox[{
     SubsuperscriptBox[
     "\[Integral]", "\[SelectionPlaceholder]", "\[Placeholder]"], 
     RowBox[{"\[Placeholder]", 
       RowBox[{"\[DifferentialD]", "\[Placeholder]"}]}]}], "rintt" -> 
  RowBox[{
     UnderscriptBox["\[Integral]", 
      RowBox[{"\[SelectionPlaceholder]", "\[Element]", "\[Placeholder]"}]], 
     "\[Placeholder]"}], "sumt" -> RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "prodt" -> RowBox[{
     UnderoverscriptBox["\[Product]", 
      RowBox[{"\[SelectionPlaceholder]", "=", "\[Placeholder]"}], 
      "\[Placeholder]"], "\[Placeholder]"}], "dt" -> RowBox[{
     SubscriptBox["\[PartialD]", "\[Placeholder]"], " ", 
     "\[SelectionPlaceholder]"}], "cbrt" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "3", SurdForm -> True, MultilineFunction -> 
    None], "surd" -> 
  RadicalBox[
   "\[SelectionPlaceholder]", "\[Placeholder]", SurdForm -> True, 
    MultilineFunction -> None], "ket" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Ket"], "bra" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "Bra"], "braket" -> 
  TemplateBox[{"\[SelectionPlaceholder]", "\[Placeholder]"}, "BraKet"], 
  "delay" -> TemplateBox[{"\[SelectionPlaceholder]"}, "SystemsModelDelay"], 
  "grad" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Placeholder]"}], 
  "del." -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], ".", 
     "\[Placeholder]"}], "delx" -> RowBox[{
     SubscriptBox["\[Del]", "\[SelectionPlaceholder]"], "\[Cross]", 
     "\[Placeholder]"}], "del2" -> RowBox[{
     SubsuperscriptBox["\[Del]", "\[SelectionPlaceholder]", 2], 
     "\[Placeholder]"}], "kd" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "KroneckerDeltaSeq"], "algs" -> 
  TemplateBox[{}, "Algebraics"], "bools" -> TemplateBox[{}, "Booleans"], 
  "comps" -> TemplateBox[{}, "Complexes"], "ints" -> 
  TemplateBox[{}, "Integers"], "pris" -> TemplateBox[{}, "Primes"], "rats" -> 
  TemplateBox[{}, "Rationals"], "reals" -> TemplateBox[{}, "Reals"], "pints" -> 
  TemplateBox[{}, "PositiveIntegers"], "npints" -> 
  TemplateBox[{}, "NonPositiveIntegers"], "nnints" -> 
  TemplateBox[{}, "NonNegativeIntegers"], "nints" -> 
  TemplateBox[{}, "NegativeIntegers"], "prats" -> 
  TemplateBox[{}, "PositiveRationals"], "nprats" -> 
  TemplateBox[{}, "NonPositiveRationals"], "nnrats" -> 
  TemplateBox[{}, "NonNegativeRationals"], "nrats" -> 
  TemplateBox[{}, "NegativeRationals"], "preals" -> 
  TemplateBox[{}, "PositiveReals"], "npreals" -> 
  TemplateBox[{}, "NonPositiveReals"], "nnreals" -> 
  TemplateBox[{}, "NonNegativeReals"], "nreals" -> 
  TemplateBox[{}, "NegativeReals"], "dlim" -> RowBox[{
     UnderscriptBox["\[Limit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dMlim" -> RowBox[{
     UnderscriptBox["\[MaxLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "dmlim" -> RowBox[{
     UnderscriptBox["\[MinLimit]", 
      RowBox[{"\[SelectionPlaceholder]", 
        UnderscriptBox["\[Rule]", 
         TemplateBox[{}, "Integers"]], "\[Infinity]"}]], "\[Placeholder]"}], 
  "notation" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation>" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongRightArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "notation<" -> RowBox[{"Notation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], " ", 
       "\[DoubleLongLeftArrow]", " ", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "symb" -> RowBox[{"Symbolize", "[", 
     TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], "]"}], 
  "infixnotation" -> RowBox[{"InfixNotation", "[", 
     RowBox[{
       TemplateBox[{"\[SelectionPlaceholder]"}, "NotationTemplateTag"], ",", 
       "\[Placeholder]"}], "]"}], "addia" -> RowBox[{"AddInputAlias", "[", 
     RowBox[{"\"\[SelectionPlaceholder]\"", "\[Rule]", 
       TemplateBox[{"\[Placeholder]"}, "NotationTemplateTag"]}], "]"}], 
  "pattwraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationPatternTag"], 
  "madeboxeswraper" -> 
  TemplateBox[{"\[SelectionPlaceholder]"}, "NotationMadeBoxesTag"], "rxn" -> 
  RowBox[{"\[Placeholder]", " ", 
     OverscriptBox["\[RightArrow]", 
      RowBox[{" ", "\[Placeholder]", " "}]], " ", "\[Placeholder]", " "}], 
  "revrxn" -> RowBox[{"\[Placeholder]", " ", 
     UnderoverscriptBox[
     "\[RightArrowLeftArrow]", "\[Placeholder]", "\[Placeholder]"], " ", 
     "\[Placeholder]", " "}]},
FrontEndVersion->"13.0 for Mac OS X x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2317044b-b3a7-4215-80a1-51b5b8295ad2"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 361, 6, 98, "Title",ExpressionUUID->"cc7c940f-23d2-4ce7-95e7-a576cb9ba273"],
Cell[944, 30, 1267, 20, 74, "Text",ExpressionUUID->"9d092be7-87fc-4418-8d02-1d63f91e6e4f"],
Cell[CellGroupData[{
Cell[2236, 54, 255, 4, 67, "Section",ExpressionUUID->"99990c80-f429-42da-b2a3-1454896505b4"],
Cell[2494, 60, 803, 13, 51, "Text",ExpressionUUID->"de843a09-6ce5-4447-babf-ac4d071081d1"],
Cell[3300, 75, 660, 12, 89, "Input",ExpressionUUID->"dfc26316-e2a9-4d63-928b-6b8bc9ea88bb",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[3997, 92, 296, 4, 67, "Section",ExpressionUUID->"66ded67b-3e71-4a2e-8dc7-6d800ce0792b"],
Cell[4296, 98, 734, 12, 51, "Text",ExpressionUUID->"a39cfb25-3a34-49c2-b01a-76d11455661e"],
Cell[5033, 112, 12815, 301, 635, "Input",ExpressionUUID->"e859825e-af7b-488c-b12f-1c16d1746e4f",
 InitializationCell->True],
Cell[17851, 415, 8988, 212, 341, "Input",ExpressionUUID->"96944310-f4ff-4d9a-9835-3e6997ff3d20",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[26876, 632, 398, 6, 67, "Section",ExpressionUUID->"15bdaf1b-8646-45b4-9b84-6872e8be98ae"],
Cell[27277, 640, 1020, 16, 51, "Text",ExpressionUUID->"e6a29f15-4c63-4e9c-b07a-b51438e215f6"],
Cell[CellGroupData[{
Cell[28322, 660, 3981, 85, 199, "Input",ExpressionUUID->"f47552db-a581-438a-a6b3-5e92ff003b68"],
Cell[32306, 747, 1019, 27, 44, "Output",ExpressionUUID->"a0316145-b15a-4e1d-9b16-4e4e6272ae80"]
}, Open  ]],
Cell[33340, 777, 1088, 18, 30, "Input",ExpressionUUID->"c212fa81-c4b2-4f68-8235-e50809a73bb8"],
Cell[34431, 797, 1723, 32, 30, "Input",ExpressionUUID->"8abd42f8-c1b6-4f58-a008-9cd2ae0d23b7"],
Cell[CellGroupData[{
Cell[36179, 833, 636, 12, 30, "Input",ExpressionUUID->"67c9e129-e5a5-4e07-a767-b23a57819bf4"],
Cell[36818, 847, 472, 8, 34, "Output",ExpressionUUID->"6e65be63-f134-4e29-a18b-ce1adc705c0d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37339, 861, 339, 5, 67, "Section",ExpressionUUID->"c42ad146-f408-4eff-9904-dfcacbda4936"],
Cell[37681, 868, 920, 15, 51, "Text",ExpressionUUID->"6fd05b60-3908-4332-be81-9953da3e8ef3"],
Cell[CellGroupData[{
Cell[38626, 887, 21612, 434, 925, "Input",ExpressionUUID->"99c148a2-7f4b-43e5-a7c7-fe01c7c22633",
 InitializationCell->True],
Cell[60241, 1323, 37675, 726, 65, "Output",ExpressionUUID->"97d24aec-c757-4514-90df-d787d2f937b8"]
}, Open  ]],
Cell[97931, 2052, 9670, 246, 551, "Input",ExpressionUUID->"005c54bf-848c-4f84-aca3-0035ceae2189",
 InitializationCell->True],
Cell[107604, 2300, 1400, 25, 166, "Text",ExpressionUUID->"96df9646-e852-4be5-8171-5f5dafd10526"],
Cell[109007, 2327, 1335, 32, 94, "Input",ExpressionUUID->"c783f518-cc0f-460f-afde-1e0d45d10f1f"],
Cell[110345, 2361, 1430, 28, 30, "Input",ExpressionUUID->"09edd5c4-fe1c-4a58-b78e-13f4ddfb6849"],
Cell[CellGroupData[{
Cell[111800, 2393, 377, 9, 30, "Input",ExpressionUUID->"52055511-6668-4faf-aae3-ba7c743f21f8"],
Cell[112180, 2404, 382, 8, 34, "Output",ExpressionUUID->"3d5a6659-c6f7-46a4-bac5-fe3ecf171a80"]
}, Open  ]],
Cell[112577, 2415, 2106, 34, 97, "Text",ExpressionUUID->"1b85ef5e-269f-4043-a6cc-de1ee4eeac06"],
Cell[114686, 2451, 3693, 81, 194, "Input",ExpressionUUID->"3fc17b9e-6881-4e1c-b83a-0f1f9249fbe5",
 InitializationCell->True],
Cell[118382, 2534, 1929, 47, 94, "Input",ExpressionUUID->"5585cc10-fe8d-4e77-b447-c2440b214c72"],
Cell[120314, 2583, 398, 9, 30, "Input",ExpressionUUID->"68acdfcb-204b-4ecc-b110-76b0258a0bf5"],
Cell[120715, 2594, 619, 17, 30, "Input",ExpressionUUID->"6e881414-0ea8-458c-b2df-e4787da2a859"],
Cell[121337, 2613, 954, 22, 30, "Input",ExpressionUUID->"6ad26e0a-c640-45da-ba6a-847d2063f1a1"],
Cell[CellGroupData[{
Cell[122316, 2639, 330, 8, 30, "Input",ExpressionUUID->"751e5f28-137c-4452-91c2-f51279dcd384"],
Cell[122649, 2649, 210, 5, 34, "Output",ExpressionUUID->"f99b527d-3d9e-4096-9ccc-61eeaa9bb9be"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122908, 2660, 396, 6, 67, "Section",ExpressionUUID->"b253a218-76bf-458a-a7be-e82a67cc321a"],
Cell[123307, 2668, 3769, 63, 511, "Text",ExpressionUUID->"72a8b4f1-39d1-4bc0-b4fc-a7ca83a7944d"],
Cell[127079, 2733, 14899, 373, 887, "Input",ExpressionUUID->"60cb164e-170a-4036-b447-068c85182ed8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[142003, 3110, 69193, 1509, 2609, "Input",ExpressionUUID->"dffc76af-d98e-4596-b53b-f25c507d2b3c",
 InitializationCell->True],
Cell[211199, 4621, 109296, 2095, 65, "Output",ExpressionUUID->"0dbd6662-4297-42d0-ad55-505e271db24e"]
}, Open  ]],
Cell[320510, 6719, 822, 15, 51, "Text",ExpressionUUID->"46721fdf-2066-4b1b-b874-22b017fbed8e"],
Cell[321335, 6736, 1366, 33, 94, "Input",ExpressionUUID->"cd1d98ae-64de-446a-874b-c64fbde53e31"],
Cell[322704, 6771, 1489, 29, 30, "Input",ExpressionUUID->"fc51411c-df01-474b-9671-9969493059e6"],
Cell[CellGroupData[{
Cell[324218, 6804, 431, 10, 30, "Input",ExpressionUUID->"36b27609-23b6-4ff8-9b2b-99ca48b3111d"],
Cell[324652, 6816, 379, 8, 34, "Output",ExpressionUUID->"f26d34ca-2f86-407b-ad52-c513ba66eff0"]
}, Open  ]],
Cell[325046, 6827, 995, 19, 51, "Text",ExpressionUUID->"a646e409-ea17-4d7a-bf0c-0a08b2def45c"],
Cell[326044, 6848, 1045, 19, 52, "Input",ExpressionUUID->"ccaebf3a-aa7f-4cb2-9356-6e50ea87e6e5"],
Cell[327092, 6869, 449, 9, 30, "Input",ExpressionUUID->"7c0b31a4-97e0-4b0e-823e-a79456d1867b"],
Cell[327544, 6880, 683, 19, 30, "Input",ExpressionUUID->"9b54154b-ea81-4d44-bb19-2559dccc14c7"],
Cell[328230, 6901, 981, 24, 30, "Input",ExpressionUUID->"ac43d70a-8b75-4713-b1bb-82a3abc669f2"],
Cell[329214, 6927, 1009, 23, 52, "Input",ExpressionUUID->"d2f9f767-556c-4a6d-9ecf-fc66633bf9d0"],
Cell[CellGroupData[{
Cell[330248, 6954, 386, 9, 30, "Input",ExpressionUUID->"95dca389-44de-4a36-a8e6-018175660645"],
Cell[330637, 6965, 258, 6, 34, "Output",ExpressionUUID->"1e3d5404-2ff8-436f-90a7-141f80e5c293"]
}, Open  ]],
Cell[330910, 6974, 974, 19, 51, "Text",ExpressionUUID->"12f12d97-9c25-4842-af10-6ec7dbdc9f4d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[331921, 6998, 466, 8, 67, "Section",ExpressionUUID->"a205a44e-223c-4dea-98d1-aea867ae2f26"],
Cell[332390, 7008, 852, 15, 51, "Text",ExpressionUUID->"9b1a4f5c-b229-42c2-969a-a7bb8c70f48f"],
Cell[333245, 7025, 4790, 128, 262, "Input",ExpressionUUID->"e412e6b6-e092-4960-b410-6194837f61cb"],
Cell[338038, 7155, 4764, 88, 283, "Input",ExpressionUUID->"c69778a1-1792-40c9-916d-74378ae554d0"],
Cell[342805, 7245, 1302, 29, 115, "Input",ExpressionUUID->"00accaf0-72e7-4b7f-911d-76b036b36a2f"],
Cell[344110, 7276, 436, 10, 30, "Input",ExpressionUUID->"a7831029-9751-4478-b4dd-c25de5e3f61c"],
Cell[344549, 7288, 1245, 22, 30, "Input",ExpressionUUID->"7f6a3449-078b-4679-9756-9d4d714624c8"],
Cell[CellGroupData[{
Cell[345819, 7314, 319, 8, 30, "Input",ExpressionUUID->"9917d547-91e1-4508-bd66-39b8c38766c3"],
Cell[346141, 7324, 233, 5, 34, "Output",ExpressionUUID->"3c9aa912-8489-4575-a9ea-bd4a046a9cea"]
}, Open  ]],
Cell[346389, 7332, 905, 18, 51, "Text",ExpressionUUID->"db674450-f797-4afe-b3ba-7c1765bcf2b2"],
Cell[347297, 7352, 1411, 33, 94, "Input",ExpressionUUID->"6a6d0d55-0e32-4e51-b17b-2ef88c25d078"],
Cell[348711, 7387, 1540, 29, 30, "Input",ExpressionUUID->"cf0ce3f1-0a3d-4d08-a38b-6dd20a7f161f"],
Cell[CellGroupData[{
Cell[350276, 7420, 480, 10, 30, "Input",ExpressionUUID->"e1cea999-e7f9-4f09-8a3e-603b85fa762d"],
Cell[350759, 7432, 427, 9, 34, "Output",ExpressionUUID->"e044ca41-3ea9-44c4-a534-f8c11fdc6d41"]
}, Open  ]],
Cell[351201, 7444, 398, 6, 51, "Text",ExpressionUUID->"f37ee624-1898-42ae-8342-ef3812cd9795"],
Cell[CellGroupData[{
Cell[351624, 7454, 759, 17, 30, "Input",ExpressionUUID->"430411c4-0d6d-48e2-8e3f-1fd2f6b6f57d"],
Cell[352386, 7473, 888, 20, 44, "Output",ExpressionUUID->"697cd44e-7f0e-4dd3-a52a-44c29e7f12b8"]
}, Open  ]],
Cell[353289, 7496, 1404, 35, 30, "Input",ExpressionUUID->"dcd957dc-11db-43d0-808c-4dc04f64ddda"],
Cell[354696, 7533, 637, 14, 30, "Input",ExpressionUUID->"6dbf855b-8156-4efb-99a3-c4341b91741d"],
Cell[355336, 7549, 1016, 18, 30, "Input",ExpressionUUID->"e6508069-628a-48ed-b823-6815c9ffc771"],
Cell[CellGroupData[{
Cell[356377, 7571, 318, 8, 30, "Input",ExpressionUUID->"3737e9d5-1d47-4e92-9ecc-cf447b81455b"],
Cell[356698, 7581, 207, 4, 34, "Output",ExpressionUUID->"48b9f2a2-6793-4ae3-bead-03b24eb19f10"]
}, Open  ]],
Cell[356920, 7588, 853, 14, 74, "Text",ExpressionUUID->"47d980ad-b35f-4445-a29d-1330017ee6ad"],
Cell[357776, 7604, 1617, 39, 94, "Input",ExpressionUUID->"918add72-57c0-4216-a23d-8b5b08248a3d"],
Cell[359396, 7645, 2188, 44, 52, "Input",ExpressionUUID->"51015a06-ac19-4c00-ae4f-702b0c16b1ef"],
Cell[361587, 7691, 1884, 33, 30, "Input",ExpressionUUID->"0c388db5-1c2b-4c9d-951c-0b1088cd5d1b"],
Cell[CellGroupData[{
Cell[363496, 7728, 333, 7, 30, "Input",ExpressionUUID->"65ee8646-d1cb-4ffd-8231-4a00a02137d2"],
Cell[363832, 7737, 205, 4, 34, "Output",ExpressionUUID->"7c04078b-fff6-46a2-ab39-e587e6af5461"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364074, 7746, 1051, 19, 30, "Input",ExpressionUUID->"531ff731-022e-40ab-95ec-bbeeff96f9de"],
Cell[365128, 7767, 693, 11, 34, "Output",ExpressionUUID->"1158ace9-7294-46d5-9b1c-bd5f05acb556"]
}, Open  ]],
Cell[365836, 7781, 1535, 25, 143, "Text",ExpressionUUID->"bb6ba7a8-a982-44ca-91db-c33fdd018581"]
}, Open  ]],
Cell[CellGroupData[{
Cell[367408, 7811, 460, 7, 67, "Section",ExpressionUUID->"2fdee362-0129-407f-854a-5a191a04acc5"],
Cell[367871, 7820, 779, 12, 51, "Text",ExpressionUUID->"d3771ecd-1c83-4ae6-af66-c18af25ca974"],
Cell[368653, 7834, 1547, 37, 94, "Input",ExpressionUUID->"ed9d2509-8ba5-402b-b8dc-f8c8c3af0714"],
Cell[370203, 7873, 888, 17, 30, "Input",ExpressionUUID->"2edb1aad-56ee-4f11-81fd-0677737b713c"],
Cell[371094, 7892, 1974, 50, 94, "Input",ExpressionUUID->"4872e002-255d-4f93-8996-d23b67c36493"],
Cell[373071, 7944, 1826, 32, 30, "Input",ExpressionUUID->"8ef78952-5006-41f7-bc40-da58a1da666f"],
Cell[374900, 7978, 1995, 52, 94, "Input",ExpressionUUID->"d93b3d7e-9057-4b00-b22d-7636cb1bab7e"],
Cell[376898, 8032, 1836, 33, 30, "Input",ExpressionUUID->"8884492a-888c-4f57-a373-9620f859d282"],
Cell[378737, 8067, 2738, 39, 281, "Text",ExpressionUUID->"bfe91e39-2827-4099-b3dd-d39f5f3f7858"],
Cell[CellGroupData[{
Cell[381500, 8110, 266, 4, 30, "Input",ExpressionUUID->"1baad454-2b24-4a1b-bcf1-fdd086a47d5f"],
Cell[381769, 8116, 187, 2, 34, "Output",ExpressionUUID->"83b9e0be-6bc8-43a2-9b34-42f45281fe4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[381993, 8123, 260, 4, 30, "Input",ExpressionUUID->"83090070-4874-436d-b725-d84a50c65c86"],
Cell[382256, 8129, 447, 10, 34, "Output",ExpressionUUID->"6a9e4165-91af-49ef-b271-8f4c8a6af0b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[382740, 8144, 1154, 30, 73, "Input",ExpressionUUID->"ff7304f7-55e7-445e-8bc5-b37ede781c4b"],
Cell[383897, 8176, 14563, 283, 63, "Output",ExpressionUUID->"fe7bb239-cd32-4a35-b2a2-2f6fb52e3133"]
}, Open  ]],
Cell[CellGroupData[{
Cell[398497, 8464, 422, 8, 30, "Input",ExpressionUUID->"e0aead64-e1dd-4165-948f-ee92dde6af7f"],
Cell[398922, 8474, 479, 10, 34, "Output",ExpressionUUID->"cf9b550f-aa82-4a5f-a71b-6bd881b21ad1"]
}, Open  ]],
Cell[399416, 8487, 714, 19, 30, "Input",ExpressionUUID->"c62e0909-a444-454c-b5c4-7cdac97b26da"],
Cell[CellGroupData[{
Cell[400155, 8510, 321, 7, 30, "Input",ExpressionUUID->"f22d27a9-3fe9-4976-8d4c-e4b92b133b17"],
Cell[400479, 8519, 278, 5, 34, "Output",ExpressionUUID->"02dd4432-4bb5-4c4c-9047-e2233bac7aeb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[400794, 8529, 308, 7, 30, "Input",ExpressionUUID->"3fdc40c0-20cc-4fe3-8173-b09760bb1585"],
Cell[401105, 8538, 180, 3, 34, "Output",ExpressionUUID->"af6cad3e-296c-4eec-bac3-fdd7daee0471"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[401334, 8547, 575, 10, 67, "Section",ExpressionUUID->"59a16f2a-47c3-4ccd-9688-114202f10545"],
Cell[401912, 8559, 442, 8, 51, "Text",ExpressionUUID->"47480470-d5b8-4f3b-aee4-9c9f55de6161"],
Cell[402357, 8569, 316, 7, 30, "Input",ExpressionUUID->"5d315708-a695-4c35-85af-7e4185700cfa"],
Cell[402676, 8578, 3252, 67, 283, "Input",ExpressionUUID->"83d8c6f1-2b1e-483a-9041-296ae43296e7"],
Cell[405931, 8647, 3026, 64, 262, "Input",ExpressionUUID->"33e2b45d-c145-4a22-9c8b-14fe6f6ff2d6"],
Cell[408960, 8713, 4934, 98, 367, "Input",ExpressionUUID->"c0dfa0e0-f863-4341-867c-884013f54733"],
Cell[413897, 8813, 7189, 172, 388, "Input",ExpressionUUID->"aaa66a6b-5335-4712-8807-e1af9513c3cc"],
Cell[421089, 8987, 802, 14, 30, "Input",ExpressionUUID->"43236119-01af-4e8b-9772-6e15cefde2e1"],
Cell[421894, 9003, 1223, 27, 73, "Input",ExpressionUUID->"f5209997-4dfc-4101-9fab-d523b175b718"],
Cell[423120, 9032, 1217, 26, 73, "Input",ExpressionUUID->"12815df3-7586-4209-9bce-cf05f6ac6d4e"],
Cell[424340, 9060, 1172, 26, 73, "Input",ExpressionUUID->"917a7020-575e-4f35-b648-819f687a040c"],
Cell[425515, 9088, 917, 17, 74, "Text",ExpressionUUID->"3269ae80-8eb4-4a28-8ea5-608d1880c08c"],
Cell[CellGroupData[{
Cell[426457, 9109, 2616, 56, 178, "Input",ExpressionUUID->"ad2501a2-596a-4049-8941-c4c4be38ec6d"],
Cell[CellGroupData[{
Cell[429098, 9169, 505, 11, 24, "Print",ExpressionUUID->"7d537a0a-a5e5-4251-879a-752ef9b0734f"],
Cell[429606, 9182, 289, 7, 24, "Print",ExpressionUUID->"975ecf69-9a62-43e6-b167-47ccdcd4d05c"]
}, Open  ]],
Cell[429910, 9192, 328, 7, 34, "Output",ExpressionUUID->"72b909ff-a491-4cf7-96c9-ac461acef449"]
}, Open  ]],
Cell[430253, 9202, 919, 15, 74, "Text",ExpressionUUID->"aced3214-db82-486b-95aa-867ee0c55e96"],
Cell[431175, 9219, 918, 17, 30, "Input",ExpressionUUID->"37db2ed7-0b20-4f5d-8420-fc50bdac8188"],
Cell[432096, 9238, 1562, 38, 94, "Input",ExpressionUUID->"460d2204-ecf7-4379-92c6-4c92e2adf369"],
Cell[433661, 9278, 1685, 31, 30, "Input",ExpressionUUID->"c6e64167-b1fa-4456-bc40-8e3ebe3c4e8d"],
Cell[CellGroupData[{
Cell[435371, 9313, 768, 15, 30, "Input",ExpressionUUID->"e18bf783-79b2-4a01-a27e-c7b551e7f810"],
Cell[436142, 9330, 670, 12, 34, "Output",ExpressionUUID->"58fa99ef-dc4e-4227-8bb0-6f2c7efd949d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[436849, 9347, 961, 20, 30, "Input",ExpressionUUID->"d174099e-a6ea-4a7d-94af-92ba884a896d"],
Cell[437813, 9369, 211, 5, 34, "Output",ExpressionUUID->"eb7d00c0-6b34-4442-9d82-a201d4d12cde"]
}, Open  ]],
Cell[CellGroupData[{
Cell[438061, 9379, 251, 5, 30, "Input",ExpressionUUID->"aa403515-6f33-4593-8a9c-a5e61f22d992"],
Cell[438315, 9386, 242, 5, 34, "Output",ExpressionUUID->"f9ab8f43-3173-4195-98eb-f3f8a2dbe3a7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[438594, 9396, 2607, 54, 94, "Input",ExpressionUUID->"058e6224-c468-425a-97a9-63f53d9e80cb"],
Cell[CellGroupData[{
Cell[441226, 9454, 593, 13, 24, "Print",ExpressionUUID->"09bb6b9c-2d8c-41e7-b341-c0e41da9ef90"],
Cell[441822, 9469, 335, 9, 24, "Print",ExpressionUUID->"dadc0da7-568a-4929-884e-f6ecbd489e28"]
}, Open  ]],
Cell[442172, 9481, 485, 9, 34, "Output",ExpressionUUID->"d7d60aab-75c2-4e12-83e6-e6100de02260"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

